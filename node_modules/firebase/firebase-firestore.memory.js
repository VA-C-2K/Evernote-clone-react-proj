!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Id){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Id),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function v(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function y(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Te=u=u||{})[Te.DEBUG=0]="DEBUG",Te[Te.VERBOSE=1]="VERBOSE",Te[Te.INFO=2]="INFO",Te[Te.WARN=3]="WARN",Te[Te.ERROR=4]="ERROR",Te[Te.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}var o={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R={},k=O||self;function L(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function S(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function j(t,e,n){return(j=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++V))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var X,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var J=k.navigator;if(J){J=J.userAgent;if(J){X=J;break t}}X=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=L;var rt,it=K(X,"Opera"),ot=K(X,"Trident")||K(X,"MSIE"),st=K(X,"Edge"),ut=st||ot,at=K(X,"Gecko")&&!(K(X.toLowerCase(),"webkit")&&!K(X,"Edge"))&&!(K(X,"Trident")||K(X,"MSIE"))&&!K(X,"Edge"),ht=K(X.toLowerCase(),"webkit")&&!K(X,"Edge");function ct(){var t=k.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=X,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Y(String(rt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var vt=k.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,yt=!ot||9<=Number(vt),gt=ot&&!dt("9"),mt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",L,e),k.removeEventListener("test",L,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),It=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Dt={};function St(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=xt(r);return e&&e[Tt]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);return null}return n=xt(n),t&&t[Tt]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=jt(t);if(h||(t[Lt]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Tt]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Nt(t)))}function Vt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(yt)return Ct(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new bt(e,this))}function jt(t){return(t=t[Lt])instanceof Ot?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==D(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function qt(){F.call(this),this.c=new Ot(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Gt(o,r,!0,e)&&s;if(s=Gt(o=e.a=t,r,!0,e)&&s,s=Gt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Gt(o=e.a=n[i],r,!1,e)&&s}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[Tt]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){St(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=xt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.G=function(){if(qt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=k.JSON.stringify;function Wt(){this.b=this.a=null}var zt,Ht=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Yt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Kt(t,e){var n;zt||(n=k.Promise.resolve(void 0),zt=function(){n.then($t)}),Qt||(zt(),Qt=!0),Jt.add(t,e)}Wt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Wt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function Zt(t,e){qt.call(this),this.b=t||1,this.a=e||k,this.f=j(this.Xa,this),this.g=x()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==D(t))n&&(t=j(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=j(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}q(Zt,qt),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(I(re=ue,ie=ne=F),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){F.call(this),this.b=t,this.a={}}q(ae,F);var he=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=St(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function fe(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),le(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var de=null;function ve(){return de=de||new qt}function ye(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ve();Ft(e,new ye(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ve();Ft(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}q(ye,wt),q(me,wt),q(be,wt);var Te={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ie={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Ae.prototype.a=null;var Re,O={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function ke(){wt.call(this,"d")}function Le(){wt.call(this,"c")}function De(){}function Se(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}q(ke,wt),q(Le,wt),q(De,Ae),Re=new De;var Pe=45e3,_e={},Ve={};function Ce(t,e,n){t.H=1,t.i=nn(Qe(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=x(),Me(t),t.l=Qe(t.i);var s,u,a,h,c,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=hr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(j(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ve:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Ve:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ve){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),Fe(t))}function Me(t){t.T=x()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ee(j(t.Ta,t),e)}function qe(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Ge(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Hn(u)}tr(u),we(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=Ee(j(u.Qa,u),6e3));if(Tn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(K(r,"spdy")||K(r,"quic")||K(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Kn(u)):"stop"!=h[0]&&"close"!=h[0]||sr(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?sr(u,7):zn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ge(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(S(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(S(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(S(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Se.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.S,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Ge(this),Fe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(je(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),Be(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Ge(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Ua=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),je(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,Ge(this)},N.Ta=function(){this.o=null;var t,e,n=x();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Ge(this),this.h=2,Fe(this)):xe(this,this.T-n)},(N=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return He(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Qe(t){return new Ke(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=on(e,cn)),t.b=new fn(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?hn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,ln)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,hn=/[#\?]/g,cn=/[#\?@]/g,ln=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function vn(t,e){return pn(t),e=gn(t,e),Xe(t.a.b,e)}function yn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),z(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=fn.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=W(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,vn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function En(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function kn(){this.a=new Rn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Dn=k.JSON.parse;function Sn(t){qt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}q(Sn,qt);var Pn="",_n=/^https?$/i,Vn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),xn(t)}function jn(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Mn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))ee(t.za,0,t);else if(Ft(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n),e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",jn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Pa=Bn("retryDelaySeedMs",1e4,t),this.Ka=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function zn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,en(n=Qe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new Se(t,t.c,e,void 0)).H=2,e.i=nn(Qe(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=hr(e.g,null),e.a.ba(e.i)),e.u=x(),Me(e)),ur(t)}function Hn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Xn(t){Hn(t),t.j&&(k.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Kn(t)}function Kn(t){En(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new Se(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ce(n,r,e)}function Jn(t,n){t.f&&We({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?j(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;P(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Kt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Ee(j(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new Se(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Qe(e)),n.j=null,n.I=!0,Ue(n,t)}function rr(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,Ft(i=ve(),new be(i)),Kn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=Ee(j(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=j(t.Wa,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new fe,k.Image?((i=new Image).onload=M(Ln,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Ln,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Ln,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Ln,o,i,"TestLoadImage: timeout",!1,r),k.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Xn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?Qe(s):new Ke(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=k.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function hr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sn(t.La)).F=t.C,e}function cr(){}function lr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function fr(t,e){qt.call(this),this.a=new Wn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function pr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){Le.call(this),this.status=1}function vr(t){this.a=t}(N=Sn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Re),this.a.onreadystatechange=j(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new ze(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=G(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=j(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),xn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),Sn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Sa())},N.Sa=function(){Mn(this)},N.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Se(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Qe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Gn(i,this.i,r),An(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Ce(n,i,null)):Ce(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||En(this.b)||Qn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ee(j(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Hn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Hn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=cr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},lr.prototype.a=function(t,e){return new fr(t,e)},q(fr,qt),fr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Kn(t)},fr.prototype.close=function(){zn(this.a)},fr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.l?((e={}).__data__=Bt(t),Yn(this.a,e)):Yn(this.a,t)},fr.prototype.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.X.G.call(this)},q(pr,ke),q(dr,Le),q(vr,cr),vr.prototype.ta=function(){Ft(this.a,"a")},vr.prototype.sa=function(t){Ft(this.a,new pr(t))},vr.prototype.ra=function(t){Ft(this.a,new dr)},vr.prototype.qa=function(){Ft(this.a,"b")},lr.prototype.createWebChannel=lr.prototype.a,fr.prototype.send=fr.prototype.h,fr.prototype.open=fr.prototype.g,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ie.COMPLETE="complete",(Oe.EventType=O).OPEN="a",O.CLOSE="b",O.ERROR="c",O.MESSAGE="d",qt.prototype.listen=qt.prototype.va,Sn.prototype.listenOnce=Sn.prototype.wa,Sn.prototype.getLastError=Sn.prototype.Oa,Sn.prototype.getLastErrorCode=Sn.prototype.ua,Sn.prototype.getStatus=Sn.prototype.W,Sn.prototype.getResponseJson=Sn.prototype.Na,Sn.prototype.getResponseText=Sn.prototype.$,Sn.prototype.send=Sn.prototype.ba;var yr=Te,gr=Ie,mr=Oe,wr=Sn,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Tr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Ir=(Object.defineProperty(Or.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Or.prototype.isEqual=function(t){return t instanceof Or&&t.projectId===this.projectId&&t.database===this.database},Or),Ar=(Nr.prototype.u=function(){return null!=this.uid},Nr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Nr.prototype.isEqual=function(t){return t.uid===this.uid},Nr);function Nr(t){this.uid=t}function Or(t,e){this.projectId=t,this.database=e||"(default)"}Ar.UNAUTHENTICATED=new Ar(null),Ar.l=new Ar("google-credentials-uid"),Ar._=new Ar("first-party-uid");var Rr=new l("@firebase/firestore");function kr(){return Rr.logLevel}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.DEBUG&&(e=n.map(Pr),Rr.debug.apply(Rr,s(["Firestore (8.1.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.ERROR&&(e=n.map(Pr),Rr.error.apply(Rr,s(["Firestore (8.1.0): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.WARN&&(e=n.map(Pr),Rr.warn.apply(Rr,s(["Firestore (8.1.0): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.1.0) INTERNAL ASSERTION FAILED: "+t;throw Dr(t),new Error(t)}function Vr(t){t||_r()}function Cr(t,e){this.user=e,this.type="OAuth",this.m={},this.m.Authorization="Bearer "+t}var Ur,jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mr=(n(Xr,Ur=Error),Xr),xr=(Hr.prototype.getToken=function(){return Promise.resolve(null)},Hr.prototype.A=function(){},Hr.prototype.I=function(t){(this.T=t)(Ar.UNAUTHENTICATED)},Hr.prototype.R=function(){this.T=null},Hr),qr=(zr.prototype.getToken=function(){var e=this,n=this.p,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.p!==n?(Lr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new Cr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},zr.prototype.A=function(){this.forceRefresh=!0},zr.prototype.I=function(t){this.T=t,this.V&&t(this.currentUser)},zr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.T=null},zr.prototype.g=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new Ar(t)},zr),Fr=(Object.defineProperty(Wr.prototype,"m",{get:function(){var t={"X-Goog-AuthUser":this.C},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Wr),Gr=(Br.prototype.getToken=function(){return Promise.resolve(new Fr(this.v,this.C))},Br.prototype.I=function(t){t(Ar._)},Br.prototype.R=function(){},Br.prototype.A=function(){},Br);function Br(t,e){this.v=t,this.C=e}function Wr(t,e){this.v=t,this.C=e,this.type="FirstParty",this.user=Ar._}function zr(t){var e=this;this.P=null,this.currentUser=Ar.UNAUTHENTICATED,this.V=!1,this.p=0,this.T=null,this.forceRefresh=!1,this.P=function(){e.p++,e.currentUser=e.g(),e.V=!0,e.T&&e.T(e.currentUser)},this.p=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Hr(){this.T=null}function Xr(t,e){var n=this;return(n=Ur.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Yr=(Kr.S=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Kr);function Kr(){}function Qr(t,e){return t<e?-1:e<t?1:0}function Jr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var $r,Zr,ti=(li.now=function(){return li.fromMillis(Date.now())},li.fromDate=function(t){return li.fromMillis(t.getTime())},li.fromMillis=function(t){var e=Math.floor(t/1e3);return new li(e,1e6*(t-1e3*e))},li.prototype.toDate=function(){return new Date(this.toMillis())},li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},li.prototype.D=function(t){return this.seconds===t.seconds?Qr(this.nanoseconds,t.nanoseconds):Qr(this.seconds,t.seconds)},li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},li),ei=(ci.N=function(t){return new ci(t)},ci.min=function(){return new ci(new ti(0,0))},ci.prototype.F=function(t){return this.timestamp.D(t.timestamp)},ci.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ci.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ci.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ci.prototype.L=function(){return this.timestamp},ci),Ie=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.$},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.k(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.M(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.U=function(t){return t=void 0===t?1:t,this.M(this.segments,this.offset+t,this.length-t)},hi.prototype.q=function(){return this.M(this.segments,this.offset,this.length-1)},hi.prototype.B=function(){return this.segments[this.offset]},hi.prototype.j=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype.W=function(){return 0===this.length},hi.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.K=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},hi.k=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ni=(n(ai,Zr=Ie),ai.prototype.M=function(t,e,n){return new ai(t,e,n)},ai.prototype.Y=function(){return this.H().join("/")},ai.prototype.toString=function(){return this.Y()},ai.J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ai(n)},ai.X=function(){return new ai([])},ai),ri=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ii=(n(ui,$r=Ie),ui.prototype.M=function(t,e,n){return new ui(t,e,n)},ui.Z=function(t){return ri.test(t)},ui.prototype.Y=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ui.Z(t)||(t="`"+t+"`"),t}).join(".")},ui.prototype.toString=function(){return this.Y()},ui.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ui.nt=function(){return new ui(["__name__"])},ui.et=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Mr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Mr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ui(e)},ui.X=function(){return new ui([])},ui),oi=(si.st=function(t){return new si(ni.J(t))},si.it=function(t){return new si(ni.J(t).U(5))},si.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},si.prototype.isEqual=function(t){return null!==t&&0===ni.k(this.path,t.path)},si.prototype.toString=function(){return this.path.toString()},si.k=function(t,e){return ni.k(t.path,e.path)},si.ot=function(t){return t.length%2==0},si.ut=function(t){return new si(new ni(t.slice()))},si);function si(t){this.path=t}function ui(){return null!==$r&&$r.apply(this,arguments)||this}function ai(){return null!==Zr&&Zr.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.$=n}function ci(t){this.timestamp=t}function li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function fi(t){return null==t}function pi(t){return 0===t&&1/t==-1/0}var di=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ct=null};function vi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new di(t,e,n,r,i,o,s)}function yi(t){var e=t;return null===e.ct&&(t=e.path.Y(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.Y()+t.op.toString()+Eo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.Y()+t.dir}).join(","),fi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Yu(e.startAt)),e.endAt&&(t+="|ub:",t+=Yu(e.endAt)),e.ct=t),e.ct}function gi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!go(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qu(t.startAt,e.startAt)&&Qu(t.endAt,e.endAt)}function mi(t){return oi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var wi=(bi.fromBase64String=function(t){return new bi(atob(t))},bi.fromUint8Array=function(t){return new bi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},bi.prototype.toBase64=function(){return t=this.at,btoa(t);var t},bi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},bi.prototype.ht=function(){return 2*this.at.length},bi.prototype.F=function(t){return Qr(this.at,t.at)},bi.prototype.isEqual=function(t){return this.at===t.at},bi);function bi(t){this.at=t}wi.lt=new wi("");function Ei(t){this.count=t}var Ti,Ii=(Ai.prototype.dt=function(t){return new Ai(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ai.prototype.wt=function(t,e){return new Ai(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ai.prototype.Et=function(t){return new Ai(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},Ai);function Ai(t,e,n,r,i,o,s){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===s&&(s=wi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ni(t){switch(t){case jr.OK:return _r(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return _r(),0}}function Oi(t){if(void 0===t)return Dr("GRPC error has no .code"),jr.UNKNOWN;switch(t){case Ti.OK:return jr.OK;case Ti.CANCELLED:return jr.CANCELLED;case Ti.UNKNOWN:return jr.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return jr.INTERNAL;case Ti.UNAVAILABLE:return jr.UNAVAILABLE;case Ti.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case Ti.NOT_FOUND:return jr.NOT_FOUND;case Ti.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case Ti.ABORTED:return jr.ABORTED;case Ti.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case Ti.DATA_LOSS:return jr.DATA_LOSS;default:return _r()}}(l=Ti=Ti||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Ri=(Pi.prototype.Tt=function(t,e){return new Pi(this.k,this.root.Tt(t,e,this.k).copy(null,null,Li.At,null,null))},Pi.prototype.remove=function(t){return new Pi(this.k,this.root.remove(t,this.k).copy(null,null,Li.At,null,null))},Pi.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Pi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.k(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Pi.prototype.W=function(){return this.root.W()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Pi.prototype.It=function(){return this.root.It()},Pi.prototype.Rt=function(){return this.root.Rt()},Pi.prototype.Pt=function(t){return this.root.Pt(t)},Pi.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Pi.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Pi.prototype.yt=function(t){return this.root.yt(t)},Pi.prototype.Vt=function(){return new ki(this.root,null,this.k,!1)},Pi.prototype.gt=function(t){return new ki(this.root,t,this.k,!1)},Pi.prototype.vt=function(){return new ki(this.root,null,this.k,!0)},Pi.prototype.bt=function(t){return new ki(this.root,t,this.k,!0)},Pi),ki=(Si.prototype.Dt=function(){var t=this.St.pop(),e={key:t.key,value:t.value};if(this.Ct)for(t=t.left;!t.W();)this.St.push(t),t=t.right;else for(t=t.right;!t.W();)this.St.push(t),t=t.left;return e},Si.prototype.Nt=function(){return 0<this.St.length},Si.prototype.xt=function(){if(0===this.St.length)return null;var t=this.St[this.St.length-1];return{key:t.key,value:t.value}},Si),Li=(Di.prototype.copy=function(t,e,n,r,i){return new Di(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Di.prototype.W=function(){return!1},Di.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Di.prototype.yt=function(t){return this.right.yt(t)||t(this.key,this.value)||this.left.yt(t)},Di.prototype.min=function(){return this.left.W()?this:this.left.min()},Di.prototype.It=function(){return this.min().key},Di.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Di.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Di.prototype.Ot=function(){if(this.left.W())return Di.EMPTY;var t=this;return t.left.Lt()||t.left.left.Lt()||(t=t.$t()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Di.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Lt()||r.left.left.Lt()||(r=r.$t()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Lt()&&(r=r.kt()),r.right.W()||r.right.Lt()||r.right.left.Lt()||(r=r.Mt()),0===e(t,r.key)){if(r.right.W())return Di.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Di.prototype.Lt=function(){return this.color},Di.prototype.Ft=function(){var t=this;return t.right.Lt()&&!t.left.Lt()&&(t=t.Ut()),t.left.Lt()&&t.left.left.Lt()&&(t=t.kt()),t.left.Lt()&&t.right.Lt()&&(t=t.qt()),t},Di.prototype.$t=function(){var t=this.qt();return t.right.left.Lt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.kt())).Ut()).qt()),t},Di.prototype.Mt=function(){var t=this.qt();return t.left.left.Lt()&&(t=(t=t.kt()).qt()),t},Di.prototype.Ut=function(){var t=this.copy(null,null,Di.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Di.prototype.kt=function(){var t=this.copy(null,null,Di.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Di.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Di.prototype.Bt=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Di.prototype.Qt=function(){if(this.Lt()&&this.left.Lt())throw _r();if(this.right.Lt())throw _r();var t=this.left.Qt();if(t!==this.right.Qt())throw _r();return t+(this.Lt()?0:1)},Di);function Di(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Di.RED,this.left=null!=r?r:Di.EMPTY,this.right=null!=i?i:Di.EMPTY,this.size=this.left.size+1+this.right.size}function Si(t,e,n,r){this.Ct=r,this.St=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ct?t.left:t.right;else{if(0===i){this.St.push(t);break}this.St.push(t),t=this.Ct?t.right:t.left}}function Pi(t,e){this.k=t,this.root=e||Li.EMPTY}function _i(){this.size=0}Li.EMPTY=null,Li.RED=!0,Li.At=!1,Li.EMPTY=(Object.defineProperty(_i.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(_i.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),_i.prototype.copy=function(t,e,n,r,i){return this},_i.prototype.Tt=function(t,e,n){return new Li(t,e)},_i.prototype.remove=function(t,e){return this},_i.prototype.W=function(){return!0},_i.prototype.Pt=function(t){return!1},_i.prototype.yt=function(t){return!1},_i.prototype.It=function(){return null},_i.prototype.Rt=function(){return null},_i.prototype.Lt=function(){return!1},_i.prototype.Bt=function(){return!0},_i.prototype.Qt=function(){return 0},new _i);var Vi=(Mi.prototype.has=function(t){return null!==this.data.get(t)},Mi.prototype.first=function(){return this.data.It()},Mi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(Mi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Mi.prototype.indexOf=function(t){return this.data.indexOf(t)},Mi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},Mi.prototype.jt=function(t,e){for(var n=this.data.gt(t[0]);n.Nt();){var r=n.Dt();if(0<=this.k(r.key,t[1]))return;e(r.key)}},Mi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.gt(e):this.data.Vt();n.Nt();)if(!t(n.Dt().key))return},Mi.prototype.Gt=function(t){t=this.data.gt(t);return t.Nt()?t.Dt().key:null},Mi.prototype.Vt=function(){return new Ci(this.data.Vt())},Mi.prototype.gt=function(t){return new Ci(this.data.gt(t))},Mi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},Mi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Mi.prototype.W=function(){return this.data.W()},Mi.prototype.Kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Mi.prototype.isEqual=function(t){if(!(t instanceof Mi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.Vt(),n=t.data.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(0!==this.k(r,i))return!1}return!0},Mi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Mi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Mi.prototype.copy=function(t){var e=new Mi(this.k);return e.data=t,e},Mi),Ci=(ji.prototype.Dt=function(){return this.zt.Dt().key},ji.prototype.Nt=function(){return this.zt.Nt()},ji),Ui=new Ri(oi.k);function ji(t){this.zt=t}function Mi(t){this.k=t,this.data=new Ri(this.k)}var xi=new Ri(oi.k);var qi=new Ri(oi.k),Fi=new Vi(oi.k);function Gi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Fi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Bi=new Vi(Qr);var Wi=(so.Jt=function(t){return new so(t.k)},so.prototype.has=function(t){return null!=this.Ht.get(t)},so.prototype.get=function(t){return this.Ht.get(t)},so.prototype.first=function(){return this.Yt.It()},so.prototype.last=function(){return this.Yt.Rt()},so.prototype.W=function(){return this.Yt.W()},so.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Yt.indexOf(t):-1},Object.defineProperty(so.prototype,"size",{get:function(){return this.Yt.size},enumerable:!1,configurable:!0}),so.prototype.forEach=function(n){this.Yt.Pt(function(t,e){return n(t),!1})},so.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Yt.Tt(t,null))},so.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Yt.remove(e)):this},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.Yt.Vt(),n=t.Yt.Vt();e.Nt();){var r=e.Dt().key,i=n.Dt().key;if(!r.isEqual(i))return!1}return!0},so.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},so.prototype.copy=function(t,e){var n=new so;return n.k=this.k,n.Ht=t,n.Yt=e,n},so),zi=(oo.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):_r()},oo.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},oo),Hi=(io.rn=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new io(t,e,Wi.Jt(e),i,n,r,!0,!1)},Object.defineProperty(io.prototype,"hasPendingWrites",{get:function(){return!this.nn.W()},enumerable:!1,configurable:!0}),io.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.en===t.en&&this.nn.isEqual(t.nn)&&gu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.tn.isEqual(t.tn)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},io),Xi=(ro.hn=function(t,e){var n=new Map;return n.set(t,Yi.ln(t,e)),new ro(ei.min(),n,Bi,Ui,Gi())},ro),Yi=(no.ln=function(t,e){return new no(wi.lt,e,Gi(),Gi(),Gi())},no),Ki=function(t,e,n,r){this.En=t,this.removedTargetIds=e,this.key=n,this.mn=r},Qi=function(t,e){this.targetId=t,this.Tn=e},Ji=function(t,e,n,r){void 0===n&&(n=wi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},$i=(Object.defineProperty(eo.prototype,"_n",{get:function(){return this.Pn},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"resumeToken",{get:function(){return this.Rn},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"Vn",{get:function(){return 0!==this.An},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"pn",{get:function(){return this.yn},enumerable:!1,configurable:!0}),eo.prototype.gn=function(t){0<t.ht()&&(this.yn=!0,this.Rn=t)},eo.prototype.vn=function(){var n=Gi(),r=Gi(),i=Gi();return this.In.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new Yi(this.Rn,this.Pn,n,r,i)},eo.prototype.bn=function(){this.yn=!1,this.In=ao()},eo.prototype.Cn=function(t,e){this.yn=!0,this.In=this.In.Tt(t,e)},eo.prototype.Sn=function(t){this.yn=!0,this.In=this.In.remove(t)},eo.prototype.Dn=function(){this.An+=1},eo.prototype.Nn=function(){--this.An},eo.prototype.xn=function(){this.yn=!0,this.Pn=!0},eo),Zi=(to.prototype.Mn=function(t){for(var e=0,n=t.En;e<n.length;e++){var r=n[e];t.mn instanceof eu?this.Un(r,t.mn):t.mn instanceof nu&&this.qn(r,t.key,t.mn)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.qn(s,t.key,t.mn)}},to.prototype.Bn=function(n){var r=this;this.Qn(n,function(t){var e=r.jn(t);switch(n.state){case 0:r.Wn(t)&&e.gn(n.resumeToken);break;case 1:e.Nn(),e.Vn||e.bn(),e.gn(n.resumeToken);break;case 2:e.Nn(),e.Vn||r.removeTarget(t);break;case 3:r.Wn(t)&&(e.xn(),e.gn(n.resumeToken));break;case 4:r.Wn(t)&&(r.Gn(t),e.gn(n.resumeToken));break;default:_r()}})},to.prototype.Qn=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.On.forEach(function(t,e){r.Wn(e)&&n(e)})},to.prototype.Kn=function(t){var e=t.targetId,n=t.Tn.count,t=this.zn(e);t&&(mi(t=t.target)?0===n?(t=new oi(t.path),this.qn(e,t,new nu(t,ei.min()))):Vr(1===n):this.Hn(e)!==n&&(this.Gn(e),this.kn=this.kn.add(e)))},to.prototype.Yn=function(r){var i=this,o=new Map;this.On.forEach(function(t,e){var n=i.zn(e);n&&(t._n&&mi(n.target)&&(n=new oi(n.target.path),null!==i.Ln.get(n)||i.Jn(e,n)||i.qn(e,n,new nu(n,r))),t.pn&&(o.set(e,t.vn()),t.bn()))});var s=Gi();this.$n.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.zn(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Xi(r,o,this.kn,this.Ln,s);return this.Ln=Ui,this.$n=uo(),this.kn=new Vi(Qr),t},to.prototype.Un=function(t,e){var n;this.Wn(t)&&(n=this.Jn(t,e.key)?2:0,this.jn(t).Cn(e.key,n),this.Ln=this.Ln.Tt(e.key,e),this.$n=this.$n.Tt(e.key,this.Xn(e.key).add(t)))},to.prototype.qn=function(t,e,n){var r;this.Wn(t)&&(r=this.jn(t),this.Jn(t,e)?r.Cn(e,1):r.Sn(e),this.$n=this.$n.Tt(e,this.Xn(e).delete(t)),n&&(this.Ln=this.Ln.Tt(e,n)))},to.prototype.removeTarget=function(t){this.On.delete(t)},to.prototype.Hn=function(t){var e=this.jn(t).vn();return this.Fn.Zn(t).size+e.fn.size-e.wn.size},to.prototype.Dn=function(t){this.jn(t).Dn()},to.prototype.jn=function(t){var e=this.On.get(t);return e||(e=new $i,this.On.set(t,e)),e},to.prototype.Xn=function(t){var e=this.$n.get(t);return e||(e=new Vi(Qr),this.$n=this.$n.Tt(t,e)),e},to.prototype.Wn=function(t){var e=null!==this.zn(t);return e||Lr("WatchChangeAggregator","Detected inactive target",t),e},to.prototype.zn=function(t){var e=this.On.get(t);return e&&e.Vn?null:this.Fn.te(t)},to.prototype.Gn=function(e){var n=this;this.On.set(e,new $i),this.Fn.Zn(e).forEach(function(t){n.qn(e,t,null)})},to.prototype.Jn=function(t,e){return this.Fn.Zn(t).has(e)},to);function to(t){this.Fn=t,this.On=new Map,this.Ln=Ui,this.$n=uo(),this.kn=new Vi(Qr)}function eo(){this.An=0,this.In=ao(),this.Rn=wi.lt,this.Pn=!1,this.yn=!0}function no(t,e,n,r,i){this.resumeToken=t,this._n=e,this.fn=n,this.dn=r,this.wn=i}function ro(t,e,n,r,i){this.ft=t,this.on=e,this.un=n,this.cn=r,this.an=i}function io(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.tn=n,this.docChanges=r,this.nn=i,this.fromCache=o,this.en=s,this.sn=u}function oo(){this.Xt=new Ri(oi.k)}function so(n){this.k=n?function(t,e){return n(t,e)||oi.k(t.key,e.key)}:function(t,e){return oi.k(t.key,e.key)},this.Ht=xi,this.Yt=new Ri(this.k)}function uo(){return new Ri(oi.k)}function ao(){return new Ri(oi.k)}function ho(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function co(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function fo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function po(t){t=To(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(t.seconds,t.nanos)}var vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:_r()}function go(r,i){var t,e=yo(r);if(e!==yo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return po(r).isEqual(po(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=To(r.timestampValue),t=To(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Ao(r.bytesValue).isEqual(Ao(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Io((t=r).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Io(t.doubleValue),e=Io(e.doubleValue);return t===e?pi(t)===pi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Jr(r.arrayValue.values||[],i.arrayValue.values||[],go);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(ho(e)!==ho(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!go(e[t],n[t])))return!1;return!0}();default:return _r()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,r,i=yo(t),o=yo(e);if(i!==o)return Qr(i,o);switch(i){case 0:return 0;case 1:return Qr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Io(t.integerValue||t.doubleValue),n=Io(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return Qr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Ao(t),e=Ao(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Qr(n[i],r[i]);if(0!==o)return o}return Qr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Qr(Io(i.latitude),Io(r.latitude)))?n:Qr(Io(i.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=wo(n[i],r[i]);if(o)return o}return Qr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Qr(r[s],o[s]);if(0!==u)return u;u=wo(n[r[s]],i[o[s]]);if(0!==u)return u}return Qr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Qr(t,e);var n=To(t),t=To(e),e=Qr(n.seconds,t.seconds);return 0!==e?e:Qr(n.nanos,t.nanos)}function Eo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=To(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ao(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,oi.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):_r();var e}(t)}function To(t){if(Vr(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e=0,n=vo.exec(t);Vr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?wi.fromBase64String(t):wi.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.Y()}}function Oo(t){return t&&"integerValue"in t}function Ro(t){return!!t&&"arrayValue"in t}function ko(t){return t&&"nullValue"in t}function Lo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Do(t){return t&&"mapValue"in t}var So={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_o=function(t,e){this.t=t,this.ne=e};function Vo(t){return{integerValue:""+t}}function Co(t,e){if(t.ne){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function Uo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!pi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Vo(e):Co(t,e);var n}function jo(t,e){return t.ne?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.ne?e.toBase64():e.toUint8Array()}function xo(t){return Vr(!!t),ei.N((t=To(t),new ti(t.seconds,t.nanos)))}function qo(t,e){return new ni(["projects",t.projectId,"databases",t.database]).child("documents").child(e).Y()}function Fo(t){t=ni.J(t);return Vr(ns(t)),t}function Go(t,e){return qo(t.t,e.path)}function Bo(t,e){e=Fo(e);if(e.get(1)!==t.t.projectId)throw new Mr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Mr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new oi(Ho(e))}function Wo(t,e){return qo(t.t,e)}function zo(t){return new ni(["projects",t.t.projectId,"databases",t.t.database]).Y()}function Ho(t){return Vr(4<t.length&&"documents"===t.get(4)),t.U(5)}function Xo(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Yo(t,e){var n,r,i;if(e instanceof _s)n={update:Xo(t,e.key,e.value)};else if(e instanceof Ws)n={delete:Go(t,e.key)};else if(e instanceof Vs)n={update:Xo(t,e.key,e.data),updateMask:(i=e.ee,r=[],i.fields.forEach(function(t){return r.push(t.Y())}),{fieldPaths:r})};else if(e instanceof xs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ss)return{fieldPath:t.field.Y(),setToServerValue:"REQUEST_TIME"};if(e instanceof us)return{fieldPath:t.field.Y(),appendMissingElements:{values:e.elements}};if(e instanceof fs)return{fieldPath:t.field.Y(),removeAllFromArray:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.Y(),increment:e.se};throw _r()})}};else{if(!(e instanceof zs))return _r();n={verify:Go(t,e.key)}}return e.re.ie||(n.currentDocument=void 0!==(i=e.re).updateTime?{updateTime:(e=t,t=i.updateTime,jo(e,t.L()))}:void 0!==i.exists?{exists:i.exists}:_r()),n}function Ko(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Wo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Wo(t,r.q()),n.structuredQuery.from=[{collectionId:r.j()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Lo(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NAN"}};if(ko(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lo(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NAN"}};if(ko(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zo(t.field),op:(e=t.op,Po[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Zo((t=t).field),direction:(t=t.dir,So[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.ne||fi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Jo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Jo(e.endAt)),n}function Qo(t){var e=4===(o=Fo(t.parent)).length?ni.X():Ho(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Vr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[es(t)]:void 0!==t.fieldFilter?[(n=t,Iu.create(ts(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):_r():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new Ju(ts((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=fi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=$o(n.startAt));var u=null;return n.endAt&&(u=$o(n.endAt)),new iu(e,i,t,o,r,"F",s,u)}function Jo(t){return{before:t.before,values:t.position}}function $o(t){var e=!!t.before,t=t.values||[];return new Bu(t,e)}function Zo(t){return{fieldPath:t.Y()}}function ts(t){return ii.et(t.fieldPath)}function es(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ts(t.unaryFilter.field);return Iu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ts(t.unaryFilter.field);return Iu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=ts(t.unaryFilter.field);return Iu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=ts(t.unaryFilter.field);return Iu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}function ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}Ie=function(){this.oe=void 0};function rs(t,e){return t instanceof ys?Oo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var is,os,ss=(n(hs,os=Ie),hs),us=(n(as,is=Ie),as);function as(t){var e=this;return(e=is.call(this)||this).elements=t,e}function hs(){return null!==os&&os.apply(this,arguments)||this}function cs(t,e){for(var n=ws(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return go(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ls,fs=(n(ps,ls=Ie),ps);function ps(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function ds(t,e){for(var n=ws(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!go(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,ys=(n(gs,vs=Ie),gs);function gs(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.se=e,n}function ms(t){return Io(t.integerValue||t.doubleValue)}function ws(t){return Ro(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function bs(t,e){this.field=t,this.transform=e}var Es=(Ts.prototype.ue=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].G(t))return!0;return!1},Ts.prototype.isEqual=function(t){return Jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ts);function Ts(t){(this.fields=t).sort(ii.k)}function Is(t,e){this.version=t,this.transformResults=e}var As=(Ns.ce=function(){return new Ns},Ns.exists=function(t){return new Ns(void 0,t)},Ns.updateTime=function(t){return new Ns(t)},Object.defineProperty(Ns.prototype,"ie",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ns.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ns);function Ns(t,e){this.updateTime=t,this.exists=e}function Os(t,e){return void 0!==t.updateTime?e instanceof eu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof eu}l=function(){};function Rs(t,e,n){return t instanceof _s?new eu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Vs?function(t,e,n){if(!Os(t.re,e))return new ru(t.key,n.version);e=js(t,e);return new eu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof xs?function(t,e,n){if(Vr(null!=n.transformResults),!Os(t.re,e))return new ru(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Vr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof eu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof us?cs(o,s):o instanceof fs?ds(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Fs(t,r.data(),e);return new eu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new nu(t.key,n.version,{hasCommittedMutations:!0})}function ks(t,e,n,r){return t instanceof _s?function(t,e){if(!Os(t.re,e))return e;e=Ds(e);return new eu(t.key,e,t.value,{ae:!0})}(t,e):t instanceof Vs?function(t,e){if(!Os(t.re,e))return e;var n=Ds(e),e=js(t,e);return new eu(t.key,n,e,{ae:!0})}(t,e):t instanceof xs?function(t,e,n,r){if(!Os(t.re,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof eu&&(c=n.field(a.field)),null===c&&r instanceof eu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof ss?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof us?cs(h,i):h instanceof fs?ds(h,i):(h=rs(c=h,i),i=ms(h)+ms(c.se),Oo(h)&&Oo(c.se)?Vo(i):Co(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Fs(t,i.data(),r);return new eu(t.key,i.version,r,{ae:!0})}(t,e,r,n):(e=e,Os((t=t).re,e)?new nu(t.key,ei.min()):e)}function Ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.re.isEqual(e.re)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.ee.isEqual(e.ee):2!==t.type||Jr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof us&&e instanceof us||t instanceof fs&&e instanceof fs?Jr(t.elements,e.elements,go):t instanceof ys&&e instanceof ys?go(t.se,e.se):t instanceof ss&&e instanceof ss)}))}function Ds(t){return t instanceof eu?t.version:ei.min()}var Ss,Ps,_s=(n(Us,Ps=l),Us),Vs=(n(Cs,Ss=l),Cs);function Cs(t,e,n,r){var i=this;return(i=Ss.call(this)||this).key=t,i.data=e,i.ee=n,i.re=r,i.type=1,i}function Us(t,e,n){var r=this;return(r=Ps.call(this)||this).key=t,r.value=e,r.re=n,r.type=0,r}function js(t,e){return n=t,e=e instanceof eu?e.data():Hs.empty(),r=new Xs(e),n.ee.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.he();var n,r}var Ms,xs=(n(qs,Ms=l),qs);function qs(t,e){var n=this;return(n=Ms.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.re=As.exists(!0),n}function Fs(t,e,n){for(var r=new Xs(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.he()}var Gs,Bs,Ws=(n(Js,Bs=l),Js),zs=(n(Qs,Gs=l),Qs),Hs=(Ks.empty=function(){return new Ks({mapValue:{}})},Ks.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Do(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.j()])||null},Ks.prototype.isEqual=function(t){return go(this.proto,t.proto)},Ks),Xs=(Ys.prototype.set=function(t,e){return this.fe(t,e),this},Ys.prototype.delete=function(t){return this.fe(t,null),this},Ys.prototype.fe=function(t,e){for(var n=this._e,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.j(),e)},Ys.prototype.he=function(){var t=this.de(ii.X(),this._e);return null!=t?new Hs(t):this.le},Ys.prototype.de=function(r,t){var i=this,o=!1,e=this.le.field(r),s=Do(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.de(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ys);function Ys(t){void 0===t&&(t=Hs.empty()),this.le=t,this._e=new Map}function Ks(t){this.proto=t}function Qs(t,e){var n=this;return(n=Gs.call(this)||this).key=t,n.re=e,n.type=4,n}function Js(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.re=e,n.type=3,n}var $s,Zs,tu,Ie=function(t,e){this.key=t,this.version=e},eu=(n(uu,tu=Ie),uu.prototype.field=function(t){return this.we.field(t)},uu.prototype.data=function(){return this.we},uu.prototype.Ee=function(){return this.we.proto},uu.prototype.isEqual=function(t){return t instanceof uu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.ae===t.ae&&this.hasCommittedMutations===t.hasCommittedMutations&&this.we.isEqual(t.we)},uu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.we.toString()+", {hasLocalMutations: "+this.ae+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.ae||this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu),nu=(n(su,Zs=Ie),su.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su),ru=(n(ou,$s=Ie),ou.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),ou.prototype.isEqual=function(t){return t instanceof ou&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ou),iu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.me=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Te=null,this.Ae=null,this.startAt,this.endAt};function ou(){return null!==$s&&$s.apply(this,arguments)||this}function su(t,e,n){var r=this;return(r=Zs.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function uu(t,e,n,r){var i=this;return(i=tu.call(this,t,e)||this).we=n,i.ae=!!r.ae,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function au(t){return new iu(t)}function hu(t){return!fi(t.limit)&&"F"===t.limitType}function cu(t){return!fi(t.limit)&&"L"===t.limitType}function lu(t){return 0<t.me.length?t.me[0].field:null}function fu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ie())return r.field}return null}function pu(t){return null!==t.collectionGroup}function du(t){var e=t;if(null===e.Te){e.Te=[];var n=fu(e),t=lu(e);if(null!==n&&null===t)n.tt()||e.Te.push(new Ju(n)),e.Te.push(new Ju(ii.nt(),"asc"));else{for(var r=!1,i=0,o=e.me;i<o.length;i++){var s=o[i];e.Te.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.me.length?e.me[e.me.length-1].dir:"asc",e.Te.push(new Ju(ii.nt(),n)))}}return e.Te}function vu(t){var e=t;if(!e.Ae)if("F"===e.limitType)e.Ae=vi(e.path,e.collectionGroup,du(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=du(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ju(o.field,s))}var u=e.endAt?new Bu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Bu(e.startAt.position,!e.startAt.before):null;e.Ae=vi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.Ae}function yu(t,e,n){return new iu(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gu(t,e){return gi(vu(t),vu(e))&&t.limitType===e.limitType}function mu(t){return yi(vu(t))+"|lt:"+t.limitType}function wu(t){return"Query(target="+(e=vu(t),n=e.path.Y(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.Y()+" "+t.op+" "+Eo(t.value)}).join(", ")+"]"),fi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.Y()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Yu(e.startAt)),e.endAt&&(n+=", endAt: "+Yu(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function bu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.G(n):oi.ot(e.path)?e.path.isEqual(n):e.path.K(n))&&function(t){for(var e=0,n=i.me;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Ku(t.startAt,du(t),n))&&(!t.endAt||!Ku(t.endAt,du(t),n)));var e,n}function Eu(u){return function(t,e){for(var n=!1,r=0,i=du(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?oi.k(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?wo(n,t):_r()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Tu,Iu=(n(Au,Tu=function(){}),Au.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Re(t,e,n):new ku(t,e,n):"array-contains"===e?new xu(t,n):"in"===e?new qu(t,n):"not-in"===e?new Fu(t,n):"array-contains-any"===e?new Gu(t,n):new Au(t,e,n)},Au.Re=function(t,e,n){return new("in"===e?Lu:Du)(t,n)},Au.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pe(wo(t,this.value)):null!==t&&yo(this.value)===yo(t)&&this.Pe(wo(t,this.value))},Au.prototype.Pe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},Au.prototype.Ie=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Au);function Au(t,e,n){var r=this;return(r=Tu.call(this)||this).field=t,r.op=e,r.value=n,r}var Nu,Ou,Ru,ku=(n(_u,Ru=Iu),_u.prototype.matches=function(t){t=oi.k(t.key,this.key);return this.Pe(t)},_u),Lu=(n(Pu,Ou=Iu),Pu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Pu),Du=(n(Su,Nu=Iu),Su.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Su);function Su(t,e){var n=this;return(n=Nu.call(this,t,"not-in",e)||this).keys=Vu(0,e),n}function Pu(t,e){var n=this;return(n=Ou.call(this,t,"in",e)||this).keys=Vu(0,e),n}function _u(t,e,n){var r=this;return(r=Ru.call(this,t,e,n)||this).key=oi.it(n.referenceValue),r}function Vu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return oi.it(t.referenceValue)})}var Cu,Uu,ju,Mu,xu=(n(Xu,Mu=Iu),Xu.prototype.matches=function(t){t=t.field(this.field);return Ro(t)&&mo(t.arrayValue,this.value)},Xu),qu=(n(Hu,ju=Iu),Hu.prototype.matches=function(t){t=t.field(this.field);return null!==t&&mo(this.value.arrayValue,t)},Hu),Fu=(n(zu,Uu=Iu),zu.prototype.matches=function(t){if(mo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!mo(this.value.arrayValue,t)},zu),Gu=(n(Wu,Cu=Iu),Wu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Ro(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},Wu),Bu=function(t,e){this.position=t,this.before=e};function Wu(t,e){return Cu.call(this,t,"array-contains-any",e)||this}function zu(t,e){return Uu.call(this,t,"not-in",e)||this}function Hu(t,e){return ju.call(this,t,"in",e)||this}function Xu(t,e){return Mu.call(this,t,"array-contains",e)||this}function Yu(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function Ku(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?oi.k(oi.it(s.referenceValue),n.key):wo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var Ju=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var $u=(sa.prototype.Ve=function(t,e,n){for(var r=n.pe,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Rs(o,e,r[i]))}return e},sa.prototype.ge=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ks(i,e,e,this.ye))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ks(a,e,o,this.ye))}return e},sa.prototype.ve=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ge(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},sa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gi())},sa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Jr(this.mutations,t.mutations,Ls)&&Jr(this.baseMutations,t.baseMutations,Ls)},sa),Zu=(oa.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=qi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new oa(t,e,n,r)},oa),ta=(ia.prototype.get=function(t){var e=this.Se(t),e=this.Ne[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.De(o,t))return i}},ia.prototype.has=function(t){return void 0!==this.get(t)},ia.prototype.set=function(t,e){var n=this.Se(t),r=this.Ne[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.De(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ne[n]=[[t,e]]},ia.prototype.delete=function(t){var e=this.Se(t),n=this.Ne[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.De(n[r][0],t))return 1===n.length?delete this.Ne[e]:n.splice(r,1),!0;return!1},ia.prototype.forEach=function(s){co(this.Ne,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ia.prototype.W=function(){return lo(this.Ne)},ia),ea=(ra.prototype.catch=function(t){return this.next(void 0,t)},ra.prototype.next=function(r,i){var o=this;return this.Le&&_r(),this.Le=!0,this.Oe?this.error?this.$e(i,this.error):this.ke(r,this.result):new ra(function(e,n){o.xe=function(t){o.ke(r,t).next(e,n)},o.Fe=function(t){o.$e(i,t).next(e,n)}})},ra.prototype.Me=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ra.prototype.Ue=function(t){try{var e=t();return e instanceof ra?e:ra.resolve(e)}catch(t){return ra.reject(t)}},ra.prototype.ke=function(t,e){return t?this.Ue(function(){return t(e)}):ra.resolve(e)},ra.prototype.$e=function(t,e){return t?this.Ue(function(){return t(e)}):ra.reject(e)},ra.resolve=function(n){return new ra(function(t,e){t(n)})},ra.reject=function(n){return new ra(function(t,e){e(n)})},ra.qe=function(t){return new ra(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ra.Be=function(t){for(var n=ra.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ra.resolve(t):e()})}(r[e]);return n},ra.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qe(i)},ra),na=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ra(t){var e=this;this.xe=null,this.Fe=null,this.result=void 0,this.error=void 0,this.Oe=!1,this.Le=!1,t(function(t){e.Oe=!0,e.result=t,e.xe&&e.xe(t)},function(t){e.Oe=!0,e.error=t,e.Fe&&e.Fe(t)})}function ia(t,e){this.Se=t,this.De=e,this.Ne={}}function oa(t,e,n,r){this.batch=t,this.be=e,this.pe=n,this.Ce=r}function sa(t,e,n,r){this.batchId=t,this.ye=e,this.baseMutations=n,this.mutations=r}function ua(t){return new _o(t,!0)}function aa(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ha=(da.prototype.Ge=function(e,n){var r=this;return this.je.Ke(e,n).next(function(t){return r.ze(e,n,t)})},da.prototype.ze=function(t,r,i){return this.Qe.He(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ge(r,t);return t})},da.prototype.Ye=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ge(t,e);o=o.Tt(t,e)}),o},da.prototype.Je=function(e,t){var n=this;return this.Qe.getEntries(e,t).next(function(t){return n.Xe(e,t)})},da.prototype.Xe=function(e,r){var i=this;return this.je.Ze(e,r).next(function(t){var t=i.Ye(e,r,t),n=Ui;return t.forEach(function(t,e){e=e||new nu(t,ei.min()),n=n.Tt(t,e)}),n})},da.prototype.ts=function(t,e,n){return r=e,oi.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ns(t,e.path):pu(e)?this.es(t,e,n):this.ss(t,e,n);var r},da.prototype.ns=function(t,e){return this.Ge(t,new oi(e)).next(function(t){var e=xi;return t instanceof eu&&(e=e.Tt(t.key,t)),e})},da.prototype.es=function(n,r,i){var o=this,s=r.collectionGroup,u=xi;return this.We.rs(n,s).next(function(t){return ea.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new iu(t,null,e.me.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.ss(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},da.prototype.ss=function(e,n,t){var h,c,r=this;return this.Qe.ts(e,n,t).next(function(t){return h=t,r.je.os(e,n)}).next(function(t){return c=t,r.us(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=ks(s,a,a,r.ye);h=a instanceof eu?h.Tt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){bu(n,e)||(h=h.remove(t))}),h})},da.prototype.us=function(t,e,n){for(var r=Gi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Vs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qe.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof eu&&(h=h.Tt(t,e))}),h})},da),ca=(pa.ls=function(t,e){for(var n=Gi(),r=Gi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new pa(t,e.fromCache,n,r)},pa),la=(fa.prototype.fs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},fa.prototype.next=function(){var t=++this.previousValue;return this.ds&&this.ds(t),t},fa);function fa(t,e){var n=this;this.previousValue=t,e&&(e._s=function(t){return n.fs(t)},this.ds=function(t){return e.ws(t)})}function pa(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.hs=r}function da(t,e,n){this.Qe=t,this.je=e,this.We=n}la.Es=-1;var va=(ya.prototype.reset=function(){this.ys=0},ya.prototype.gs=function(){this.ys=this.Ps},ya.prototype.vs=function(t){var e=this;this.cancel();var n=Math.floor(this.ys+this.bs()),r=Math.max(0,Date.now()-this.ps),i=Math.max(0,n-r);0<i&&Lr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ys+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Ts.Cs(this.As,i,function(){return e.ps=Date.now(),t()}),this.ys*=this.Rs,this.ys<this.Is&&(this.ys=this.Is),this.ys>this.Ps&&(this.ys=this.Ps)},ya.prototype.Ss=function(){null!==this.Vs&&(this.Vs.Ds(),this.Vs=null)},ya.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},ya.prototype.bs=function(){return(Math.random()-.5)*this.ys},ya);function ya(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.As=e,this.Is=n,this.Rs=r,this.Ps=i,this.ys=0,this.Vs=null,this.ps=Date.now(),this.reset()}function ga(t){return"IndexedDbTransactionError"===t.name}function ma(){return"undefined"!=typeof document?document:null}var wa=(Ta.Ls=function(t,e,n,r,i){i=new Ta(t,e,Date.now()+n,r,i);return i.start(n),i},Ta.prototype.start=function(t){var e=this;this.$s=setTimeout(function(){return e.ks()},t)},Ta.prototype.Ds=function(){return this.ks()},Ta.prototype.cancel=function(t){null!==this.$s&&(this.clearTimeout(),this.Os.reject(new Mr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ta.prototype.ks=function(){var e=this;this.Ns.Ms(function(){return null!==e.$s?(e.clearTimeout(),e.op().then(function(t){return e.Os.resolve(t)})):Promise.resolve()})},Ta.prototype.clearTimeout=function(){null!==this.$s&&(this.Fs(this),clearTimeout(this.$s),this.$s=null)},Ta),ba=(Object.defineProperty(Ea.prototype,"Hs",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),Ea.prototype.Ms=function(t){this.enqueue(t)},Ea.prototype.Ys=function(t){this.Js(),this.Xs(t)},Ea.prototype.Zs=function(){var t;this.Bs||(this.Bs=!0,(t=ma())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.zs))},Ea.prototype.enqueue=function(t){return this.Js(),this.Bs?new Promise(function(t){}):this.Xs(t)},Ea.prototype.ti=function(t){var e=this;this.Ms(function(){return e.qs.push(t),e.ni()})},Ea.prototype.ni=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.qs.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.qs[0]()];case 2:return t.sent(),this.qs.shift(),this.Ks.reset(),[3,4];case 3:if(!ga(e=t.sent()))throw e;return Lr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.qs.length&&this.Ks.vs(function(){return n.ni()}),t.label=5;case 5:return[2]}})})},Ea.prototype.Xs=function(t){var r=this,e=this.Us.then(function(){return r.Ws=!0,t().catch(function(t){throw r.js=t,r.Ws=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ws=!1,t})});return this.Us=e},Ea.prototype.Cs=function(t,e,n){var r=this;this.Js(),-1<this.Gs.indexOf(t)&&(e=0);n=wa.Ls(this,t,e,n,function(t){return r.ei(t)});return this.Qs.push(n),n},Ea.prototype.Js=function(){this.js&&_r()},Ea.prototype.si=function(){},Ea.prototype.ii=function(){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Us];case 1:t.sent(),t.label=2;case 2:if(e!==this.Us)return[3,0];t.label=3;case 3:return[2]}})})},Ea.prototype.ri=function(t){for(var e=0,n=this.Qs;e<n.length;e++)if(n[e].As===t)return!0;return!1},Ea.prototype.oi=function(r){var i=this;return this.ii().then(function(){i.Qs.sort(function(t,e){return t.xs-e.xs});for(var t=0,e=i.Qs;t<e.length;t++){var n=e[t];if(n.Ds(),"all"!==r&&n.As===r)break}return i.ii()})},Ea.prototype.ui=function(t){this.Gs.push(t)},Ea.prototype.ei=function(t){t=this.Qs.indexOf(t);this.Qs.splice(t,1)},Ea);function Ea(){var e=this;this.Us=Promise.resolve(),this.qs=[],this.Bs=!1,this.Qs=[],this.js=null,this.Ws=!1,this.Gs=[],this.Ks=new va(this,"async_queue_retry"),this.zs=function(){var t=ma();t&&Lr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Ks.Ss()};var t=ma();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.zs)}function Ta(t,e,n,r,i){this.Ns=t,this.As=e,this.xs=n,this.op=r,this.Fs=i,this.Os=new na,this.then=this.Os.promise.then.bind(this.Os.promise),this.Os.promise.catch(function(t){})}function Ia(t,e){if(Dr("AsyncQueue",e+": "+t),ga(t))return new Mr(jr.UNAVAILABLE,e+": "+t);throw t}function Aa(t){this.ci=t}var Na=(Pa.prototype.hi=function(t,e){return this.ai.add(e),ea.resolve()},Pa.prototype.rs=function(t,e){return ea.resolve(this.ai.getEntries(e))},Pa),Oa=(Sa.prototype.add=function(t){var e=t.j(),n=t.q(),r=this.index[e]||new Vi(ni.k),t=!r.has(n);return this.index[e]=r.add(n),t},Sa.prototype.has=function(t){var e=t.j(),t=t.q(),e=this.index[e];return e&&e.has(t)},Sa.prototype.getEntries=function(t){return(this.index[t]||new Vi(ni.k)).H()},Sa),Ra=(Da.prototype.next=function(){return this.li+=2,this.li},Da._i=function(){return new Da(0)},Da.fi=function(){return new Da(-1)},Da),ka=(La.prototype.bi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ci(t,n.wi)})},La);function La(t,e,n,r){this.persistence=t,this.di=e,this.serializer=r,this.wi=new Ri(Qr),this.Ei=new ta(yi,gi),this.mi=ei.min(),this.je=t.Ti(n),this.Ai=t.Ii(),this.Ri=t.Pi(),this.yi=new ha(this.Ai,this.je,this.persistence.Vi()),this.pi=t.gi(),this.di.vi(this.yi)}function Da(t){this.li=t}function Sa(){this.index={}}function Pa(){this.ai=new Oa}function _a(i,o){return v(this,void 0,void 0,function(){var e,n,m,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).je,m=e.yi,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.je.Si(y).next(function(t){return g=t,n=e.persistence.Ti(o),m=new ha(e.Ai,n,e.persistence.Vi()),n.Si(y)}).next(function(t){for(var e=[],n=[],r=Gi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Je(y,r).next(function(t){return{Di:t,Ni:e,xi:n}})})})];case 1:return r=t.sent(),[2,(e.je=n,e.yi=m,e.di.vi(e.yi),r)]}})})}function Va(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Ai.Fi({Oi:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=ea.resolve(),n.forEach(function(n){u=u.next(function(){return o.He(r,n)}).next(function(t){var e=t,t=i.Ce.get(n);Vr(null!==t),(!e||e.version.F(t)<0)&&(e=s.Ve(n,e,i))&&o.Li(e,i.be)})}),u.next(function(){return e.je.$i(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.je.ki(t)}).next(function(){return l.yi.Je(t,a)})})}function Ca(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ri.Mi(t)})}function Ua(t,o){var c=t,l=o.ft,f=c.wi;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=c.Ai.Fi({Oi:!0});f=c.wi;var u=[];o.on.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.Ri.Ui(s,t.wn,e).next(function(){return c.Ri.qi(s,t.fn,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,l).dt(s.Bi),f=f.Tt(e,n),r=o,i=t,Vr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i.fn.size+i.dn.size+i.wn.size)&&u.push(c.Ri.Qi(s,n))))});var e,a,n,h,r,i=Ui;return o.cn.forEach(function(t,e){o.an.has(t)&&u.push(c.persistence.Wi.ji(s,t))}),u.push((e=s,a=t,n=o.cn,h=l,r=Gi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Ui;return n.forEach(function(t,e){var n=i.get(t),r=h;e instanceof nu&&e.version.isEqual(ei.min())?(a.Gi(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.Li(e,r),o=o.Tt(t,e)):Lr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),l.isEqual(ei.min())||(e=c.Ri.Mi(s).next(function(t){return c.Ri.Ki(s,s.Bi,l)}),u.push(e)),ea.qe(u).next(function(){return t.apply(s)}).next(function(){return c.yi.Xe(s,i)})}).then(function(t){return c.wi=f,t})}function ja(i,o,s){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:n=(e=i).wi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wi.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ga(r=t.sent()))throw r;return Lr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.wi=e.wi.remove(o),e.Ei.delete(n.target),[2]}})})}function Ma(t,o,s){var u=t,a=ei.min(),h=Gi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=vu(o),(void 0!==(t=(i=t).Ei.get(r))?ea.resolve(i.wi.get(t)):i.Ri.Hi(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ri.Yi(e,t.targetId).next(function(t){h=t})}).next(function(){return u.di.ts(e,o,s?a:ei.min(),s?h:Gi())}).next(function(t){return{documents:t,Ji:h}});var t,n,r,i})}function xa(e){return v(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==jr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Lr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function qa(t,e,n,r,i){var o=this;this.jr=t,this.Wr=e,this.Ns=n,this.Gr={},this.Kr=[],this.zr=new Map,this.Hr=new Set,this.Yr=[],this.Jr=i,this.Jr.Xr(function(t){n.Ms(function(){return v(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return uh(this)?(Lr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(4),[4,th(e)];case 1:return t.sent(),e.Zr.set("Unknown"),e.Hr.delete(4),[4,Za(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zr=new Xa(n,r)}var Fa,Ga,Ba,l=($a.prototype.sr=function(){return 1===this.state||2===this.state||4===this.state},$a.prototype.ir=function(){return 2===this.state},$a.prototype.start=function(){3!==this.state?this.auth():this.rr()},$a.prototype.stop=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.sr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$a.prototype.ur=function(){this.state=0,this.Ks.reset()},$a.prototype.cr=function(){var t=this;this.ir()&&null===this.er&&(this.er=this.Ts.Cs(this.Xi,6e4,function(){return t.ar()}))},$a.prototype.hr=function(t){this.lr(),this.stream.send(t)},$a.prototype.ar=function(){return v(this,void 0,void 0,function(){return y(this,function(t){return this.ir()?[2,this.close(0)]:[2]})})},$a.prototype.lr=function(){this.er&&(this.er.cancel(),this.er=null)},$a.prototype.close=function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.lr(),this.Ks.cancel(),this.nr++,3!==e?this.Ks.reset():n&&n.code===jr.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Ks.gs()):n&&n.code===jr.UNAUTHENTICATED&&this.tr.A(),null!==this.stream&&(this._r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.dr(n)];case 1:return t.sent(),[2]}})})},$a.prototype._r=function(){},$a.prototype.auth=function(){var n=this;this.state=1;var t=this.wr(this.nr),e=this.nr;this.tr.getToken().then(function(t){n.nr===e&&n.Er(t)},function(e){t(function(){var t=new Mr(jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mr(t)})})},$a.prototype.Er=function(t){var e=this,n=this.wr(this.nr);this.stream=this.Tr(t),this.stream.Ar(function(){n(function(){return e.state=2,e.listener.Ar()})}),this.stream.dr(function(t){n(function(){return e.mr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$a.prototype.rr=function(){var t=this;this.state=4,this.Ks.vs(function(){return v(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},$a.prototype.mr=function(t){return Lr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$a.prototype.wr=function(e){var n=this;return function(t){n.Ts.Ms(function(){return n.nr===e?t():(Lr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$a),Wa=(n(Ja,Ba=l),Ja.prototype.Tr=function(t){return this.Zi.Ir("Listen",t)},Ja.prototype.onMessage=function(t){this.Ks.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:_r(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.ne?(Vr(void 0===o||"string"==typeof o),wi.fromBase64String(o||"")):(Vr(void 0===o||o instanceof Uint8Array),wi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?jr.UNKNOWN:Oi(s.code),new Mr(o,s.message||"")),r=new Ji(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Bo(t,u.document.name),a=xo(u.document.updateTime),s=new Hs({mapValue:{fields:u.document.fields}}),a=new eu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Ki(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Bo(t,u.document),h=u.readTime?xo(u.readTime):ei.min(),h=new nu(a,h),u=u.removedTargetIds||[];r=new Ki([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=Bo(t,h.document),h=h.removedTargetIds||[];r=new Ki([],h,c,null)}else{if(!("filter"in e))return _r();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Ei(e),c=c.targetId;r=new Qi(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ei.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?xo(t.readTime):ei.min()}(t);return this.listener.Rr(e,t)},Ja.prototype.Pr=function(t){var e,n,r,i={};i.database=zo(this.serializer),i.addTarget=(e=this.serializer,(r=mi(r=(n=t).target)?{documents:{documents:[Wo(e,r.path)]}}:{query:Ko(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=Mo(e,n.resumeToken):0<n.ft.F(ei.min())&&(r.readTime=jo(e,n.ft.L())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.hr(i)},Ja.prototype.yr=function(t){var e={};e.database=zo(this.serializer),e.removeTarget=t,this.hr(e)},Ja),za=(n(Qa,Ga=l),Object.defineProperty(Qa.prototype,"pr",{get:function(){return this.Vr},enumerable:!1,configurable:!0}),Qa.prototype.start=function(){this.Vr=!1,this.lastStreamToken=void 0,Ga.prototype.start.call(this)},Qa.prototype._r=function(){this.Vr&&this.gr([])},Qa.prototype.Tr=function(t){return this.Zi.Ir("Write",t)},Qa.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Vr){this.Ks.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Vr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(ei.min())&&(n=xo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Is(n,e)}(t,r)})):[]),n=xo(t.commitTime);return this.listener.vr(n,e)}var n,r;return Vr(!t.writeResults||0===t.writeResults.length),this.Vr=!0,this.listener.br()},Qa.prototype.Cr=function(){var t={};t.database=zo(this.serializer),this.hr(t)},Qa.prototype.gr=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yo(e.serializer,t)})};this.hr(t)},Qa),Ha=(n(Ka,Fa=function(){}),Ka.prototype.Dr=function(){if(this.Sr)throw new Mr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Ka.prototype.Nr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Nr(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.A(),t})},Ka.prototype.Fr=function(e,n,r){var i=this;return this.Dr(),this.credentials.getToken().then(function(t){return i.Zi.Fr(e,n,r,t)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&i.credentials.A(),t})},Ka.prototype.terminate=function(){this.Sr=!1},Ka),Xa=(Ya.prototype.Mr=function(){var t=this;0===this.Lr&&(this.Ur("Unknown"),this.$r=this.Ns.Cs("online_state_timeout",1e4,function(){return t.$r=null,t.qr("Backend didn't respond within 10 seconds."),t.Ur("Offline"),Promise.resolve()}))},Ya.prototype.Br=function(t){"Online"===this.state?this.Ur("Unknown"):(this.Lr++,1<=this.Lr&&(this.Qr(),this.qr("Connection failed 1 times. Most recent error: "+t.toString()),this.Ur("Offline")))},Ya.prototype.set=function(t){this.Qr(),this.Lr=0,"Online"===t&&(this.kr=!1),this.Ur(t)},Ya.prototype.Ur=function(t){t!==this.state&&(this.state=t,this.Or(t))},Ya.prototype.qr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.kr?(Dr(t),this.kr=!1):Lr("OnlineStateTracker",t)},Ya.prototype.Qr=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},Ya);function Ya(t,e){this.Ns=t,this.Or=e,this.state="Unknown",this.Lr=0,this.$r=null,this.kr=!0}function Ka(t,e,n){var r=this;return(r=Fa.call(this)||this).credentials=t,r.Zi=e,r.serializer=n,r.Sr=!1,r}function Qa(t,e,n,r,i){var o=this;return(o=Ga.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Vr=!1,o}function Ja(t,e,n,r,i){var o=this;return(o=Ba.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $a(t,e,n,r,i,o){this.Ts=t,this.Xi=n,this.Zi=r,this.tr=i,this.listener=o,this.state=0,this.nr=0,this.er=null,this.stream=null,this.Ks=new va(t,e)}function Za(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:if(!uh(r))return[3,4];e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function th(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:e=0,n=r.Yr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function eh(t,e){t.zr.has(e.targetId)||(t.zr.set(e.targetId,e),sh(t)?oh(t):vh(t).ir()&&rh(t,e))}function nh(t,e){var n=t,t=vh(n);n.zr.delete(e),t.ir()&&ih(n,e),0===n.zr.size&&(t.ir()?t.cr():uh(n)&&n.Zr.set("Unknown"))}function rh(t,e){t.no.Dn(e.targetId),vh(t).Pr(e)}function ih(t,e){t.no.Dn(e),vh(t).yr(e)}function oh(e){e.no=new Zi({Zn:function(t){return e.Gr.Zn(t)},te:function(t){return e.zr.get(t)||null}}),vh(e).start(),e.Zr.Mr()}function sh(t){return uh(t)&&!vh(t).sr()&&0<t.zr.size}function uh(t){return 0===t.Hr.size}function ah(t){t.no=void 0}function hh(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:if(s.Zr.set("Online"),!(u instanceof Ji&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zr.has(i)?[4,o.Gr.eo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zr.delete(i),o.no.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Lr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,ch(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ki?s.no.Mn(u):u instanceof Qi?s.no.Kn(u):s.no.Bn(u),a.isEqual(ei.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ca(s.jr)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).no.Yn(i)).on.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.zr.get(e))&&r.zr.set(e,n.wt(t.resumeToken,i)))}),e.un.forEach(function(t){var e=r.zr.get(t);e&&(r.zr.set(t,e.wt(wi.lt,e.ft)),ih(r,t),e=new Ii(e.target,t,1,e.sequenceNumber),rh(r,e))}),r.Gr.so(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Lr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,ch(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function ch(n,r,i){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ga(r))throw r;return n.Hr.add(1),[4,th(n)];case 1:return t.sent(),n.Zr.set("Offline"),i=i||function(){return Ca(n.jr)},n.Ns.ti(function(){return v(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hr.delete(1),[4,Za(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function lh(e,n){return n().catch(function(t){return ch(e,t,n)})}function fh(a){return v(this,void 0,void 0,function(){var i,o,s,u;return y(this,function(t){switch(t.label){case 0:o=yh(i=a),s=0<i.Kr.length?i.Kr[i.Kr.length-1].batchId:-1,t.label=1;case 1:if(!(uh(i)&&i.Kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.jr,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.je.zi(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Kr.length&&o.cr(),[3,7]):(s=u.batchId,function(t,e){t.Kr.push(e);t=yh(t);t.ir()&&t.pr&&t.gr(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,ch(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return ph(i)&&dh(i),[2]}var e,n,r})})}function ph(t){return uh(t)&&!yh(t).sr()&&0<t.Kr.length}function dh(t){yh(t).start()}function vh(n){var t,e,r,i=this;return n.oo||(n.oo=(t=n.Wr,e=n.Ns,r={Ar:function(n){return v(this,void 0,void 0,function(){return y(this,function(t){return n.zr.forEach(function(t,e){rh(n,t)}),[2]})})}.bind(null,n),dr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){return ah(e),sh(e)?(e.Zr.Br(n),oh(e)):e.Zr.set("Unknown"),[2]})})}.bind(null,n),Rr:hh.bind(null,n)},t.Dr(),new Wa(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.oo.ur(),sh(n)?oh(n):n.Zr.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.oo.stop()];case 2:t.sent(),ah(n),t.label=3;case 3:return[2]}})})})),n.oo}function yh(n){var t,e,r,i=this;return n.uo||(n.uo=(t=n.Wr,e=n.Ns,r={Ar:function(e){return v(this,void 0,void 0,function(){return y(this,function(t){return yh(e).Cr(),[2]})})}.bind(null,n),dr:function(e,n){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return n&&yh(e).pr?[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return Ni(n=i.code)&&n!==jr.ABORTED?(e=r.Kr.shift(),yh(r).ur(),[4,lh(r,function(){return r.Gr.ro(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,fh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return ph(e)&&dh(e),[2]}})})}.bind(null,n),br:function(o){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){for(e=yh(o),n=0,r=o.Kr;n<r.length;n++)i=r[n],e.gr(i.mutations);return[2]})})}.bind(null,n),vr:function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=r.Kr.shift(),n=Zu.from(e,i,o),[4,lh(r,function(){return r.Gr.io(n)})];case 1:return t.sent(),[4,fh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Dr(),new za(e,t.Zi,t.credentials,t.serializer,r)),n.Yr.push(function(e){return v(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(n.uo.ur(),[4,fh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.uo.stop()];case 3:t.sent(),0<n.Kr.length&&(Lr("RemoteStore","Stopping write stream with "+n.Kr.length+" pending writes"),n.Kr=[]),t.label=4;case 4:return[2]}})})})),n.uo}function gh(){this.queries=new ta(mu,gu),this.onlineState="Unknown",this.ao=new Set}var mh=function(){this.co=void 0,this.listeners=[]};function wh(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new mh),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ho(n)];case 2:return o.co=t.sent(),[3,4];case 3:return o=t.sent(),o=Ia(o,"Initialization of query '"+wu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.lo(e.onlineState),i.co&&u._o(i.co)&&Eh(e),[2]}})})}function bh(s,u){return v(this,void 0,void 0,function(){var e,n,r,i,o;return y(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.fo(n))]:[2]})})}function Eh(t){t.ao.forEach(function(t){t.next()})}var Th=(xh.prototype._o=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Hi(t.query,t.docs,t.tn,e,t.nn,t.fromCache,t.en,!0)}var o=!1;return this.Eo?this.To(t)&&(this.wo.next(t),o=!0):this.Ao(t,this.onlineState)&&(this.Io(t),o=!0),this.mo=t,o},xh.prototype.onError=function(t){this.wo.error(t)},xh.prototype.lo=function(t){this.onlineState=t;var e=!1;return this.mo&&!this.Eo&&this.Ao(this.mo,t)&&(this.Io(this.mo),e=!0),e},xh.prototype.Ao=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ro&&n||t.docs.W()&&"Offline"!==e)},xh.prototype.To=function(t){if(0<t.docChanges.length)return!0;var e=this.mo&&this.mo.hasPendingWrites!==t.hasPendingWrites;return!(!t.en&&!e)&&!0===this.options.includeMetadataChanges},xh.prototype.Io=function(t){t=Hi.rn(t.query,t.docs,t.nn,t.fromCache),this.Eo=!0,this.wo.next(t)},xh),Ih=(Mh.prototype.W=function(){return this.Po.W()},Mh.prototype.vo=function(t,e){e=new Ah(t,e);this.Po=this.Po.add(e),this.Vo=this.Vo.add(e)},Mh.prototype.bo=function(t,e){var n=this;t.forEach(function(t){return n.vo(t,e)})},Mh.prototype.Co=function(t,e){this.So(new Ah(t,e))},Mh.prototype.Do=function(t,e){var n=this;t.forEach(function(t){return n.Co(t,e)})},Mh.prototype.No=function(t){var e=this,n=new oi(new ni([])),r=new Ah(n,t),t=new Ah(n,t+1),i=[];return this.Vo.jt([r,t],function(t){e.So(t),i.push(t.key)}),i},Mh.prototype.xo=function(){var e=this;this.Po.forEach(function(t){return e.So(t)})},Mh.prototype.So=function(t){this.Po=this.Po.delete(t),this.Vo=this.Vo.delete(t)},Mh.prototype.Fo=function(t){var e=new oi(new ni([])),n=new Ah(e,t),t=new Ah(e,t+1),r=Gi();return this.Vo.jt([n,t],function(t){r=r.add(t.key)}),r},Mh.prototype.Oo=function(t){var e=new Ah(t,0),e=this.Po.Gt(e);return null!==e&&t.isEqual(e.key)},Mh),Ah=(jh.yo=function(t,e){return oi.k(t.key,e.key)||Qr(t.Lo,e.Lo)},jh.po=function(t,e){return Qr(t.Lo,e.Lo)||oi.k(t.key,e.key)},jh),Nh=(Uh.prototype.$o=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Uh.prototype.ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Uh.prototype.Mo=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},Uh),Oh=(Ch.prototype.Bo=function(t){},Ch.prototype.Qo=function(t,e,n){},Ch.prototype.jo=function(t){return this.Uo.$o(t),this.qo[t]||"not-current"},Ch.prototype.Wo=function(t,e,n){this.qo[t]=e},Ch.prototype.Go=function(t){this.Uo.ko(t)},Ch.prototype.Ko=function(t){return this.Uo.activeTargetIds.has(t)},Ch.prototype.zo=function(t){delete this.qo[t]},Ch.prototype.Ho=function(){return this.Uo.activeTargetIds},Ch.prototype.Yo=function(t){return this.Uo.activeTargetIds.has(t)},Ch.prototype.start=function(){return this.Uo=new Nh,Promise.resolve()},Ch.prototype.Jo=function(t,e,n){},Ch.prototype.Xo=function(t){},Ch.prototype.Zo=function(){},Ch.prototype.ws=function(t){},Ch.prototype.tu=function(){},Ch),Rh=function(t){this.key=t},kh=function(t){this.key=t},Lh=(Object.defineProperty(Vh.prototype,"ou",{get:function(){return this.nu},enumerable:!1,configurable:!0}),Vh.prototype.uu=function(t,e){var s=this,u=e?e.cu:new zi,a=(e||this).ru,h=(e||this).nn,c=a,l=!1,f=hu(this.query)&&a.size===this.query.limit?a.last():null,p=cu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof eu?e:null)&&(bu(s.query,r)?r:null),i=!!n&&s.nn.has(n.key),o=!!r&&(r.ae||s.nn.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.au(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.iu(r,f)||p&&s.iu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),hu(this.query)||cu(this.query))for(;c.size>this.query.limit;){var n=hu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{ru:c,cu:u,hu:l,nn:h}},Vh.prototype.au=function(t,e){return t.ae&&e.hasCommittedMutations&&!e.ae},Vh.prototype.lu=function(t,e,n){var o=this,r=this.ru;this.ru=t.ru,this.nn=t.nn;var i=t.cu.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.iu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this._u(n);var s=e?this.fu():[],n=0===this.su.size&&this._n?1:0,e=n!==this.eu;return this.eu=n,0!==i.length||e?{snapshot:new Hi(this.query,t.ru,r,i,t.nn,0==n,e,!1),du:s}:{du:s}},Vh.prototype.lo=function(t){return this._n&&"Offline"===t?(this._n=!1,this.lu({ru:this.ru,cu:new zi,nn:this.nn,hu:!1},!1)):{du:[]}},Vh.prototype.wu=function(t){return!this.nu.has(t)&&!!this.ru.has(t)&&!this.ru.get(t).ae},Vh.prototype._u=function(t){var e=this;t&&(t.fn.forEach(function(t){return e.nu=e.nu.add(t)}),t.dn.forEach(function(t){}),t.wn.forEach(function(t){return e.nu=e.nu.delete(t)}),this._n=t._n)},Vh.prototype.fu=function(){var e=this;if(!this._n)return[];var n=this.su;this.su=Gi(),this.ru.forEach(function(t){e.wu(t.key)&&(e.su=e.su.add(t.key))});var r=[];return n.forEach(function(t){e.su.has(t)||r.push(new kh(t))}),this.su.forEach(function(t){n.has(t)||r.push(new Rh(t))}),r},Vh.prototype.Eu=function(t){this.nu=t.Ji,this.su=Gi();t=this.uu(t.documents);return this.lu(t,!0)},Vh.prototype.mu=function(){return Hi.rn(this.query,this.ru,this.nn,0===this.eu)},Vh),Dh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Sh=function(t){this.key=t,this.Tu=!1},Ph=(Object.defineProperty(_h.prototype,"Fu",{get:function(){return!0===this.xu},enumerable:!1,configurable:!0}),_h);function _h(t,e,n,r,i,o){this.jr=t,this.Au=e,this.Iu=n,this.Ru=r,this.currentUser=i,this.Pu=o,this.yu={},this.Vu=new ta(mu,gu),this.pu=new Map,this.gu=[],this.vu=new Ri(oi.k),this.bu=new Map,this.Cu=new Ih,this.Su={},this.Du=new Map,this.Nu=Ra.fi(),this.onlineState="Unknown",this.xu=void 0}function Vh(t,e){this.query=t,this.nu=e,this.eu=null,this._n=!1,this.su=Gi(),this.nn=Gi(),this.iu=Eu(t),this.ru=new Wi(this.iu)}function Ch(){this.Uo=new Nh,this.qo={},this.Or=null,this._s=null}function Uh(){this.activeTargetIds=Bi}function jh(t,e){this.key=t,this.Lo=e}function Mh(){this.Po=new Vi(Ah.yo),this.Vo=new Vi(Ah.po)}function xh(t,e,n){this.query=t,this.wo=e,this.Eo=!1,this.mo=null,this.onlineState="Unknown",this.options=n||{}}function qh(h,c){return v(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return(e=h).Au.Gr.so=Gh.bind(null,e),e.Au.Gr.Zn=function(t,e){var n=t,t=n.bu.get(e);if(t&&t.Tu)return Gi().add(t.key);var r=Gi(),e=n.pu.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Vu.get(s);r=r.Kt(s.view.ou)}return r}.bind(null,e),e.Au.Gr.eo=function(o,s,u){return v(this,void 0,void 0,function(){var e,n,r,i;return y(this,function(t){switch(t.label){case 0:return(e=o).Ru.Wo(s,"rejected",u),i=e.bu.get(s),(n=i&&i.key)?(r=(r=new Ri(oi.k)).Tt(n,new nu(n,ei.min())),i=Gi().add(n),i=new Xi(ei.min(),new Map,new Vi(Qr),r,i),[4,Gh(e,i)]):[3,2];case 1:return t.sent(),e.vu=e.vu.remove(n),e.bu.delete(s),Qh(e),[3,4];case 2:return[4,ja(e.jr,s,!1).then(function(){return Xh(e,s,u)}).catch(xa)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.yu.Rr=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a]._o(s)&&(r=!0);u.co=s}}r&&Eh(n)}.bind(null,e.Iu),e.yu.Ou=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Iu),(a=(n=e).Vu.get(c))?(o=a.targetId,n.Ru.jo(o),s=a.view.mu(),[3,4]):[3,1];case 1:return[4,(e=n.jr,r=vu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ri.Hi(e,r).next(function(t){return t?(n=t,ea.resolve(n)):i.Ri.Lu(e).next(function(t){return n=new Ii(r,t,0,e.Bi),i.Ri.$u(e,n).next(function(){return n})})})}).then(function(t){var e=i.wi.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.wi=i.wi.Tt(t.targetId,t),i.Ei.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Ru.jo(u.targetId),o=u.targetId,[4,function(i,o,s,u){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return i.ku=function(t,e,n){return function(r,i,o,s){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=i.view.uu(o)).hu?[4,Ma(r.jr,i.query,!1).then(function(t){t=t.documents;return i.view.uu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.on.get(i.targetId),n=i.view.lu(e,r.Fu,n),[2,(Kh(r,i.targetId,n.du),n.snapshot)]}})})}(i,t,e,n)},[4,Ma(i.jr,o,!0)];case 1:return n=t.sent(),r=new Lh(o,n.Ji),e=r.uu(n.documents),n=Yi.ln(s,u&&"Offline"!==i.onlineState),n=r.lu(e,i.Fu,n),Kh(i,s,n.du),r=new Dh(o,s,r),i.Vu.set(o,r),i.pu.has(s)?i.pu.get(s).push(o):i.pu.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Fu&&eh(n.Au,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function Fh(f,p,d){return v(this,void 0,void 0,function(){var s,u;return y(this,function(t){switch(t.label){case 0:(o=f).Au.Gr.io=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Va(e.jr,o)];case 2:return r=t.sent(),Hh(e,n,null),zh(e,n),e.Ru.Qo(n,"acknowledged"),[4,Jh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Au.Gr.ro=function(s,u,a){return v(this,void 0,void 0,function(){var n,o;return y(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.jr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.je.qu(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.je.$i(e,t)}).next(function(){return i.je.ki(e)}).next(function(){return i.yi.Je(e,n)})}))];case 2:return o=t.sent(),Hh(n,u,a),zh(n,u),n.Ru.Qo(u,"rejected",a),[4,Jh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.jr,a=p,c=r,l=ti.now(),i=a.reduce(function(t,e){return t.add(e.key)},Gi()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.yi.Je(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof xs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof eu?t.field(i.field):void 0,o=rs(i.transform,o||null);null!=o&&(e=(null==e?new Xs:e).set(i.field,o))}return e?e.he():null}(o):null);null!=o&&e.push(new Vs(i.key,o,function s(t){var u=[];return co(t.fields||{},function(t,e){var n=new ii([t]);if(Do(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Es(u)}(o.proto.mapValue),As.exists(!0)))}return c.je.Mu(u,l,e,a)})}).then(function(t){var e=t.ve(h);return{batchId:t.batchId,Uu:e}}))];case 2:return s=t.sent(),u.Ru.Bo(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.Su[e.currentUser.h()])||new Ri(Qr)).Tt(n,o),e.Su[e.currentUser.h()]=r,[4,Jh(u,s.Uu)];case 3:return t.sent(),[4,fh(u.Au)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ia(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Gh(r,i){return v(this,void 0,void 0,function(){var n,e;return y(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ua(n.jr,i)];case 2:return e=t.sent(),i.on.forEach(function(t,e){e=n.bu.get(e);e&&(Vr(t.fn.size+t.dn.size+t.wn.size<=1),0<t.fn.size?e.Tu=!0:0<t.dn.size?Vr(e.Tu):0<t.wn.size&&(Vr(e.Tu),e.Tu=!1))}),[4,Jh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,xa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Bh(t,n,e){var r,t=t;(t.Fu&&0===e||!t.Fu&&1===e)&&(r=[],t.Vu.forEach(function(t,e){e=e.view.lo(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].lo(i)&&(o=!0)}),o&&Eh(t)}(t.Iu,n),r.length&&t.yu.Rr(r),t.onlineState=n,t.Fu&&t.Ru.Xo(n))}function Wh(o,s){return v(this,void 0,void 0,function(){var n,r,i;return y(this,function(t){switch(t.label){case 0:uh((n=o).Au)||Lr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.jr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.je.Bu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Du.get(r)||[]).push(s),n.Du.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ia(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function zh(t,e){(t.Du.get(e)||[]).forEach(function(t){t.resolve()}),t.Du.delete(e)}function Hh(t,e,n){var r=t,i=r.Su[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Su[r.currentUser.h()]=i)}function Xh(e,t,n){void 0===n&&(n=null),e.Ru.Go(t);for(var r=0,i=e.pu.get(t);r<i.length;r++){var o=i[r];e.Vu.delete(o),n&&e.yu.Ou(o,n)}e.pu.delete(t),e.Fu&&e.Cu.No(t).forEach(function(t){e.Cu.Oo(t)||Yh(e,t)})}function Yh(t,e){var n=t.vu.get(e);null!==n&&(nh(t.Au,n),t.vu=t.vu.remove(e),t.bu.delete(n),Qh(t))}function Kh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Rh?(t.Cu.vo(o.key,e),function(t,e){e=e.key;t.vu.get(e)||(Lr("SyncEngine","New document in limbo: "+e),t.gu.push(e),Qh(t))}(t,o)):o instanceof kh?(Lr("SyncEngine","Document no longer in limbo: "+o.key),t.Cu.Co(o.key,e),t.Cu.Oo(o.key)||Yh(t,o.key)):_r()}}function Qh(t){for(;0<t.gu.length&&t.vu.size<t.Pu;){var e=t.gu.shift(),n=t.Nu.next();t.bu.set(n,new Sh(e)),t.vu=t.vu.Tt(e,n),eh(t.Au,new Ii(vu(au(e.path)),n,2,la.Es))}}function Jh(e,s,u){return v(this,void 0,void 0,function(){var n,r,i,o;return y(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Vu.W()?[3,3]:(n.Vu.forEach(function(t,e){o.push(n.ku(e,s,u).then(function(t){t&&(n.Fu&&n.Ru.Wo(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ca.ls(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.yu.Rr(r),[4,function(a,h){return v(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return y(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ea.forEach(h,function(e){return ea.forEach(e.cs,function(t){return r.persistence.Wi.vo(n,e.targetId,t)}).next(function(){return ea.forEach(e.hs,function(t){return r.persistence.Wi.Co(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ga(e=t.sent()))throw e;return Lr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.wi.get(o),u=s.ft,u=s.Et(u),r.wi=r.wi.Tt(o,u));return[2]}})})}(n.jr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function $h(i,o){return v(this,void 0,void 0,function(){var n,r;return y(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Lr("SyncEngine","User change. New user:",o.h()),[4,_a(n.jr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Du.forEach(function(t){t.forEach(function(t){t.reject(new Mr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Du.clear(),n.Ru.Jo(o,r.Ni,r.xi),[4,Jh(n,r.Di)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var Zh,tc,ec,nc=(Mc.prototype.vi=function(t){this.Qu=t},Mc.prototype.ts=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.me.length||1===r.me.length&&r.me[0].field.tt())||i.isEqual(ei.min())?this.ju(e,r):this.Qu.Je(e,o).next(function(t){var n=s.Wu(r,t);return(hu(r)||cu(r))&&s.hu(r.limitType,n,o,i)?s.ju(e,r):(kr()<=u.DEBUG&&Lr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wu(r)),s.Qu.ts(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},Mc.prototype.Wu=function(n,t){var r=new Vi(Eu(n));return t.forEach(function(t,e){e instanceof eu&&bu(n,e)&&(r=r.add(e))}),r},Mc.prototype.hu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},Mc.prototype.ju=function(t,e){return kr()<=u.DEBUG&&Lr("IndexFreeQueryEngine","Using full collection scan to execute query:",wu(e)),this.Qu.ts(t,e,ei.min())},Mc),rc=(jc.prototype.zu=function(t){return ea.resolve(0===this.je.length)},jc.prototype.Mu=function(t,e,n,r){var i=this.Gu;this.Gu++,0<this.je.length&&this.je[this.je.length-1];n=new $u(i,e,n,r);this.je.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Ku=this.Ku.add(new Ah(u.key,i)),this.We.hi(t,u.key.path.q())}return ea.resolve(n)},jc.prototype.qu=function(t,e){return ea.resolve(this.Hu(e))},jc.prototype.zi=function(t,e){e+=1,e=this.Yu(e),e=e<0?0:e;return ea.resolve(this.je.length>e?this.je[e]:null)},jc.prototype.Bu=function(){return ea.resolve(0===this.je.length?-1:this.Gu-1)},jc.prototype.Si=function(t){return ea.resolve(this.je.slice())},jc.prototype.Ke=function(t,e){var n=this,r=new Ah(e,0),e=new Ah(e,Number.POSITIVE_INFINITY),i=[];return this.Ku.jt([r,e],function(t){t=n.Hu(t.Lo);i.push(t)}),ea.resolve(i)},jc.prototype.Ze=function(t,e){var n=this,r=new Vi(Qr);return e.forEach(function(t){var e=new Ah(t,0),t=new Ah(t,Number.POSITIVE_INFINITY);n.Ku.jt([e,t],function(t){r=r.add(t.Lo)})}),ea.resolve(this.Ju(r))},jc.prototype.os=function(t,e){var n=e.path,r=n.length+1,e=n;oi.ot(e)||(e=e.child(""));var e=new Ah(new oi(e),0),i=new Vi(Qr);return this.Ku.Wt(function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(i=i.add(t.Lo)),!0)},e),ea.resolve(this.Ju(i))},jc.prototype.Ju=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Hu(t);null!==t&&n.push(t)}),n},jc.prototype.$i=function(n,r){var i=this;Vr(0===this.Xu(r.batchId,"removed")),this.je.shift();var o=this.Ku;return ea.forEach(r.mutations,function(t){var e=new Ah(t.key,r.batchId);return o=o.delete(e),i.Wi.Zu(n,t.key)}).next(function(){i.Ku=o})},jc.prototype.tc=function(t){},jc.prototype.Oo=function(t,e){var n=new Ah(e,0),n=this.Ku.Gt(n);return ea.resolve(e.isEqual(n&&n.key))},jc.prototype.ki=function(t){return this.je.length,ea.resolve()},jc.prototype.Xu=function(t,e){return this.Yu(t)},jc.prototype.Yu=function(t){return 0===this.je.length?0:t-this.je[0].batchId},jc.prototype.Hu=function(t){t=this.Yu(t);return t<0||t>=this.je.length?null:this.je[t]},jc),ic=(Uc.prototype.Li=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.nc(e);return this.docs=this.docs.Tt(r,{ec:e,size:i,readTime:n}),this.size+=i-o,this.We.hi(t,r.path.q())},Uc.prototype.Gi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Uc.prototype.He=function(t,e){e=this.docs.get(e);return ea.resolve(e?e.ec:null)},Uc.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.ec:null)}),ea.resolve(r)},Uc.prototype.ts=function(t,e,n){for(var r=xi,i=new oi(e.path.child("")),o=this.docs.gt(i);o.Nt();){var s=o.Dt(),u=s.key,a=s.value,s=a.ec,a=a.readTime;if(!e.path.G(u.path))break;a.F(n)<=0||s instanceof eu&&bu(e,s)&&(r=r.Tt(s.key,s))}return ea.resolve(r)},Uc.prototype.sc=function(t,e){return ea.forEach(this.docs,function(t){return e(t)})},Uc.prototype.Fi=function(t){return new oc(this)},Uc.prototype.ic=function(t){return ea.resolve(this.size)},Uc),oc=(Cc.prototype.oc=function(t){t=this.Uu.get(t);return t?t.readTime:ei.min()},Cc.prototype.Li=function(t,e){this.uc(),this.Uu.set(t.key,{ec:t,readTime:e})},Cc.prototype.Gi=function(t,e){void 0===e&&(e=null),this.uc(),this.Uu.set(t,{ec:null,readTime:e})},Cc.prototype.He=function(t,e){this.uc();var n=this.Uu.get(e);return void 0!==n?ea.resolve(n.ec):this.cc(t,e)},Cc.prototype.getEntries=function(t,e){return this.ac(t,e)},Cc.prototype.apply=function(t){return this.uc(),this.rc=!0,this.lu(t)},Cc.prototype.uc=function(){},n(Vc,ec=Cc),Vc.prototype.lu=function(n){var r=this,i=[];return this.Uu.forEach(function(t,e){e&&e.ec?i.push(r.hc.Li(n,e.ec,r.oc(t))):r.hc.Gi(t)}),ea.qe(i)},Vc.prototype.cc=function(t,e){return this.hc.He(t,e)},Vc.prototype.ac=function(t,e){return this.hc.getEntries(t,e)},Vc),sc=(_c.prototype.Qn=function(t,n){return this.lc.forEach(function(t,e){return n(e)}),ea.resolve()},_c.prototype.Mi=function(t){return ea.resolve(this.lastRemoteSnapshotVersion)},_c.prototype.wc=function(t){return ea.resolve(this._c)},_c.prototype.Lu=function(t){return this.highestTargetId=this.dc.next(),ea.resolve(this.highestTargetId)},_c.prototype.Ki=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this._c&&(this._c=e),ea.resolve()},_c.prototype.Ec=function(t){this.lc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.dc=new Ra(e),this.highestTargetId=e),t.sequenceNumber>this._c&&(this._c=t.sequenceNumber)},_c.prototype.$u=function(t,e){return this.Ec(e),this.targetCount+=1,ea.resolve()},_c.prototype.Qi=function(t,e){return this.Ec(e),ea.resolve()},_c.prototype.mc=function(t,e){return this.lc.delete(e.target),this.fc.No(e.targetId),--this.targetCount,ea.resolve()},_c.prototype.Tc=function(n,r,i){var o=this,s=0,u=[];return this.lc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.lc.delete(t),u.push(o.Ac(n,e.targetId)),s++)}),ea.qe(u).next(function(){return s})},_c.prototype.Ic=function(t){return ea.resolve(this.targetCount)},_c.prototype.Hi=function(t,e){e=this.lc.get(e)||null;return ea.resolve(e)},_c.prototype.qi=function(t,e,n){return this.fc.bo(e,n),ea.resolve()},_c.prototype.Ui=function(e,t,n){this.fc.Do(t,n);var r=this.persistence.Wi,i=[];return r&&t.forEach(function(t){i.push(r.Zu(e,t))}),ea.qe(i)},_c.prototype.Ac=function(t,e){return this.fc.No(e),ea.resolve()},_c.prototype.Yi=function(t,e){e=this.fc.Fo(e);return ea.resolve(e)},_c.prototype.Oo=function(t,e){return ea.resolve(this.fc.Oo(e))},_c),uc=(Pc.prototype.yc=function(t,e){return ea.resolve(this.Rc.get(e))},Pc.prototype.Vc=function(t,e){return this.Rc.set(e.id,{id:e.id,version:e.version,createTime:xo(e.createTime)}),ea.resolve()},Pc.prototype.gc=function(t,e){return ea.resolve(this.Pc.get(e))},Pc.prototype.vc=function(t,e){var n,r;return this.Pc.set(e.name,{name:(n=e).name,query:(r=n.bundledQuery,e=Qo({parent:r.parent,structuredQuery:r.structuredQuery}),"LAST"===r.limitType?yu(e,e.limit,"L"):e),readTime:xo(n.readTime)}),ea.resolve()},Pc),ac=(Sc.prototype.start=function(){return Promise.resolve()},Sc.prototype.Zo=function(){return this.Sc=!1,Promise.resolve()},Object.defineProperty(Sc.prototype,"Nc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),Sc.prototype.xc=function(){},Sc.prototype.Fc=function(){},Sc.prototype.Vi=function(){return this.We},Sc.prototype.Ti=function(t){var e=this.bc[t.h()];return e||(e=new rc(this.We,this.Wi),this.bc[t.h()]=e),e},Sc.prototype.Pi=function(){return this.Ri},Sc.prototype.Ii=function(){return this.Qe},Sc.prototype.gi=function(){return this.pi},Sc.prototype.runTransaction=function(t,e,n){var r=this;Lr("MemoryPersistence","Starting transaction:",t);var i=new hc(this.Cc.next());return this.Wi.Oc(),n(i).next(function(t){return r.Wi.Lc(i).next(function(){return t})}).Me().then(function(t){return i.$c(),t})},Sc.prototype.kc=function(e,n){return ea.Be(Object.values(this.bc).map(function(t){return function(){return t.Oo(e,n)}}))},Sc),hc=(Dc.prototype.Uc=function(t){this.Mc.push(t)},Dc.prototype.$c=function(){this.Mc.forEach(function(t){return t()})},n(Lc,tc=Dc),Lc),cc=(kc.Qc=function(t){return new kc(t)},Object.defineProperty(kc.prototype,"jc",{get:function(){if(this.Bc)return this.Bc;throw _r()},enumerable:!1,configurable:!0}),kc.prototype.vo=function(t,e,n){return this.qc.vo(n,e),this.jc.delete(n.toString()),ea.resolve()},kc.prototype.Co=function(t,e,n){return this.qc.Co(n,e),this.jc.add(n.toString()),ea.resolve()},kc.prototype.Zu=function(t,e){return this.jc.add(e.toString()),ea.resolve()},kc.prototype.removeTarget=function(t,e){var n=this;this.qc.No(e.targetId).forEach(function(t){return n.jc.add(t.toString())});var r=this.persistence.Pi();return r.Yi(t,e.targetId).next(function(t){t.forEach(function(t){return n.jc.add(t.toString())})}).next(function(){return r.mc(t,e)})},kc.prototype.Oc=function(){this.Bc=new Set},kc.prototype.Lc=function(n){var r=this,i=this.persistence.Ii().Fi();return ea.forEach(this.jc,function(t){var e=oi.st(t);return r.Wc(n,e).next(function(t){t||i.Gi(e)})}).next(function(){return r.Bc=null,i.apply(n)})},kc.prototype.ji=function(t,e){var n=this;return this.Wc(t,e).next(function(t){t?n.jc.delete(e.toString()):n.jc.add(e.toString())})},kc.prototype.Dc=function(t){return 0},kc.prototype.Wc=function(t,e){var n=this;return ea.Be([function(){return ea.resolve(n.qc.Oo(e))},function(){return n.persistence.Pi().Oo(t,e)},function(){return n.persistence.kc(t,e)}])},kc),lc=(Rc.prototype.Ar=function(t){this.zc=t},Rc.prototype.dr=function(t){this.Hc=t},Rc.prototype.onMessage=function(t){this.Yc=t},Rc.prototype.close=function(){this.Kc()},Rc.prototype.send=function(t){this.Gc(t)},Rc.prototype.Jc=function(){this.zc()},Rc.prototype.Xc=function(t){this.Hc(t)},Rc.prototype.Zc=function(t){this.Yc(t)},Rc),fc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},pc=(Oc.prototype.Nr=function(e,t,n,r){var i=this.sa(e,t);Lr("RestConnection","Sending: ",i,n);t={};return this.ia(t,r),this.ra(e,i,t,n).then(function(t){return Lr("RestConnection","Received: ",t),t},function(t){throw Sr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Oc.prototype.Fr=function(t,e,n,r){return this.Nr(t,e,n,r)},Oc.prototype.ia=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0",t["Content-Type"]="text/plain",e)for(var n in e.m)e.m.hasOwnProperty(n)&&(t[n]=e.m[n])},Oc.prototype.sa=function(t,e){t=fc[t];return this.na+"/v1/"+e+":"+t},n(Nc,Zh=Oc),Nc.prototype.ra=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Lr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Lr("Connection",'RPC "'+o+'" timed out'),r(new Mr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Lr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(jr).indexOf(e)?e:jr.UNKNOWN,r(new Mr(e,t.message))):r(new Mr(jr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Mr(jr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{Lr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Nc.prototype.Ir=function(t,e){var n,r=[this.na,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new lr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.ia(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Lr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new lc({Gc:function(t){u?Lr("Connection","Not sending because WebChannel is closed:",t):(s||(Lr("Connection","Opening WebChannel transport."),o.open(),s=!0),Lr("Connection","WebChannel sending:",t),o.send(t))},Kc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Lr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Lr("Connection","WebChannel transport closed"),a.Xc())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Sr("Connection","WebChannel transport errored:",t),a.Xc(new Mr(jr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Vr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Lr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ti[r];if(void 0!==t)return Oi(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Xc(new Mr(t,i)),o.close()):(Lr("Connection","WebChannel received:",e),a.Zc(e)))}),setTimeout(function(){a.Jc()},0),a},Nc),dc=(Ac.prototype.Xr=function(t){this.ha.push(t)},Ac.prototype.Zo=function(){window.removeEventListener("online",this.oa),window.removeEventListener("offline",this.ca)},Ac.prototype.la=function(){window.addEventListener("online",this.oa),window.addEventListener("offline",this.ca)},Ac.prototype.ua=function(){Lr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(0)},Ac.prototype.aa=function(){Lr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ha;t<e.length;t++)(0,e[t])(1)},Ac._a=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Ac),vc=(Ic.prototype.Xr=function(t){},Ic.prototype.Zo=function(){},Ic),yc=(Tc.prototype.initialize=function(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.serializer=ua(e.ta.t),this.Ru=this.fa(e),this.persistence=this.da(e),[4,this.persistence.start()];case 1:return t.sent(),this.wa=this.Ea(e),this.jr=this.ma(e),[2]}})})},Tc.prototype.Ea=function(t){return null},Tc.prototype.ma=function(t){return e=this.persistence,n=new nc,r=t.Ta,t=this.serializer,new ka(e,n,r,t);var e,n,r},Tc.prototype.da=function(t){return new ac(cc.Qc,this.serializer)},Tc.prototype.fa=function(t){return new Oh},Tc.prototype.terminate=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wa&&this.wa.stop(),[4,this.Ru.Zo()];case 1:return t.sent(),[4,this.persistence.Zo()];case 2:return t.sent(),[2]}})})},Tc),gc=(Ec.prototype.initialize=function(n,r){return v(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.jr?[3,2]:(this.jr=n.jr,this.Ru=n.Ru,this.Wr=this.Aa(r),this.Au=this.Ia(r),this.Iu=this.Ra(r),this.Pa=this.ya(r,!n.synchronizeTabs),this.Ru.Or=function(t){return Bh(e.Pa,t,1)},this.Au.Gr.Va=$h.bind(null,this.Pa),[4,function(n,r){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hr.delete(2),[4,Za(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hr.add(2),[4,th(e)]);case 3:t.sent(),e.Zr.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Au,this.Pa.Fu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ec.prototype.Ra=function(t){return new gh},Ec.prototype.Aa=function(t){var e=ua(t.ta.t),n=(n=t.ta,new pc(n));return t=t.credentials,new Ha(t,n,e)},Ec.prototype.Ia=function(t){var e=this,n=this.jr,r=this.Wr,i=t.Ns,o=function(t){return Bh(e.Pa,t,0)},t=new(dc._a()?dc:vc);return new qa(n,r,i,o,t)},Ec.prototype.ya=function(t,e){return function(t,e,n,r,i,o,s){o=new Ph(t,e,n,r,i,o);return s&&(o.xu=!0),o}(this.jr,this.Au,this.Iu,this.Ru,t.Ta,t.Pu,e)},Ec.prototype.terminate=function(){return function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=n,Lr("RemoteStore","RemoteStore shutting down."),e.Hr.add(5),[4,th(e)];case 1:return t.sent(),e.Jr.Zo(),e.Zr.set("Unknown"),[2]}})})}(this.Au)},Ec),mc=(bc.prototype.next=function(t){this.observer.next&&this.pa(this.observer.next,t)},bc.prototype.error=function(t){this.observer.error?this.pa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},bc.prototype.ga=function(){this.muted=!0},bc.prototype.pa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},bc),wc=function(t){this.va=t};function bc(t){this.observer=t,this.muted=!1}function Ec(){}function Tc(){this.synchronizeTabs=!1}function Ic(){}function Ac(){var t=this;this.oa=function(){return t.ua()},this.ca=function(){return t.aa()},this.ha=[],this.la()}function Nc(t){var e=this;return(e=Zh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function Oc(t){this.ta=t,this.t=t.t;var e=t.ssl?"https":"http";this.na=e+"://"+t.host,this.ea="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function Rc(t){this.Gc=t.Gc,this.Kc=t.Kc}function kc(t){this.persistence=t,this.qc=new Ih,this.Bc=null}function Lc(t){var e=this;return(e=tc.call(this)||this).Bi=t,e}function Dc(){this.Mc=[]}function Sc(t,e){var n=this;this.bc={},this.Cc=new la(0),this.Sc=!1,this.Sc=!0,this.Wi=t(this),this.Ri=new sc(this),this.We=new Na,this.Qe=(t=this.We,new ic(t,function(t){return n.Wi.Dc(t)})),this.serializer=new Aa(e),this.pi=new uc(this.serializer)}function Pc(t){this.serializer=t,this.Rc=new Map,this.Pc=new Map}function _c(t){this.persistence=t,this.lc=new ta(yi,gi),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this._c=0,this.fc=new Ih,this.targetCount=0,this.dc=Ra._i()}function Vc(t){var e=this;return(e=ec.call(this)||this).hc=t,e}function Cc(){this.Uu=new ta(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.rc=!1}function Uc(t,e){this.We=t,this.nc=e,this.docs=new Ri(oi.k),this.size=0}function jc(t,e){this.We=t,this.Wi=e,this.je=[],this.Gu=1,this.Ku=new Vi(Ah.yo)}function Mc(){}function xc(t,e,n){if(!n)throw new Mr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function qc(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Mr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Fc(t,e,n,r){if(!0===e&&!0===r)throw new Mr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Gc(t){if(!oi.ot(t))throw new Mr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Bc(t){if(oi.ot(t))throw new Mr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Wc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function zc(t,e){if(t instanceof wc&&(t=t.va),t instanceof e)return t;if(e.name===t.constructor.name)throw new Mr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=Wc(t);throw new Mr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Hc(t,e){if(e<=0)throw new Mr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Xc,Yc=function(t){this.ba=t},Kc=(n(Qc,Xc=Yc),Qc.prototype.Ca=function(t){if(2!==t.Sa)throw 1===t.Sa?t.Da(this.ba+"() can only appear at the top level of your update data"):t.Da(this.ba+"() cannot be used with set() unless you pass {merge:true}");return t.ee.push(t.path),null},Qc.prototype.isEqual=function(t){return t instanceof Qc},Qc);function Qc(){return null!==Xc&&Xc.apply(this,arguments)||this}function Jc(t,e,n){return new Wf({Sa:3,Na:e.settings.Na,methodName:t.ba,xa:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var $c,Zc,tl,el,nl=(n(ml,el=Yc),ml.prototype.Ca=function(t){return new bs(t.path,new ss)},ml.prototype.isEqual=function(t){return t instanceof ml},ml),rl=(n(gl,tl=Yc),gl.prototype.Ca=function(t){var e=Jc(this,t,!0),n=this.Fa.map(function(t){return $f(t,e)}),n=new us(n);return new bs(t.path,n)},gl.prototype.isEqual=function(t){return this===t},gl),il=(n(yl,Zc=Yc),yl.prototype.Ca=function(t){var e=Jc(this,t,!0),n=this.Fa.map(function(t){return $f(t,e)}),n=new fs(n);return new bs(t.path,n)},yl.prototype.isEqual=function(t){return this===t},yl),ol=(n(vl,$c=Yc),vl.prototype.Ca=function(t){var e=new ys(t.serializer,Uo(t.serializer,this.Oa));return new bs(t.path,e)},vl.prototype.isEqual=function(t){return this===t},vl),sl=(Object.defineProperty(dl.prototype,"latitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(dl.prototype,"longitude",{get:function(){return this.$a},enumerable:!1,configurable:!0}),dl.prototype.isEqual=function(t){return this.La===t.La&&this.$a===t.$a},dl.prototype.toJSON=function(){return{latitude:this.La,longitude:this.$a}},dl.prototype.D=function(t){return Qr(this.La,t.La)||Qr(this.$a,t.$a)},dl),ul=(pl.fromBase64String=function(t){try{return new pl(wi.fromBase64String(t))}catch(t){throw new Mr(jr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},pl.fromUint8Array=function(t){return new pl(wi.fromUint8Array(t))},pl.prototype.toBase64=function(){return this.ka.toBase64()},pl.prototype.toUint8Array=function(){return this.ka.toUint8Array()},pl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},pl.prototype.isEqual=function(t){return this.ka.isEqual(t.ka)},pl),al=new Map,hl=(fl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},fl),cl=(Object.defineProperty(ll.prototype,"app",{get:function(){if(!this.ja)throw new Mr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(ll.prototype,"Wa",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(ll.prototype,"Ga",{get:function(){return void 0!==this.Ka},enumerable:!1,configurable:!0}),ll.prototype.za=function(t){if(this.qa)throw new Mr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.Ua=new hl(t),void 0!==t.credentials&&(this.Qa=function(t){if(!t)return new xr;switch(t.type){case"gapi":var e=t.client;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Gr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Mr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},ll.prototype.Ha=function(){return this.Ua},ll.prototype.Ya=function(){return this.qa=!0,this.Ua},ll.prototype._delete=function(){return this.Ka||(this.Ka=this.Ja()),this.Ka},ll.prototype.Ja=function(){return t=this,(e=al.get(t))&&(Lr("ComponentProvider","Removing Datastore"),al.delete(t),e.terminate()),Promise.resolve();var t,e},ll);function ll(t,e){this.Ma="(lite)",this.Ua=new hl({}),this.qa=!1,t instanceof Ir?(this.Ba=t,this.Qa=new xr):(this.ja=t,this.Ba=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Mr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(t.options.projectId)}(t),this.Qa=new qr(e))}function fl(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Mr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Mr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Fc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function pl(t){this.ka=t}function dl(t,e){if(!isFinite(t)||t<-90||90<t)throw new Mr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.La=t,this.$a=e}function vl(t,e){var n=this;return(n=$c.call(this,t)||this).Oa=e,n}function yl(t,e){var n=this;return(n=Zc.call(this,t)||this).Fa=e,n}function gl(t,e){var n=this;return(n=tl.call(this,t)||this).Fa=e,n}function ml(){return null!==el&&el.apply(this,arguments)||this}function wl(){if("undefined"==typeof Uint8Array)throw new Mr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function bl(){if("undefined"==typeof atob)throw new Mr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var El,Tl,Il,Al=(n(Pl,Il=ul),Pl.fromBase64String=function(t){bl();try{return new Pl(wi.fromBase64String(t))}catch(t){throw new Mr(jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Pl.fromUint8Array=function(t){return wl(),new Pl(wi.fromUint8Array(t))},Pl.prototype.toBase64=function(){return bl(),Il.prototype.toBase64.call(this)},Pl.prototype.toUint8Array=function(){return wl(),Il.prototype.toUint8Array.call(this)},Pl.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Pl),Ie=(Sl.prototype.Xa=function(t,e){switch(void 0===e&&(e="none"),yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Za(t.timestampValue);case 4:return this.th(t,e);case 5:return t.stringValue;case 6:return this.nh(Ao(t.bytesValue));case 7:return this.eh(t.referenceValue);case 8:return this.sh(t.geoPointValue);case 9:return this.ih(t.arrayValue,e);case 10:return this.rh(t.mapValue,e);default:throw _r()}},Sl.prototype.rh=function(t,n){var r=this,i={};return co(t.fields||{},function(t,e){i[t]=r.Xa(e,n)}),i},Sl.prototype.sh=function(t){return new sl(Io(t.latitude),Io(t.longitude))},Sl.prototype.ih=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Xa(t,e)})},Sl.prototype.th=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return fo(e)?t(e):e}(t);return null==n?null:this.Xa(n,e);case"estimate":return this.Za(po(t));default:return null}},Sl.prototype.Za=function(t){t=To(t);return new ti(t.seconds,t.nanos)},Sl.prototype.oh=function(t,e){var n=ni.J(t);Vr(ns(n));t=new Ir(n.get(1),n.get(3)),n=new oi(n.U(5));return t.isEqual(e)||Dr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},Sl),Nl=(n(Dl,Tl=Ie),Dl.prototype.nh=function(t){return new Al(t)},Dl.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return Gp.uh(t,this.firestore,null)},Dl),Ol=(Object.defineProperty(Ll.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Ll.prototype,"ref",{get:function(){return new ef(this.ah,this.fh,this.lh)},enumerable:!1,configurable:!0}),Ll.prototype.exists=function(){return null!==this._h},Ll.prototype.data=function(){if(this._h){if(this.fh){var t=new Rl(this.ah,this.hh,this.lh,this._h,null);return this.fh.fromFirestore(t)}return this.hh.Xa(this._h.Ee())}},Ll.prototype.get=function(t){if(this._h){t=this._h.data().field(_l("DocumentSnapshot.get",t));if(null!==t)return this.hh.Xa(t)}},Ll),Rl=(n(kl,El=Ol),kl.prototype.data=function(){return El.prototype.data.call(this)},kl);function kl(){return null!==El&&El.apply(this,arguments)||this}function Ll(t,e,n,r,i){this.ah=t,this.hh=e,this.lh=n,this._h=r,this.fh=i}function Dl(t){var e=this;return(e=Tl.call(this)||this).firestore=t,e}function Sl(){}function Pl(){return null!==Il&&Il.apply(this,arguments)||this}function _l(t,e){return"string"==typeof e?ip(t,e):(e instanceof wc?e.va:e).dh}var Vl,Cl=(Ml.prototype.isEqual=function(t){return this.dh.isEqual(t.dh)},Ml),Ul=(n(jl,Vl=cl),jl.prototype.Ja=function(){return this.Eh||Up(this),this.Eh.terminate()},jl);function jl(t,e){var n=this;return(n=Vl.call(this,t,e)||this).wh=new ba,n.Ma="name"in t?t.name:"[DEFAULT]",n}function Ml(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.dh=new ii(t)}var xl,ql,Fl=(n(Hl,ql=Ol),Hl.prototype.exists=function(){return ql.prototype.exists.call(this)},Hl.prototype.data=function(t){if(void 0===t&&(t={}),this._h){if(this.fh){var e=new Gl(this.ah,this.hh,this.lh,this._h,this.metadata,null);return this.fh.fromFirestore(e,t)}return this.hh.Xa(this._h.Ee(),t.serverTimestamps)}},Hl.prototype.get=function(t,e){if(void 0===e&&(e={}),this._h){t=this._h.data().field(_l("DocumentSnapshot.get",t));if(null!==t)return this.hh.Xa(t,e.serverTimestamps)}},Hl),Gl=(n(zl,xl=Fl),zl.prototype.data=function(t){return void 0===t&&(t={}),xl.prototype.data.call(this,t)},zl),Bl=(Object.defineProperty(Wl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"size",{get:function(){return this.Th.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Wl.prototype.forEach=function(e,n){var r=this;this.Th.docs.forEach(function(t){e.call(n,new Gl(r.ah,r.hh,t.key,t,new ed(r.Th.nn.has(t.key),r.Th.fromCache),r.query.fh))})},Wl.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Th.sn)throw new Mr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ah&&this.Ih===t||(this.Ah=function(i,e){if(i.Th.tn.W()){var n=0;return i.Th.docChanges.map(function(t){var e=new Gl(i.ah,i.hh,t.doc.key,t.doc,new ed(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Th.tn;return i.Th.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Gl(i.ah,i.hh,t.doc.key,t.doc,new ed(i.Th.nn.has(t.doc.key),i.Th.fromCache),i.query.fh),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Ih=t),this.Ah},Wl);function Wl(t,e,n,r){this.ah=t,this.hh=e,this.Th=r,this.metadata=new ed(r.hasPendingWrites,r.fromCache),this.query=n}function zl(){return null!==xl&&xl.apply(this,arguments)||this}function Hl(t,e,n,r,i,o){var s=this;return(s=ql.call(this,t,e,n,r,o)||this).ah=t,s.mh=t,s.metadata=i,s}function Xl(t,e){return t instanceof Fl&&e instanceof Fl?t.ah===e.ah&&t.lh.isEqual(e.lh)&&(null===t._h?null===e._h:t._h.isEqual(e._h))&&t.fh===e.fh:t instanceof Bl&&e instanceof Bl&&t.ah===e.ah&&Uf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Th.isEqual(e.Th)}var Yl,Kl=(n(Ql,Yl=Ie),Ql.prototype.nh=function(t){return new ul(t)},Ql.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return new ef(this.firestore,null,t)},Ql);function Ql(t){var e=this;return(e=Yl.call(this)||this).firestore=t,e}function Jl(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=zc(t.firestore,Ul),s=jf(o);return e instanceof wc&&(e=e.va),Zl(o,("string"==typeof e||e instanceof Cl?Qf(s,"updateDoc",t.lh,e,n,r):Kf(s,"updateDoc",t.lh,e)).Ph(t.lh,As.exists(!0)))}function $l(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||aa(n[o])||(i=n[o],o++);var s,u,a,h,c,l={includeMetadataChanges:i.includeMetadataChanges};aa(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof ef?(s=zc(e.firestore,Ul),u=au(e.lh.path),c={next:function(t){n[o]&&n[o](tf(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=zc(e.firestore,Ul),u=e.Rh,h=new Kl(s),c={next:function(t){n[o]&&n[o](new Bl(s,h,e,t))},error:n[o+1],complete:n[o+2]},Of(e.Rh));var f=Cp(s),p=new mc(c),d=new Th(u,p,l);return s.wh.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=wh,[4,wp(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.ga(),s.wh.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=bh,[4,wp(f)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Zl(t,e){return function(n,r){var t=this,i=new na;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Fh,[4,mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Cp(t),e)}function tf(t,e,n){var r=n.docs.get(e.lh),i=new Kl(t);return new Fl(t,i,e.lh,r,new ed(n.hasPendingWrites,n.fromCache),e.fh)}var ef=(Object.defineProperty(of.prototype,"yh",{get:function(){return this.lh.path},enumerable:!1,configurable:!0}),Object.defineProperty(of.prototype,"id",{get:function(){return this.lh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(of.prototype,"path",{get:function(){return this.lh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(of.prototype,"parent",{get:function(){return new kf(this.firestore,this.fh,this.lh.path.q())},enumerable:!1,configurable:!0}),of.prototype.withConverter=function(t){return new of(this.firestore,t,this.lh)},of),nf=(rf.prototype.withConverter=function(t){return new rf(this.firestore,t,this.Rh)},rf),l=function(){};function rf(t,e,n){this.fh=e,this.Rh=n,this.type="query",this.firestore=t}function of(t,e,n){this.fh=e,this.lh=n,this.type="document",this.firestore=t}function sf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Vh(t)}return t}var uf,af,hf,cf,lf,ff=(n(Ef,lf=l),Ef.prototype.Vh=function(t){var e=jf(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Mr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Af(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(If(n,t,h))}c={arrayValue:{values:s}}}else c=If(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Af(o,i),c=Jf(e,"where",o,"in"===i||"not-in"===i);var c=Iu.create(r,i,c);return function(t,e){if(e.Ie()){var n=fu(t);if(null!==n&&!n.isEqual(e.field))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=lu(t);null!==n&&Nf(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Mr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Mr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(t.Rh,e,t.firestore.Ba,this.ph,this.gh,this.bh);return new nf(t.firestore,t.fh,(t=t.Rh,e=t.filters.concat([e]),new iu(t.path,t.collectionGroup,t.me.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Ef),pf=(n(bf,cf=l),bf.prototype.Vh=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ju(e,n);return e=r,null!==lu(n=t)||null!==(t=fu(n))&&Nf(0,t,e.field),r}(t.Rh,this.ph,this.Ch);return new nf(t.firestore,t.fh,(t=t.Rh,e=t.me.concat([e]),new iu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},bf),df=(n(wf,hf=l),wf.prototype.Vh=function(t){return new nf(t.firestore,t.fh,yu(t.Rh,this.Sh,this.Dh))},wf),vf=(n(mf,af=l),mf.prototype.Vh=function(t){var e=Tf(t,this.type,this.Nh,this.xh);return new nf(t.firestore,t.fh,(t=t.Rh,e=e,new iu(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},mf),yf=(n(gf,uf=l),gf.prototype.Vh=function(t){var e=Tf(t,this.type,this.Nh,this.xh);return new nf(t.firestore,t.fh,(t=t.Rh,e=e,new iu(t.path,t.collectionGroup,t.me.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},gf);function gf(t,e,n){var r=this;return(r=uf.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function mf(t,e,n){var r=this;return(r=af.call(this)||this).type=t,r.Nh=e,r.xh=n,r}function wf(t,e,n){var r=this;return(r=hf.call(this)||this).type=t,r.Sh=e,r.Dh=n,r}function bf(t,e){var n=this;return(n=cf.call(this)||this).ph=t,n.Ch=e,n.type="orderBy",n}function Ef(t,e,n){var r=this;return(r=lf.call(this)||this).ph=t,r.gh=e,r.bh=n,r.type="where",r}function Tf(t,h,e,n){if(e[0]instanceof wc&&(e[0]=e[0].va),e[0]instanceof Ol)return function(t,e,n,r){if(!n)throw new Mr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=du(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(No(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Mr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.Y();throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Bu(i,r)}(t.Rh,t.firestore.Ba,e[0]._h,n);var r=jf(t.firestore);return function(t,e,n,r,i,o){var s=t.me;if(i.length>s.length)throw new Mr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.tt()){if("string"!=typeof h)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!pu(t)&&-1!==h.indexOf("/"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ni.J(h));if(!oi.ot(c))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new oi(c);u.push(No(e,c))}else{h=Jf(n,r,h);u.push(h)}}return new Bu(u,o)}(t.Rh,t.firestore.Ba,r,h,e,n)}function If(t,e,n){if(n instanceof wc&&(n=n.va),"string"==typeof n){if(""===n)throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!pu(e)&&-1!==n.indexOf("/"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ni.J(n));if(!oi.ot(e))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return No(t,new oi(e))}if(n instanceof ef)return No(t,n.lh);throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Wc(n)+".")}function Af(t,e){if(!Array.isArray(t)||0===t.length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Nf(t,e,n){if(!n.isEqual(e))throw new Mr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Of(t){if(cu(t)&&0===t.me.length)throw new Mr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rf,kf=(n(Lf,Rf=nf),Object.defineProperty(Lf.prototype,"id",{get:function(){return this.Rh.path.j()},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"path",{get:function(){return this.Rh.path.Y()},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"parent",{get:function(){var t=this.yh.q();return t.W()?null:new ef(this.firestore,null,new oi(t))},enumerable:!1,configurable:!0}),Lf.prototype.withConverter=function(t){return new Lf(this.firestore,t,this.yh)},Lf);function Lf(t,e,n){var r=this;return(r=Rf.call(this,t,e,au(n))||this).firestore=t,r.yh=n,r.type="collection",r}function Df(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(xc("collection","path",e),t instanceof cl){var i=ni.J.apply(ni,s([e],n));return Bc(i),new kf(t,null,i)}if(!(t instanceof ef||t instanceof kf))throw new Mr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=ni.J.apply(ni,s([t.path],n)).child(ni.J(e));return Bc(e),new kf(t.firestore,null,e)}function Sf(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Yr.S()),xc("doc","path",e),t instanceof cl){var i=ni.J.apply(ni,s([e],n));return Gc(i),new ef(t,null,new oi(i))}if(!(t instanceof ef||t instanceof kf))throw new Mr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.yh.child(ni.J.apply(ni,s([e],n)));return Gc(e),new ef(t.firestore,t instanceof kf?t.fh:null,new oi(e))}var Pf,_f=(n(Vf,Pf=Ie),Vf.prototype.nh=function(t){return new ul(t)},Vf.prototype.eh=function(t){t=this.oh(t,this.firestore.Ba);return new ef(this.firestore,null,t)},Vf);function Vf(t){var e=this;return(e=Pf.call(this)||this).firestore=t,e}function Cf(t,e){return(t instanceof ef||t instanceof kf)&&(e instanceof ef||e instanceof kf)&&t.firestore===e.firestore&&t.path===e.path&&t.fh===e.fh}function Uf(t,e){return t instanceof nf&&e instanceof nf&&t.firestore===e.firestore&&gu(t.Rh,e.Rh)&&t.fh===e.fh}function jf(t){var e=t.Ya(),n=ua(t.Ba);return new zf(t.Ba,!!e.ignoreUndefinedProperties,n)}var Mf=/^__.*__$/,xf=(Gf.prototype.Ph=function(t,e){var n=[];return null!==this.ee?n.push(new Vs(t,this.data,this.ee,e)):n.push(new _s(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new xs(t,this.fieldTransforms)),n},Gf),qf=(Ff.prototype.Ph=function(t,e){e=[new Vs(t,this.data,this.ee,e)];return 0<this.fieldTransforms.length&&e.push(new xs(t,this.fieldTransforms)),e},Ff);function Ff(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Gf(t,e,n){this.data=t,this.ee=e,this.fieldTransforms=n}function Bf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var Wf=(Object.defineProperty(Xf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Xf.prototype,"Sa",{get:function(){return this.settings.Sa},enumerable:!1,configurable:!0}),Xf.prototype.Oh=function(t){return new Xf(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.ee)},Xf.prototype.Lh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Oh({path:e,xa:!1});return e.$h(t),e},Xf.prototype.kh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Oh({path:t,xa:!1});return t.Fh(),t},Xf.prototype.Mh=function(t){return this.Oh({path:void 0,xa:!0})},Xf.prototype.Da=function(t){return op(t,this.settings.methodName,this.settings.Uh||!1,this.path,this.settings.Na)},Xf.prototype.contains=function(e){return void 0!==this.ee.find(function(t){return e.G(t)})||void 0!==this.fieldTransforms.find(function(t){return e.G(t.field)})},Xf.prototype.Fh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$h(this.path.get(t))},Xf.prototype.$h=function(t){if(0===t.length)throw this.Da("Document fields must not be empty");if(Bf(this.Sa)&&Mf.test(t))throw this.Da('Document fields cannot begin and end with "__"')},Xf),zf=(Hf.prototype.qh=function(t,e,n,r){return void 0===r&&(r=!1),new Wf({Sa:t,methodName:e,Na:n,path:ii.X(),xa:!1,Uh:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Hf);function Hf(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||ua(t)}function Xf(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Fh(),this.fieldTransforms=i||[],this.ee=o||[]}function Yf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.qh(o.merge||o.mergeFields?2:0,e,n,i);ep("Data must be an object, but it was:",s,r);var u,a,r=Zf(r,s);if(o.merge)u=new Es(s.ee),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=np(e,l[c],n);if(!s.contains(f))throw new Mr(jr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");sp(h,f)||h.push(f)}u=new Es(h),a=s.fieldTransforms.filter(function(t){return u.ue(t.field)})}else u=null,a=s.fieldTransforms;return new xf(new Hs(r),u,a)}function Kf(t,r,i,e){var o=t.qh(1,r,i);ep("Data must be an object, but it was:",o,e);var s=[],u=new Xs;co(e,function(t,e){var n=ip(r,t,i);e instanceof wc&&(e=e.va);t=o.kh(n);e instanceof Kc?s.push(n):null!=(t=$f(e,t))&&(s.push(n),u.set(n,t))});e=new Es(s);return new qf(u.he(),e,o.fieldTransforms)}function Qf(t,e,n,r,i,o){var s=t.qh(1,e,n),u=[np(e,r,n)],a=[i];if(o.length%2!=0)throw new Mr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(np(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new Xs,v=u.length-1;0<=v;--v){sp(p,u[v])||(c=u[v],(l=a[v])instanceof wc&&(l=l.va),f=s.kh(c),l instanceof Kc?p.push(c):null!=(f=$f(l,f))&&(p.push(c),d.set(c,f)))}i=new Es(p);return new qf(d.he(),i,s.fieldTransforms)}function Jf(t,e,n,r){return void 0===r&&(r=!1),$f(n,t.qh(r?4:3,e))}function $f(s,t){if(s instanceof wc&&(s=s.va),tp(s))return ep("Unsupported field value:",t,s),Zf(s,t);if(s instanceof Yc)return function(t,e){if(!Bf(e.Sa))throw e.Da(t.ba+"() can only be used with update() and set()");if(!e.path)throw e.Da(t.ba+"() is not currently supported inside arrays");t=t.Ca(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.ee.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Sa)throw t.Da("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=$f(i[r],t.Mh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof wc&&(t=t.va),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:jo(e.serializer,n)}}if(t instanceof ti){var r=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jo(e.serializer,r)}}if(t instanceof sl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ul)return{bytesValue:Mo(e.serializer,t.ka)};if(t instanceof ef){n=e.t,r=t.firestore.Ba;if(!r.isEqual(n))throw e.Da("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:qo(t.firestore.Ba||e.t,t.lh.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Da("Unsupported field value: "+Wc(t))}(s,t)}function Zf(t,n){var r={};return lo(t)?n.path&&0<n.path.length&&n.ee.push(n.path):co(t,function(t,e){e=$f(e,n.Lh(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function tp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof sl||t instanceof ul||t instanceof ef||t instanceof Yc)}function ep(t,e,n){if(!tp(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=Wc(n);throw"an object"===n?e.Da(t+" a custom object"):e.Da(t+" "+n)}var r}function np(t,e,n){if(e instanceof wc&&(e=e.va),e instanceof Cl)return e.dh;if("string"==typeof e)return ip(t,e);throw op("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var rp=new RegExp("[~\\*/\\[\\]]");function ip(e,n,r){if(0<=n.search(rp))throw op("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Cl.bind.apply(Cl,s([void 0],n.split("."))))).dh}catch(t){throw op("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function op(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Mr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function sp(t,e){return t.some(function(t){return t.isEqual(e)})}var up=(fp.prototype.Gh=function(r){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Kh(),0<this.mutations.length)throw new Mr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return v(this,void 0,void 0,function(){var n,e,r,i,o;return y(this,function(t){switch(t.label){case 0:return e=zo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Go(n.serializer,t)})},[4,n.Fr("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=Bo(t,e.found.name),t=xo(e.found.updateTime),e=new Hs({mapValue:{fields:e.found.fields}});return new eu(n,t,e,{})}(e,t):"missing"in t?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);t=Bo(t,e.missing),e=xo(e.readTime);return new nu(t,e)}(e,t):_r());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Vr(!!t),o.push(t)}),o)]}})})}(this.Wr,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof nu||t instanceof eu?n.zh(t):_r()}),e)]}})})},fp.prototype.set=function(t,e){this.write(e.Ph(t,this.re(t))),this.Wh.add(t.toString())},fp.prototype.update=function(t,e){try{this.write(e.Ph(t,this.Hh(t)))}catch(t){this.jh=t}this.Wh.add(t.toString())},fp.prototype.delete=function(t){this.write([new Ws(t,this.re(t))]),this.Wh.add(t.toString())},fp.prototype.commit=function(){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Kh(),this.jh)throw this.jh;return e=this.Bh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=oi.st(e);n.mutations.push(new zs(e,n.re(e)))}),[4,function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=zo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Yo(e.serializer,t)})},[4,e.Nr("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Wr,this.mutations)];case 1:return t.sent(),this.Qh=!0,[2]}})})},fp.prototype.zh=function(t){var e;if(t instanceof eu)e=t.version;else{if(!(t instanceof nu))throw _r();e=ei.min()}var n=this.Bh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Mr(jr.ABORTED,"Document version changed between two reads.")}else this.Bh.set(t.key.toString(),e)},fp.prototype.re=function(t){var e=this.Bh.get(t.toString());return!this.Wh.has(t.toString())&&e?As.updateTime(e):As.ce()},fp.prototype.Hh=function(t){var e=this.Bh.get(t.toString());if(this.Wh.has(t.toString())||!e)return As.exists(!0);if(e.isEqual(ei.min()))throw new Mr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return As.updateTime(e)},fp.prototype.write=function(t){this.Kh(),this.mutations=this.mutations.concat(t)},fp.prototype.Kh=function(){},fp),ap=(lp.prototype.run=function(){this.Jh()},lp.prototype.Jh=function(){var t=this;this.Ks.vs(function(){return v(t,void 0,void 0,function(){var e,n,r=this;return y(this,function(t){return e=new up(this.Wr),(n=this.Xh(e))&&n.then(function(t){r.Ns.Ms(function(){return e.commit().then(function(){r.Os.resolve(t)}).catch(function(t){r.Zh(t)})})}).catch(function(t){r.Zh(t)}),[2]})})})},lp.prototype.Xh=function(t){try{var e=this.updateFunction(t);return!fi(e)&&e.catch&&e.then?e:(this.Os.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Os.reject(t),null}},lp.prototype.Zh=function(t){var e=this;0<this.Yh&&this.tl(t)?(--this.Yh,this.Ns.Ms(function(){return e.Jh(),Promise.resolve()})):this.Os.reject(t)},lp.prototype.tl=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ni(t)},lp),hp=(cp.prototype.getConfiguration=function(){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.V.promise];case 1:return[2,(t.sent(),{Ns:this.Ns,ta:this.ta,clientId:this.clientId,credentials:this.credentials,Ta:this.user,Pu:100})]}})})},cp.prototype.el=function(t){var e=this;this.nl=t,this.V.promise.then(function(){return e.nl(e.user)})},cp.prototype.sl=function(){if(this.Ns.Hs)throw new Mr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},cp.prototype.terminate=function(){var t=this;this.Ns.Zs();var n=new na;return this.Ns.Ys(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.il?[4,this.il.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.rl?[4,this.rl.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ia(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},cp);function cp(t,e,n){var r=this;this.credentials=t,this.Ns=e,this.ta=n,this.user=Ar.UNAUTHENTICATED,this.clientId=Yr.S(),this.nl=function(){},this.V=new na,this.credentials.I(function(t){Lr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.nl(t)),r.V.resolve()})}function lp(t,e,n,r){this.Ns=t,this.Wr=e,this.updateFunction=n,this.Os=r,this.Yh=5,this.Ks=new va(this.Ns,"transaction_retry")}function fp(t){this.Wr=t,this.Bh=new Map,this.mutations=[],this.Qh=!1,this.jh=null,this.Wh=new Set}function pp(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.rl?[3,2]:(Lr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return r.Ns.si(),Lr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.el(function(e){return r.Ns.ti(function(){return v(n,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,_a(i.jr,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.xc(function(){return r.terminate()}),r.rl=i,[2]}})})}(e,new yc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.rl]}})})}function dp(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e.il?[3,2]:(Lr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return r.Ns.si(),[4,pp(r)];case 1:return e=t.sent(),Lr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.el(function(t){return r.Ns.ti(function(){return function(r,i){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return(e=r).Ns.si(),Lr("RemoteStore","RemoteStore received new credentials"),n=uh(e),e.Hr.add(3),[4,th(e)];case 1:return t.sent(),n&&e.Zr.set("Unknown"),[4,e.Gr.Va(i)];case 2:return t.sent(),e.Hr.delete(3),[4,Za(e)];case 3:return t.sent(),[2]}})})}(i.Au,t)})}),r.il=i,[2]}})})}(e,new gc)]);case 1:t.sent(),t.label=2;case 2:return[2,e.il]}})})}function vp(t){return pp(t).then(function(t){return t.persistence})}function yp(t){return pp(t).then(function(t){return t.jr})}function gp(t){return dp(t).then(function(t){return t.Au})}function mp(t){return dp(t).then(function(t){return t.Pa})}function wp(r){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,dp(r)];case 1:return e=t.sent(),[2,((n=e.Iu).ho=qh.bind(null,e.Pa),n.fo=function(i,o){return v(this,void 0,void 0,function(){var e,n,r;return y(this,function(t){switch(t.label){case 0:return n=(e=i).Vu.get(o),1<(r=e.pu.get(n.targetId)).length?[2,(e.pu.set(n.targetId,r.filter(function(t){return!gu(t,o)})),void e.Vu.delete(o))]:e.Fu?(e.Ru.Go(n.targetId),e.Ru.Yo(n.targetId)?[3,2]:[4,ja(e.jr,n.targetId,!1).then(function(){e.Ru.zo(n.targetId),nh(e.Au,n.targetId),Xh(e,n.targetId)}).catch(xa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Xh(e,n.targetId),[4,ja(e.jr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.Pa),n)]}})})}function bp(n,r,i,o,s){var t=new mc({next:function(t){r.Ms(function(){return bh(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Mr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Mr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Th(au(i.path),t,{includeMetadataChanges:!0,Ro:!0});return wh(n,u)}function Ep(e,n,t,r,i){var o=new mc({next:function(t){n.Ms(function(){return bh(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Mr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Th(t,o,{includeMetadataChanges:!0,Ro:!0});return wh(e,s)}var Tp=(Ip.prototype.set=function(t,e,n){this.hl();t=Ap(t,this.ah),e=yd(t.fh,e,n),n=Yf(this.al,"WriteBatch.set",t.lh,e,null!==t.fh,n);return this.ul=this.ul.concat(n.Ph(t.lh,As.ce())),this},Ip.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.hl();t=Ap(t,this.ah);return e instanceof wc&&(e=e.va),e="string"==typeof e||e instanceof Cl?Qf(this.al,"WriteBatch.update",t.lh,e,n,r):Kf(this.al,"WriteBatch.update",t.lh,e),this.ul=this.ul.concat(e.Ph(t.lh,As.exists(!0))),this},Ip.prototype.delete=function(t){this.hl();t=Ap(t,this.ah);return this.ul=this.ul.concat(new Ws(t.lh,As.ce())),this},Ip.prototype.commit=function(){return this.hl(),this.cl=!0,0<this.ul.length?this.ol(this.ul):Promise.resolve()},Ip.prototype.hl=function(){if(this.cl)throw new Mr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ip);function Ip(t,e){this.ah=t,this.ol=e,this.ul=[],this.cl=!1,this.al=jf(t)}function Ap(t,e){if(t instanceof wc&&(t=t.va),t.firestore!==e)throw new Mr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Np,Op,Rp=(Vp.prototype.get=function(t){var e=this,n=Ap(t,this.ah),r=new _f(this.ah);return this.ll.Gh([n.lh]).then(function(t){if(!t||1!==t.length)return _r();t=t[0];if(t instanceof nu)return new Ol(e.ah,r,n.lh,null,n.fh);if(t instanceof eu)return new Ol(e.ah,r,t.key,t,n.fh);throw _r()})},Vp.prototype.set=function(t,e,n){t=Ap(t,this.ah),e=yd(t.fh,e,n),n=Yf(this.al,"Transaction.set",t.lh,e,null!==t.fh,n);return this.ll.set(t.lh,n),this},Vp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ap(t,this.ah);return e instanceof wc&&(e=e.va),e="string"==typeof e||e instanceof Cl?Qf(this.al,"Transaction.update",t.lh,e,n,r):Kf(this.al,"Transaction.update",t.lh,e),this.ll.update(t.lh,e),this},Vp.prototype.delete=function(t){t=Ap(t,this.ah);return this.ll.delete(t.lh),this},n(_p,Op=Vp),_p.prototype.get=function(t){var e=this,n=Ap(t,this.ah),r=new Kl(this.ah);return Op.prototype.get.call(this,t).then(function(t){return new Fl(e.ah,r,n.lh,t._h,new ed(!1,!1),n.fh)})},_p),kp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Lp=(Pp.prototype.enableIndexedDbPersistence=function(t,e){throw new Mr(jr.FAILED_PRECONDITION,kp)},Pp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new Mr(jr.FAILED_PRECONDITION,kp)},Pp.prototype.clearIndexedDbPersistence=function(t){throw new Mr(jr.FAILED_PRECONDITION,kp)},Pp),Dp=(n(Sp,Np=wc),Object.defineProperty(Sp.prototype,"Ba",{get:function(){return this.va.Ba},enumerable:!1,configurable:!0}),Sp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.va.Ha()),t)).merge,this.va.za(t)},Sp.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.va.Ha().host&&Sr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Sp.prototype.enableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,vp(r)];case 1:return e=t.sent(),[4,gp(r)];case 2:return n=t.sent(),[2,(e.Fc(!0),(t=n).Hr.delete(0),Za(t))]}})})})}(Cp(this.va))},Sp.prototype.disableNetwork=function(){return function(r){var t=this;return r.Ns.enqueue(function(){return v(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,vp(r)];case 1:return e=t.sent(),[4,gp(r)];case 2:return n=t.sent(),[2,(e.Fc(!1),function(n){return v(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return(e=n).Hr.add(0),[4,th(e)];case 1:return t.sent(),e.Zr.set("Offline"),[2]}})})}(n))]}})})})}(Cp(this.va))},Sp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Fc("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this._l.enableMultiTabIndexedDbPersistence(this):this._l.enableIndexedDbPersistence(this,n)},Sp.prototype.clearPersistence=function(){return this._l.clearIndexedDbPersistence(this)},Sp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.va._delete()},Sp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new na;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=Wh,[4,mp(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Cp(this.va))},Sp.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=Cp(t),e=aa(e)?e:{next:e},i=new mc(e);return t.wh.Ms(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.add(e),e.next()},[4,wp(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.ga(),t.wh.Ms(function(){return v(n,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return e=function(t,e){t.ao.delete(e)},[4,wp(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.va,t)},Object.defineProperty(Sp.prototype,"app",{get:function(){if(!this.fl)throw new Mr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.fl},enumerable:!1,configurable:!0}),Sp.prototype.collection=function(t){try{return new ud(this,Df(this.va,t))}catch(t){throw Hp(t,"collection()","Firestore.collection()")}},Sp.prototype.doc=function(t){try{return new Gp(this,Sf(this.va,t))}catch(t){throw Hp(t,"doc()","Firestore.doc()")}},Sp.prototype.collectionGroup=function(t){try{return new id(this,function(t,e){if(xc("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Mr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new nf(t,null,(e=e,new iu(ni.X(),e)))}(this.va,t))}catch(t){throw Hp(t,"collectionGroup()","Firestore.collectionGroup()")}},Sp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new na;return n.Ns.Ms(function(){return v(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,dp(n).then(function(t){return t.Wr})];case 1:return e=t.sent(),new ap(n.Ns,e,r,i).run(),[2]}})})}),i.promise}(Cp(n=this.va),function(t){return t=new Rp(n,t),e(new qp(r,t))})},Sp.prototype.batch=function(){var e=this;return Cp(this.va),new Fp(new Tp(this.va,function(t){return Zl(e.va,t)}))},Sp);function Sp(t,e,n){var r=this;return(r=Np.call(this,e)||this)._l=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ir||(r.fl=t),r}function Pp(){}function _p(t,e){var n=this;return(n=Op.call(this,t,e)||this).ah=t,n}function Vp(t,e){this.ah=t,this.ll=e,this.al=jf(t)}function Cp(t){return t.Eh||Up(t),t.Eh.sl(),t.Eh}function Up(t){var e,n,r=t.Ya(),r=(e=t.Ba,n=t.Ma,new Tr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.Eh=new hp(t.Qa,t.wh,r)}var jp,Mp,xp,qp=(n(zp,xp=wc),zp.prototype.get=function(t){var e=this,t=vd(t);return this.va.get(t).then(function(t){return new nd(e.ah,t)})},zp.prototype.set=function(t,e,n){t=vd(t);return n?(qc("Transaction.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},zp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=vd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},zp.prototype.delete=function(t){t=vd(t);return this.va.delete(t),this},zp),Fp=(n(Wp,Mp=wc),Wp.prototype.set=function(t,e,n){t=vd(t);return n?(qc("WriteBatch.set",n),this.va.set(t,e,n)):this.va.set(t,e),this},Wp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=vd(t);return 2===arguments.length?this.va.update(o,e):(t=this.va).update.apply(t,s([o,e,n],r)),this},Wp.prototype.delete=function(t){t=vd(t);return this.va.delete(t),this},Wp.prototype.commit=function(){return this.va.commit()},Wp),Gp=(n(Bp,jp=wc),Bp.dl=function(t,e,n){if(t.length%2!=0)throw new Mr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.Y()+" has "+t.length);return new Bp(e,new ef(e.va,n,new oi(t)))},Bp.uh=function(t,e,n){return new Bp(e,new ef(e.va,n,t))},Object.defineProperty(Bp.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"parent",{get:function(){return new ud(this.firestore,this.va.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Bp.prototype.collection=function(t){try{return new ud(this.firestore,Df(this.va,t))}catch(t){throw Hp(t,"collection()","DocumentReference.collection()")}},Bp.prototype.isEqual=function(t){return t instanceof wc&&(t=t.va),t instanceof ef&&Cf(this.va,t)},Bp.prototype.set=function(t,e){e=qc("DocumentReference.set",e);try{return n=this.va,r=t,i=e,o=zc(n.firestore,Ul),r=yd(n.fh,r,i),Zl(o,Yf(jf(o),"setDoc",n.lh,r,null!==n.fh,i).Ph(n.lh,As.ce()))}catch(t){throw Hp(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Bp.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Jl(this.va,t):Jl.apply(void 0,s([this.va,t,e],n))}catch(t){throw Hp(t,"updateDoc()","DocumentReference.update()")}},Bp.prototype.delete=function(){return Zl(zc((t=this.va).firestore,Ul),[new Ws(t.lh,As.ce())]);var t},Bp.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Xp(t),i=Yp(t,function(t){return new nd(e.firestore,new Fl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))});return $l(this.va,r,i)},Bp.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=zc(e.firestore,Ul),r=Cp(n),i=new Kl(n),o=new na;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,yp(r)];case 1:return[4,function(i,o,s){return v(this,void 0,void 0,function(){var r;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.yi.Ge(t,e)}))];case 1:return(r=t.sent())instanceof eu?s.resolve(r):r instanceof nu?s.resolve(null):s.reject(new Mr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ia(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.lh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Fl(n,i,e.lh,t,new ed(t instanceof eu&&t.ae,!0),e.fh)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=zc(e.firestore,Ul),r=Cp(n),i=new na;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return[4,bp(t.sent(),n.wh,e.lh,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return tf(n,e,t)})}:function(e){var t=this,n=zc(e.firestore,Ul),r=Cp(n),i=new na;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return[4,bp(t.sent(),n.wh,e.lh,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return tf(n,e,t)})})(this.va).then(function(t){return new nd(e.firestore,new Fl(e.firestore.va,e.hh,t.lh,t._h,t.metadata,e.va.fh))})},Bp.prototype.withConverter=function(t){return new Bp(this.firestore,this.va.withConverter(t))},Bp);function Bp(t,e){var n=this;return(n=jp.call(this,e)||this).firestore=t,n.hh=new Nl(t),n}function Wp(){return null!==Mp&&Mp.apply(this,arguments)||this}function zp(t,e){var n=this;return(n=xp.call(this,e)||this).ah=t,n}function Hp(t,e,n){return t.message=t.message.replace(e,n),t}function Xp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!aa(r))return r}return{}}function Yp(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=aa(t[0])?t[0]:aa(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Kp,Qp,Jp,$p,Zp,td,ed=(dd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},dd),nd=(n(pd,td=wc),Object.defineProperty(pd.prototype,"ref",{get:function(){return new Gp(this.ah,this.va.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"exists",{get:function(){return this.va.exists()},enumerable:!1,configurable:!0}),pd.prototype.data=function(t){return this.va.data(t)},pd.prototype.get=function(t,e){return this.va.get(t,e)},pd.prototype.isEqual=function(t){return Xl(this.va,t.va)},pd),rd=(n(fd,Zp=nd),fd.prototype.data=function(t){return this.va.data(t)},fd),id=(n(ld,$p=wc),ld.prototype.where=function(t,e,n){try{return new ld(this.firestore,sf(this.va,(r=n,i=e,o=_l("where",t),new ff(o,i,r))))}catch(t){throw Hp(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},ld.prototype.orderBy=function(n,t){try{return new ld(this.firestore,sf(this.va,function(t){void 0===t&&(t="asc");var e=t,t=_l("orderBy",n);return new pf(t,e)}(t)))}catch(n){throw Hp(n,/(orderBy|where)\(\)/,"Query.$1()")}},ld.prototype.limit=function(t){try{return new ld(this.firestore,sf(this.va,(Hc("limit",e=t),new df("limit",e,"F"))))}catch(t){throw Hp(t,"limit()","Query.limit()")}var e},ld.prototype.limitToLast=function(t){try{return new ld(this.firestore,sf(this.va,(Hc("limitToLast",e=t),new df("limitToLast",e,"L"))))}catch(t){throw Hp(t,"limitToLast()","Query.limitToLast()")}var e},ld.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ld(this.firestore,sf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vf("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Hp(t,"startAt()","Query.startAt()")}},ld.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ld(this.firestore,sf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vf("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Hp(t,"startAfter()","Query.startAfter()")}},ld.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ld(this.firestore,sf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Hp(t,"endBefore()","Query.endBefore()")}},ld.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new ld(this.firestore,sf(this.va,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Hp(t,"endAt()","Query.endAt()")}},ld.prototype.isEqual=function(t){return Uf(this.va,t.va)},ld.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=zc(e.firestore,Ul),r=Cp(n),i=new Kl(n),o=new na;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,yp(r)];case 1:return[4,function(r,i,o){return v(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ma(r,i,!0)];case 1:return n=t.sent(),e=new Lh(i,n.Ji),n=e.uu(n.documents),n=e.lu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ia(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.Rh,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Bl(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=zc(e.firestore,Ul),r=Cp(n),i=new Kl(n),o=new na;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return[4,Ep(t.sent(),n.wh,e.Rh,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Bl(n,i,e,t)})}:function(e){var t=this,n=zc(e.firestore,Ul),r=Cp(n),i=new Kl(n);Of(e.Rh);var o=new na;return n.wh.Ms(function(){return v(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,wp(r)];case 1:return[4,Ep(t.sent(),n.wh,e.Rh,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Bl(n,i,e,t)})})(this.va).then(function(t){return new sd(e.firestore,t)})},ld.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Xp(t),i=Yp(t,function(t){return new sd(e.firestore,t)});return $l(this.va,r,i)},ld.prototype.withConverter=function(t){return new ld(this.firestore,this.va.withConverter(t))},ld),od=(n(cd,Jp=wc),Object.defineProperty(cd.prototype,"type",{get:function(){return this.va.type},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"doc",{get:function(){return new rd(this.ah,this.va.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"oldIndex",{get:function(){return this.va.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(cd.prototype,"newIndex",{get:function(){return this.va.newIndex},enumerable:!1,configurable:!0}),cd),sd=(n(hd,Qp=wc),Object.defineProperty(hd.prototype,"query",{get:function(){return new id(this.ah,this.va.query)},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"metadata",{get:function(){return this.va.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"size",{get:function(){return this.va.size},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"empty",{get:function(){return this.va.empty},enumerable:!1,configurable:!0}),Object.defineProperty(hd.prototype,"docs",{get:function(){var e=this;return this.va.docs.map(function(t){return new rd(e.ah,t)})},enumerable:!1,configurable:!0}),hd.prototype.docChanges=function(t){var e=this;return this.va.docChanges(t).map(function(t){return new od(e.ah,t)})},hd.prototype.forEach=function(e,n){var r=this;this.va.forEach(function(t){e.call(n,new rd(r.ah,t))})},hd.prototype.isEqual=function(t){return Xl(this.va,t.va)},hd),ud=(n(ad,Kp=id),Object.defineProperty(ad.prototype,"id",{get:function(){return this.va.id},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"path",{get:function(){return this.va.path},enumerable:!1,configurable:!0}),Object.defineProperty(ad.prototype,"parent",{get:function(){var t=this.va.parent;return t?new Gp(this.firestore,t):null},enumerable:!1,configurable:!0}),ad.prototype.doc=function(t){try{return new Gp(this.firestore,void 0===t?Sf(this.va):Sf(this.va,t))}catch(t){throw Hp(t,"doc()","CollectionReference.doc()")}},ad.prototype.add=function(t){var e,n,r,i=this;return e=this.va,n=t,t=zc(e.firestore,Ul),r=Sf(e),n=yd(e.fh,n),Zl(t,Yf(jf(e.firestore),"addDoc",r.lh,n,null!==e.fh,{}).Ph(r.lh,As.exists(!1))).then(function(){return r}).then(function(t){return new Gp(i.firestore,t)})},ad.prototype.isEqual=function(t){return Cf(this.va,t.va)},ad.prototype.withConverter=function(t){return new ad(this.firestore,this.va.withConverter(t))},ad);function ad(t,e){var n=this;return(n=Kp.call(this,t,e)||this).firestore=t,n.va=e,n}function hd(t,e){var n=this;return(n=Qp.call(this,e)||this).ah=t,n}function cd(t,e){var n=this;return(n=Jp.call(this,e)||this).ah=t,n}function ld(t,e){var n=this;return(n=$p.call(this,e)||this).firestore=t,n}function fd(){return null!==Zp&&Zp.apply(this,arguments)||this}function pd(t,e){var n=this;return(n=td.call(this,e)||this).ah=t,n}function dd(t,e){this.hasPendingWrites=t,this.fromCache=e}function vd(t){return t instanceof wc&&(t=t.va),zc(t,ef)}function yd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var gd,md,wd,l=(n(Td,md=wc),Td.documentId=function(){return new Td(ii.nt().Y())},Td.prototype.isEqual=function(t){return t instanceof wc&&(t=t.va),t instanceof Cl&&this.va.dh.isEqual(t.dh)},Td),Ie=(n(Ed,gd=wc),Ed.serverTimestamp=function(){var t=new nl("serverTimestamp");return t.ba="FieldValue.serverTimestamp",new Ed(t)},Ed.delete=function(){var t=new Kc("deleteField");return t.ba="FieldValue.delete",new Ed(t)},Ed.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new rl("arrayUnion",t)}.apply(void 0,t);return n.ba="FieldValue.arrayUnion",new Ed(n)},Ed.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new il("arrayRemove",t)}.apply(void 0,t);return n.ba="FieldValue.arrayRemove",new Ed(n)},Ed.increment=function(t){t=new ol("increment",t);return t.ba="FieldValue.increment",new Ed(t)},Ed.prototype.isEqual=function(t){return this.va.isEqual(t.va)},Ed),bd={Firestore:Dp,GeoPoint:sl,Timestamp:ti,Blob:Al,Transaction:qp,WriteBatch:Fp,DocumentReference:Gp,DocumentSnapshot:nd,Query:id,QueryDocumentSnapshot:rd,QuerySnapshot:sd,CollectionReference:ud,FieldPath:l,FieldValue:Ie,setLogLevel:function(t){Rr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function Ed(){return null!==gd&&gd.apply(this,arguments)||this}function Td(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return md.call(this,new(Cl.bind.apply(Cl,s([void 0],t))))||this}(wd=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Dp(e,new Ul(e,t),new Lp);var e},"PUBLIC").setServiceProps(Object.assign({},bd))),wd.registerVersion("@firebase/firestore","2.0.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
