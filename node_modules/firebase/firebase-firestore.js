!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(ng){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(ng),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var o={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=i,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=A||self;function D(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),C=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++C))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=S.navigator;if(J){J=J.userAgent;if(J){H=J;break t}}H=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it=Y(H,"Opera"),ot=Y(H,"Trident")||Y(H,"MSIE"),st=Y(H,"Edge"),ut=st||ot,at=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ct=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=H,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:_t[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var _t={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Et=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),xt={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[It]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[It]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Nt(t)))}function Ct(t){return t in xt?xt[t]:xt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Rt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(vt)return Lt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new bt(e,this))}function Mt(t){return(t=t[Dt])instanceof At?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==x(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function qt(){F.call(this),this.c=new At(this),(this.J=this).C=null}function Ft(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,et(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Bt(o,r,!0,e)&&s;if(s=Bt(o=e.a=t,r,!0,e)&&s,s=Bt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Bt(o=e.a=n[i],r,!1,e)&&s}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[It]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Rt(r))}(this,t,e,n,r)},N.G=function(){if(qt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=S.JSON.stringify;function Gt(){this.b=this.a=null}var Kt,Wt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Qt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Kt||(n=S.Promise.resolve(void 0),Kt=function(){n.then($t)}),Xt||(Kt(),Xt=!0),Jt.add(t,e)}Gt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Gt;function $t(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Wt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){qt.call(this),this.b=t||1,this.a=e||S,this.f=M(this.Xa,this),this.g=j()}function te(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ee(t,e,n){if("function"==x(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}q(Zt,qt),(N=Zt.prototype).aa=!1,N.M=null,N.Xa=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ft(this,"tick"),this.aa&&(te(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},N.G=function(){Zt.X.G.call(this),te(this),delete this.a};var ne,re,ie,oe=(E(re=ue,ie=ne=F),re.prototype=null===ie?Object.create(ie):(se.prototype=ie.prototype,new se),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ee(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){ne.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function se(){this.constructor=re}function ue(t,e,n){var r=ne.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ae(t){F.call(this),this.b=t,this.a={}}q(ae,F);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Rt(t)},t),t.a={}}function le(){this.a=!0}function pe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ae.prototype.G=function(){ae.X.G.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var de=null;function ye(){return de=de||new qt}function ve(t){wt.call(this,"serverreachability",t)}function ge(t){var e=ye();Ft(e,new ve(e))}function me(t){wt.call(this,"statevent",t)}function we(t){var e=ye();Ft(e,new me(e))}function be(t){wt.call(this,"timingevent",t)}function _e(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}q(ve,wt),q(me,wt),q(be,wt);var Ie={NO_ERROR:0,Ya:1,fb:2,eb:3,ab:4,cb:5,gb:6,Da:7,TIMEOUT:8,jb:9},Ee={$a:"complete",nb:"success",Ea:"error",Da:"abort",lb:"ready",mb:"readystatechange",TIMEOUT:"timeout",hb:"incrementaldata",kb:"progress",bb:"downloadprogress",ob:"uploadprogress"};function Te(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Te.prototype.a=null;var Oe,A={OPEN:"a",Za:"b",Ea:"c",ib:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function xe(){}function ke(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ae(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}q(Se,wt),q(De,wt),q(xe,Te),Oe=new xe;var Pe=45e3,Re={},Ce={};function Le(t,e,n){t.H=1,t.i=nn(Xe(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=j(),Ue(t),t.l=Xe(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=cr(t.g,t.g.C?e:null),0<t.O&&(t.F=new oe(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Va),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ge(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Me(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,we(14),s=!1),pe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,we(15),pe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}pe(t.c,t.f,u,null),ze(t,u)}4==e&&0==n.length&&(t.h=1,we(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),er(e),e.F=!0,we(11))):(pe(t.c,t.f,n,"[Invalid Chunked Response]"),Be(t),Fe(t))}function Ue(t){t.T=j()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(M(t.Ta,t),e)}function qe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||ir(t.g,t)}function Be(t){qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,te(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function ze(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;rr(u),Wn(u)}tr(u),we(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=_e(M(u.Qa,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else sr(u,11)}else if(!t.C&&u.a!=t||rr(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,en(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ar(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(qe(o),Ue(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||sr(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sr(u,7):Kn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ge(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=ke.prototype).setTimeout=function(t){this.P=t},N.Va=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ge(8==n||r<=0?3:2),qe(this);var i=this.a.W();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.S,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.U&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,we(12),Be(this),Fe(this);break t}pe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,ze(this,s)}this.I?(Me(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Ua),this.R.start())):(pe(this.c,this.f,n,null),ze(this,n)),4==e&&Be(this),this.b&&!this.A&&(4==e?ir(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,we(12)):(this.h=0,we(13)),Be(this),Fe(this)}}}catch(t){}var u,a,c,h,f,l},N.Ua=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(qe(this),Me(this,t,e),this.b&&4!=t&&Ue(this)))},N.cancel=function(){this.A=!0,Be(this)},N.Ta=function(){this.o=null;var t,e,n=j();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ge(3),we(17)),Be(this),this.h=2,Fe(this)):je(this,this.T-n)},(N=Ke.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return We(this),this.a.concat()},N.get=function(t,e){return He(this.b,t)?this.b[t]:e},N.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,$e(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),tn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=rn(n[2]||""),$e(this,n[3]||"",!0),Ze(this,n[4]),this.g=rn(n[5]||"",!0),tn(this,n[6]||"",!0),this.i=rn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ye(t)}function Je(t,e,n){t.f=n?rn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?rn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function tn(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(pn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(dn(this,e),vn(this,n,t))},r)),r.f=i):(n||(e=on(e,hn)),t.b=new ln(e,t.a))}function en(t,e,n){t.b.set(e,n)}function nn(t){return en(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function rn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function on(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(on(e,un,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(on(e,un,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(on(n,"/"==n.charAt(0)?cn:an,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",on(n,fn)),t.join("")};var un=/[#\/\?@]/g,an=/[#\?:]/g,cn=/[#\?]/g,hn=/[#\?@]/g,fn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function pn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function dn(t,e){pn(t),e=gn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function yn(t,e){return pn(t),e=gn(t,e),He(t.a.b,e)}function vn(t,e,n){dn(t,e),0<n.length&&(t.c=null,t.a.set(gn(t,e),K(n)),t.b+=n.length)}function gn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function mn(t,e){this.b=t,this.a=e}function wn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().pb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){pn(this),this.c=null,t=gn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){pn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){pn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){pn(this);var e=[];if("string"==typeof t)yn(this,t)&&(e=G(e,this.a.get(gn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return pn(this),this.c=null,yn(this,t=gn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var bn=10;function _n(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function On(){}function Sn(){this.a=new On}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}wn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},On.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},On.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function kn(t){qt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}q(kn,qt);var Pn="",Rn=/^https?$/i,Cn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.u||(t.u=!0,Ft(t,"complete"),Ft(t,"error"))}function Un(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.W()))if(t.l&&4==Fn(t))ee(t.za,0,t);else if(Ft(t,"readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n),e)Ft(t,"complete"),Ft(t,"success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.W()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||Ft(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):en(t,e,n))}function zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Ma=this.R=0,this.Ja=zn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Fa=zn("baseRetryDelayMs",5e3,t),this.Pa=zn("retryDelaySeedMs",1e4,t),this.Ka=zn("forwardChannelMaxRetries",2,t),this.ma=zn("forwardChannelRequestTimeoutMs",2e4,t),this.La=t&&t.h||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new wn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.g&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ia=t&&t.f||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Kn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,en(n=Xe(t.B),"SID",t.J),en(n,"RID",e),en(n,"TYPE","terminate"),Jn(t,n),(e=new ke(t,t.c,e,void 0)).H=2,e.i=nn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=cr(e.g,null),e.a.ba(e.i)),e.u=j(),Ue(e)),ur(t)}function Wn(t){t.a&&(er(t),t.a.cancel(),t.a=null)}function Hn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),rr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new mn(t.Ma++,e)),3==t.v&&Yn(t)}function Yn(t){_n(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);en(r,"SID",t.J),en(r,"RID",n),en(r,"AID",t.P),Jn(t,r),t.i&&t.l&&Bn(r,t.i,t.l),n=new ke(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Le(n,r,e)}function Jn(t,n){t.f&&Ge({},function(t,e){en(n,e,t)})}function $n(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;P(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.T=1,Yt(t.Aa,t),t.o=0)}function tr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=_e(M(t.Aa,t),or(t,t.o)),t.o++,1)}function er(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function nr(t){t.a=new ke(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);en(e,"RID","rpc"),en(e,"SID",t.J),en(e,"CI",t.H?"0":"1"),en(e,"AID",t.P),Jn(t,e),en(e,"TYPE","xmlhttp"),t.i&&t.l&&Bn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=nn(Xe(e)),n.j=null,n.I=!0,Ve(n,t)}function rr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function ir(t,e){var n,r=null;if(t.a==e){rr(t),er(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Nn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,Ft(i=ye(),new be(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ja?0:t.Ka)))return t.h=_e(M(t.Ba,t,e),or(t,t.u)),t.u++,1}}(t,e)||2==i&&tr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:sr(t,5);break;case 4:sr(t,10);break;case 3:sr(t,6);break;default:sr(t,2)}}function or(t,e){var n=t.Fa+Math.floor(Math.random()*t.Pa);return t.f||(n*=2),n*e}function sr(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Wa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Je(r,"https"),nn(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):we(2),t.v=0,t.f&&t.f.ra(e),ur(t),Hn(t)}function ur(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function ar(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Xe(s):new Ye(s,void 0);return""!=a.c?(e&&$e(a,e+"."+a.c),Ze(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Je(u,r),i&&$e(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&$(t.V,function(t,e){en(a,e,t)}),e=t.A,n=t.na,e&&n&&en(a,e,n),en(a,"VER",t.ha),Jn(t,a),a}function cr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.La)).F=t.C,e}function hr(){}function fr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){qt.call(this),this.a=new Gn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new yr(this)}function pr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function dr(){De.call(this),this.status=1}function yr(t){this.a=t}(N=kn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Oe),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Cn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ee(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ft(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ft(this,"complete"),Ft(this,"abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),kn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Sa())},N.Sa=function(){Un(this)},N.W=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},N.ua=function(){return this.h},N.Oa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ke(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),en(i=Xe(this.B),"RID",t),en(i,"CVER",22),this.A&&en(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&Bn(i,this.i,r),Tn(this.b,n),this.Ga&&en(i,"TYPE","init"),this.da?(en(i,"$req",e),en(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||_n(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,nr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(M(this.Ra,this),t))},N.Ra=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,we(10),Wn(this),nr(this))},N.Qa=function(){null!=this.m&&(this.m=null,Wn(this),tr(this),we(19))},N.Wa=function(t){t?(this.c.info("Successfully pinged google.com"),we(2)):(this.c.info("Failed to ping google.com"),we(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},fr.prototype.a=function(t,e){return new lr(t,e)},q(lr,qt),lr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;we(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=ar(t,null,t.fa),Yn(t)},lr.prototype.close=function(){Kn(this.a)},lr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=zt(t),Qn(this.a,e)):Qn(this.a,t)},lr.prototype.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,lr.X.G.call(this)},q(pr,Se),q(dr,De),q(yr,hr),yr.prototype.ta=function(){Ft(this.a,"a")},yr.prototype.sa=function(t){Ft(this.a,new pr(t))},yr.prototype.ra=function(t){Ft(this.a,new dr)},yr.prototype.qa=function(){Ft(this.a,"b")},fr.prototype.createWebChannel=fr.prototype.a,lr.prototype.send=lr.prototype.h,lr.prototype.open=lr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",qt.prototype.listen=qt.prototype.va,kn.prototype.listenOnce=kn.prototype.wa,kn.prototype.getLastError=kn.prototype.Oa,kn.prototype.getLastErrorCode=kn.prototype.ua,kn.prototype.getStatus=kn.prototype.W,kn.prototype.getResponseJson=kn.prototype.Na,kn.prototype.getResponseText=kn.prototype.$,kn.prototype.send=kn.prototype.ba;var vr=Ie,gr=Ee,mr=Ae,wr=kn,br=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Er=(Object.defineProperty(Ar.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ar.prototype.isEqual=function(t){return t instanceof Ar&&t.projectId===this.projectId&&t.database===this.database},Ar),Tr=(Nr.prototype.u=function(){return null!=this.uid},Nr.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},Nr.prototype.isEqual=function(t){return t.uid===this.uid},Nr);function Nr(t){this.uid=t}function Ar(t,e){this.projectId=t,this.database=e||"(default)"}Tr.UNAUTHENTICATED=new Tr(null),Tr.l=new Tr("google-credentials-uid"),Tr._=new Tr("first-party-uid");var Or=new h("@firebase/firestore");function Sr(){return Or.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Or.logLevel<=l.DEBUG&&(e=n.map(Pr),Or.debug.apply(Or,s(["Firestore (8.1.0): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Or.logLevel<=l.ERROR&&(e=n.map(Pr),Or.error.apply(Or,s(["Firestore (8.1.0): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Or.logLevel<=l.WARN&&(e=n.map(Pr),Or.warn.apply(Or,s(["Firestore (8.1.0): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Rr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.1.0) INTERNAL ASSERTION FAILED: "+t;throw xr(t),new Error(t)}function Cr(t){t||Rr()}function Lr(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t}var Vr,Mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ur=(n(Hr,Vr=Error),Hr),jr=(Wr.prototype.getToken=function(){return Promise.resolve(null)},Wr.prototype.m=function(){},Wr.prototype.A=function(t){(this.I=t)(Tr.UNAUTHENTICATED)},Wr.prototype.R=function(){this.I=null},Wr),qr=(Kr.prototype.getToken=function(){var e=this,n=this.V,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.V!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Cr("string"==typeof t.accessToken),new Lr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Kr.prototype.m=function(){this.forceRefresh=!0},Kr.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},Kr.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},Kr.prototype.p=function(){var t=this.auth&&this.auth.getUid();return Cr(null===t||"string"==typeof t),new Tr(t)},Kr),Fr=(Object.defineProperty(Gr.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Gr),Br=(zr.prototype.getToken=function(){return Promise.resolve(new Fr(this.v,this.S))},zr.prototype.A=function(t){t(Tr._)},zr.prototype.R=function(){},zr.prototype.m=function(){},zr);function zr(t,e){this.v=t,this.S=e}function Gr(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Tr._}function Kr(t){var e=this;this.P=null,this.currentUser=Tr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then(function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)},function(){}))}function Wr(){this.I=null}function Hr(t,e){var n=this;return(n=Vr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}var Qr=(Yr.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Yr);function Yr(){}function Xr(t,e){return t<e?-1:e<t?1:0}function Jr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function $r(t){return t+"\0"}var Zr,ti,ei=(li.now=function(){return li.fromMillis(Date.now())},li.fromDate=function(t){return li.fromMillis(t.getTime())},li.fromMillis=function(t){var e=Math.floor(t/1e3);return new li(e,1e6*(t-1e3*e))},li.prototype.toDate=function(){return new Date(this.toMillis())},li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},li.prototype.C=function(t){return this.seconds===t.seconds?Xr(this.nanoseconds,t.nanoseconds):Xr(this.seconds,t.seconds)},li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},li),ni=(fi.N=function(t){return new fi(t)},fi.min=function(){return new fi(new ei(0,0))},fi.prototype.F=function(t){return this.timestamp.C(t.timestamp)},fi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},fi.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},fi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},fi.prototype.M=function(){return this.timestamp},fi),Ie=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.$(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},hi.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},hi.prototype.U=function(){return this.segments[this.offset]},hi.prototype.K=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype.W=function(){return 0===this.length},hi.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},hi.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ri=(n(ci,ti=Ie),ci.prototype.L=function(t,e,n){return new ci(t,e,n)},ci.prototype.J=function(){return this.H().join("/")},ci.prototype.toString=function(){return this.J()},ci.Y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ci(n)},ci.X=function(){return new ci([])},ci),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=(n(ai,Zr=Ie),ai.prototype.L=function(t,e,n){return new ai(t,e,n)},ai.Z=function(t){return ii.test(t)},ai.prototype.J=function(){return this.H().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ai.Z(t)||(t="`"+t+"`"),t}).join(".")},ai.prototype.toString=function(){return this.J()},ai.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},ai.et=function(){return new ai(["__name__"])},ai.nt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ur(Mr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ur(Mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ur(Mr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.X=function(){return new ai([])},ai),si=(ui.st=function(t){return new ui(ri.Y(t))},ui.it=function(t){return new ui(ri.Y(t).B(5))},ui.prototype.rt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===ri.$(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.$=function(t,e){return ri.$(t.path,e.path)},ui.ot=function(t){return t.length%2==0},ui.ct=function(t){return new ui(new ri(t.slice()))},ui);function ui(t){this.path=t}function ai(){return null!==Zr&&Zr.apply(this,arguments)||this}function ci(){return null!==ti&&ti.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&Rr(),void 0===n?n=t.length-e:n>t.length-e&&Rr(),this.segments=t,this.offset=e,this.k=n}function fi(t){this.timestamp=t}function li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ur(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ur(Mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ur(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ur(Mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function pi(t){return null==t}function di(t){return 0===t&&1/t==-1/0}function yi(t){return"number"==typeof t&&Number.isInteger(t)&&!di(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function gi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vi(t,e,n,r,i,o,s)}function mi(t){var e=t;return null===e.ut&&(t=e.path.J(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.J()+t.op.toString()+Eo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.J()+t.dir}).join(","),pi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ta(e.startAt)),e.endAt&&(t+="|ub:",t+=ta(e.endAt)),e.ut=t),e.ut}function wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!wo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!na(t.startAt,e.startAt)&&na(t.endAt,e.endAt)}function bi(t){return si.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}var _i=(Ii.fromBase64String=function(t){return new Ii(atob(t))},Ii.fromUint8Array=function(t){return new Ii(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ii.prototype.toBase64=function(){return t=this.at,btoa(t);var t},Ii.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},Ii.prototype.ht=function(){return 2*this.at.length},Ii.prototype.F=function(t){return Xr(this.at,t.at)},Ii.prototype.isEqual=function(t){return this.at===t.at},Ii);function Ii(t){this.at=t}_i.lt=new _i("");function Ei(t){this.count=t}var Ti,Ni=(Ai.prototype.dt=function(t){return new Ai(this.target,this.targetId,this._t,t,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ai.prototype.wt=function(t,e){return new Ai(this.target,this.targetId,this._t,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ai.prototype.Et=function(t){return new Ai(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,t,this.resumeToken)},Ai);function Ai(t,e,n,r,i,o,s){void 0===i&&(i=ni.min()),void 0===o&&(o=ni.min()),void 0===s&&(s=_i.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Oi(t){switch(t){case Mr.OK:return Rr(),0;case Mr.CANCELLED:case Mr.UNKNOWN:case Mr.DEADLINE_EXCEEDED:case Mr.RESOURCE_EXHAUSTED:case Mr.INTERNAL:case Mr.UNAVAILABLE:case Mr.UNAUTHENTICATED:return;case Mr.INVALID_ARGUMENT:case Mr.NOT_FOUND:case Mr.ALREADY_EXISTS:case Mr.PERMISSION_DENIED:case Mr.FAILED_PRECONDITION:case Mr.ABORTED:case Mr.OUT_OF_RANGE:case Mr.UNIMPLEMENTED:case Mr.DATA_LOSS:return 1;default:return Rr(),0}}function Si(t){if(void 0===t)return xr("GRPC error has no .code"),Mr.UNKNOWN;switch(t){case Ti.OK:return Mr.OK;case Ti.CANCELLED:return Mr.CANCELLED;case Ti.UNKNOWN:return Mr.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Mr.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Mr.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Mr.INTERNAL;case Ti.UNAVAILABLE:return Mr.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Mr.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Mr.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Mr.NOT_FOUND;case Ti.ALREADY_EXISTS:return Mr.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Mr.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Mr.FAILED_PRECONDITION;case Ti.ABORTED:return Mr.ABORTED;case Ti.OUT_OF_RANGE:return Mr.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Mr.UNIMPLEMENTED;case Ti.DATA_LOSS:return Mr.DATA_LOSS;default:return Rr()}}(Ee=Ti=Ti||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Di=(Ci.prototype.Tt=function(t,e){return new Ci(this.$,this.root.Tt(t,e,this.$).copy(null,null,ki.It,null,null))},Ci.prototype.remove=function(t){return new Ci(this.$,this.root.remove(t,this.$).copy(null,null,ki.It,null,null))},Ci.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ci.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ci.prototype.W=function(){return this.root.W()},Object.defineProperty(Ci.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ci.prototype.At=function(){return this.root.At()},Ci.prototype.Rt=function(){return this.root.Rt()},Ci.prototype.Pt=function(t){return this.root.Pt(t)},Ci.prototype.forEach=function(n){this.Pt(function(t,e){return n(t,e),!1})},Ci.prototype.toString=function(){var n=[];return this.Pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ci.prototype.gt=function(t){return this.root.gt(t)},Ci.prototype.yt=function(){return new xi(this.root,null,this.$,!1)},Ci.prototype.Vt=function(t){return new xi(this.root,t,this.$,!1)},Ci.prototype.vt=function(){return new xi(this.root,null,this.$,!0)},Ci.prototype.bt=function(t){return new xi(this.root,t,this.$,!0)},Ci),xi=(Ri.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},Ri.prototype.Nt=function(){return 0<this.Dt.length},Ri.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},Ri),ki=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype.W=function(){return!1},Pi.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},Pi.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},Pi.prototype.min=function(){return this.left.W()?this:this.left.min()},Pi.prototype.At=function(){return this.min().key},Pi.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},Pi.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},Pi.prototype.Ot=function(){if(this.left.W())return Pi.EMPTY;var t=this;return t.left.Mt()||t.left.left.Mt()||(t=t.kt()),(t=t.copy(null,null,null,t.left.Ot(),null)).Ft()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.W()||r.left.Mt()||r.left.left.Mt()||(r=r.kt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Mt()&&(r=r.$t()),r.right.W()||r.right.Mt()||r.right.left.Mt()||(r=r.Lt()),0===e(t,r.key)){if(r.right.W())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Ot())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Ft()},Pi.prototype.Mt=function(){return this.color},Pi.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},Pi.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},Pi.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},Pi.prototype.Bt=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.$t=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},Pi.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Rr();if(this.right.Mt())throw Rr();var t=this.left.Qt();if(t!==this.right.Qt())throw Rr();return t+(this.Mt()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Ri(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}function Ci(t,e){this.$=t,this.root=e||ki.EMPTY}function Li(){this.size=0}ki.EMPTY=null,ki.RED=!0,ki.It=!1,ki.EMPTY=(Object.defineProperty(Li.prototype,"key",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Li.prototype,"value",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Li.prototype,"color",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Li.prototype,"left",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Object.defineProperty(Li.prototype,"right",{get:function(){throw Rr()},enumerable:!1,configurable:!0}),Li.prototype.copy=function(t,e,n,r,i){return this},Li.prototype.Tt=function(t,e,n){return new ki(t,e)},Li.prototype.remove=function(t,e){return this},Li.prototype.W=function(){return!0},Li.prototype.Pt=function(t){return!1},Li.prototype.gt=function(t){return!1},Li.prototype.At=function(){return null},Li.prototype.Rt=function(){return null},Li.prototype.Mt=function(){return!1},Li.prototype.Ut=function(){return!0},Li.prototype.Qt=function(){return 0},new Li);var Vi=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.At()},qi.prototype.last=function(){return this.data.Rt()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.Pt(function(t,e){return n(t),!1})},qi.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(0<=this.$(r.key,t[1]))return;e(r.key)}},qi.prototype.Wt=function(t,e){for(var n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},qi.prototype.jt=function(t){t=this.data.Vt(t);return t.Nt()?t.Ct().key:null},qi.prototype.yt=function(){return new Mi(this.data.yt())},qi.prototype.Vt=function(t){return new Mi(this.data.Vt(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype.W=function(){return this.data.W()},qi.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.yt(),n=t.data.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(0!==this.$(r,i))return!1}return!0},qi.prototype.H=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.$);return e.data=t,e},qi),Mi=(ji.prototype.Ct=function(){return this.zt.Ct().key},ji.prototype.Nt=function(){return this.zt.Nt()},ji),Ui=new Di(si.$);function ji(t){this.zt=t}function qi(t){this.$=t,this.data=new Di(this.$)}var Fi=new Di(si.$);var Bi=new Di(si.$),zi=new Vi(si.$);function Gi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=zi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Ki=new Vi(Xr);var Wi=(ao.Yt=function(t){return new ao(t.$)},ao.prototype.has=function(t){return null!=this.Ht.get(t)},ao.prototype.get=function(t){return this.Ht.get(t)},ao.prototype.first=function(){return this.Jt.At()},ao.prototype.last=function(){return this.Jt.Rt()},ao.prototype.W=function(){return this.Jt.W()},ao.prototype.indexOf=function(t){t=this.Ht.get(t);return t?this.Jt.indexOf(t):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.Jt.Pt(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Jt.yt(),n=t.Jt.yt();e.Nt();){var r=e.Ct().key,i=n.Ct().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.$=this.$,n.Ht=t,n.Jt=e,n},ao),Hi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);!n||0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Rr()},uo.prototype.Zt=function(){var n=[];return this.Xt.Pt(function(t,e){n.push(e)}),n},uo),Qi=(so.ie=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Wi.Yt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&Eu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Yi=(oo.ae=function(t,e){var n=new Map;return n.set(t,Xi.he(t,e)),new oo(ni.min(),n,Ki,Ui,Gi())},oo),Xi=(io.he=function(t,e){return new io(_i.lt,e,Gi(),Gi(),Gi())},io),Ji=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},$i=function(t,e){this.targetId=t,this.Te=e},Zi=function(t,e,n,r){void 0===n&&(n=_i.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},to=(Object.defineProperty(ro.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),ro.prototype.Ve=function(t){0<t.ht()&&(this.Pe=!0,this.Ae=t)},ro.prototype.pe=function(){var n=Gi(),r=Gi(),i=Gi();return this.me.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Rr()}}),new Xi(this.Ae,this.Re,n,r,i)},ro.prototype.ve=function(){this.Pe=!1,this.me=ho()},ro.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},ro.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},ro.prototype.De=function(){this.Ie+=1},ro.prototype.Ce=function(){--this.Ie},ro.prototype.Ne=function(){this.Pe=!0,this.Re=!0},ro),eo=(no.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof su?this.Le(r,t.Ee):t.Ee instanceof uu&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Be(s,t.key,t.Ee)}},no.prototype.qe=function(n){var r=this;this.Ue(n,function(t){var e=r.Qe(t);switch(n.state){case 0:r.Ke(t)&&e.Ve(n.resumeToken);break;case 1:e.Ce(),e.ge||e.ve(),e.Ve(n.resumeToken);break;case 2:e.Ce(),e.ge||r.removeTarget(t);break;case 3:r.Ke(t)&&(e.Ne(),e.Ve(n.resumeToken));break;case 4:r.Ke(t)&&(r.We(t),e.Ve(n.resumeToken));break;default:Rr()}})},no.prototype.Ue=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Fe.forEach(function(t,e){r.Ke(e)&&n(e)})},no.prototype.je=function(t){var e=t.targetId,n=t.Te.count,t=this.Ge(e);t&&(bi(t=t.target)?0===n?(t=new si(t.path),this.Be(e,t,new uu(t,ni.min()))):Cr(1===n):this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e)))},no.prototype.He=function(r){var i=this,o=new Map;this.Fe.forEach(function(t,e){var n=i.Ge(e);n&&(t.le&&bi(n.target)&&(n=new si(n.target.path),null!==i.Oe.get(n)||i.Je(e,n)||i.Be(e,n,new uu(n,r))),t.ye&&(o.set(e,t.pe()),t.ve()))});var s=Gi();this.Me.forEach(function(t,e){var n=!0;e.Wt(function(t){t=i.Ge(t);return!t||2===t._t||(n=!1)}),n&&(s=s.add(t))});var t=new Yi(r,o,this.ke,this.Oe,s);return this.Oe=Ui,this.Me=co(),this.ke=new Vi(Xr),t},no.prototype.Le=function(t,e){var n;this.Ke(t)&&(n=this.Je(t,e.key)?2:0,this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t)))},no.prototype.Be=function(t,e,n){var r;this.Ke(t)&&(r=this.Qe(t),this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n)))},no.prototype.removeTarget=function(t){this.Fe.delete(t)},no.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},no.prototype.De=function(t){this.Qe(t).De()},no.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new to,this.Fe.set(t,e)),e},no.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Vi(Xr),this.Me=this.Me.Tt(t,e)),e},no.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},no.prototype.We=function(e){var n=this;this.Fe.set(e,new to),this.xe.Xe(e).forEach(function(t){n.Be(e,t,null)})},no.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},no);function no(t){this.xe=t,this.Fe=new Map,this.Oe=Ui,this.Me=co(),this.ke=new Vi(Xr)}function ro(){this.Ie=0,this.me=ho(),this.Ae=_i.lt,this.Re=!1,this.Pe=!0}function io(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}function oo(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}function uo(){this.Xt=new Di(si.$)}function ao(n){this.$=n?function(t,e){return n(t,e)||si.$(t.key,e.key)}:function(t,e){return si.$(t.key,e.key)},this.Ht=Fi,this.Jt=new Di(this.$)}function co(){return new Di(si.$)}function ho(){return new Di(si.$)}function fo(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function lo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function po(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function yo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function vo(t){t=To(t.mapValue.fields.__local_write_time__.timestampValue);return new ei(t.seconds,t.nanos)}var go=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yo(t)?4:10:Rr()}function wo(r,i){var t,e=mo(r);if(e!==mo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return vo(r).isEqual(vo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=To(r.timestampValue),t=To(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Ao(r.bytesValue).isEqual(Ao(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,No((t=r).geoPointValue.latitude)===No(e.geoPointValue.latitude)&&No(t.geoPointValue.longitude)===No(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return No(t.integerValue)===No(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=No(t.doubleValue),e=No(e.doubleValue);return t===e?di(t)===di(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Jr(r.arrayValue.values||[],i.arrayValue.values||[],wo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(fo(e)!==fo(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!wo(e[t],n[t])))return!1;return!0}();default:return Rr()}}function bo(t,e){return void 0!==(t.values||[]).find(function(t){return wo(t,e)})}function _o(t,e){var n,r,i=mo(t),o=mo(e);if(i!==o)return Xr(i,o);switch(i){case 0:return 0;case 1:return Xr(t.booleanValue,e.booleanValue);case 2:return n=e,r=No(t.integerValue||t.doubleValue),n=No(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Io(t.timestampValue,e.timestampValue);case 4:return Io(vo(t),vo(e));case 5:return Xr(t.stringValue,e.stringValue);case 6:return function(t,e){t=Ao(t),e=Ao(e);return t.F(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Xr(n[i],r[i]);if(0!==o)return o}return Xr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Xr(No(i.latitude),No(r.latitude)))?n:Xr(No(i.longitude),No(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=_o(n[i],r[i]);if(o)return o}return Xr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Xr(r[s],o[s]);if(0!==u)return u;u=_o(n[r[s]],i[o[s]]);if(0!==u)return u}return Xr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Rr()}}function Io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Xr(t,e);var n=To(t),t=To(e),e=Xr(n.seconds,t.seconds);return 0!==e?e:Xr(n.nanos,t.nanos)}function Eo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=To(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ao(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,si.it(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Rr();var e}(t)}function To(t){if(Cr(!!t),"string"!=typeof t)return{seconds:No(t.seconds),nanos:No(t.nanos)};var e=0,n=go.exec(t);Cr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function No(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?_i.fromBase64String(t):_i.fromUint8Array(t)}function Oo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function So(t){return t&&"integerValue"in t}function Do(t){return!!t&&"arrayValue"in t}function xo(t){return t&&"nullValue"in t}function ko(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Po(t){return t&&"mapValue"in t}var Ro={asc:"ASCENDING",desc:"DESCENDING"},Co={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lo=function(t,e){this.t=t,this.tn=e};function Vo(t){return{integerValue:""+t}}function Mo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:di(e)?"-0":e}}function Uo(t,e){return yi(e)?Vo(e):Mo(t,e)}function jo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qo(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Fo(t){return Cr(!!t),ni.N((t=To(t),new ei(t.seconds,t.nanos)))}function Bo(t,e){return new ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).J()}function zo(t){t=ri.Y(t);return Cr(us(t)),t}function Go(t,e){return Bo(t.t,e.path)}function Ko(t,e){e=zo(e);if(e.get(1)!==t.t.projectId)throw new Ur(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Ur(Mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new si(Yo(e))}function Wo(t,e){return Bo(t.t,e)}function Ho(t){t=zo(t);return 4===t.length?ri.X():Yo(t)}function Qo(t){return new ri(["projects",t.t.projectId,"databases",t.t.database]).J()}function Yo(t){return Cr(4<t.length&&"documents"===t.get(4)),t.B(5)}function Xo(t,e,n){return{name:Go(t,e),fields:n.proto.mapValue.fields}}function Jo(t,e){var n,r,i;if(e instanceof Us)n={update:Xo(t,e.key,e.value)};else if(e instanceof Ys)n={delete:Go(t,e.key)};else if(e instanceof js)n={update:Xo(t,e.key,e.data),updateMask:(i=e.en,r=[],i.fields.forEach(function(t){return r.push(t.J())}),{fieldPaths:r})};else if(e instanceof Gs)n={transform:{document:Go(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof fs)return{fieldPath:t.field.J(),setToServerValue:"REQUEST_TIME"};if(e instanceof ls)return{fieldPath:t.field.J(),appendMissingElements:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.J(),removeAllFromArray:{values:e.elements}};if(e instanceof _s)return{fieldPath:t.field.J(),increment:e.nn};throw Rr()})}};else{if(!(e instanceof Xs))return Rr();n={verify:Go(t,e.key)}}return e.rn.sn||(n.currentDocument=void 0!==(i=e.rn).updateTime?{updateTime:(e=t,t=i.updateTime,jo(e,t.M()))}:void 0!==i.exists?{exists:i.exists}:Rr()),n}function $o(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ds.updateTime(Fo(o.updateTime)):void 0!==o.exists?Ds.exists(o.exists):Ds.on():Ds.on();if(t.update){t.update.name;var r=Ko(e,t.update.name),i=new Js({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Ns(o.map(function(t){return oi.nt(t)})));return new js(r,i,o,n)}return new Us(r,i,n)}if(t.delete){var s=Ko(e,t.delete);return new Ys(s,n)}if(t.transform){i=Ko(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Cr("REQUEST_TIME"===e.setToServerValue),r=new fs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new ls(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new gs(n)):"increment"in e?r=new _s(t,e.increment):Rr();e=oi.nt(e.fieldPath);return new As(e,r)}(e,t)});return Cr(!0===n.exists),new Gs(i,s)}if(t.verify){t=Ko(e,t.verify);return new Xs(t,n)}return Rr()}function Zo(t,e){return{documents:[Wo(t,e.path)]}}function ts(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Wo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Wo(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(ko(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NAN"}};if(xo(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ko(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NOT_NAN"}};if(xo(t.value))return{unaryFilter:{field:is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:is(t.field),op:(e=t.op,Co[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:is((t=t).field),direction:(t=t.dir,Ro[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.tn||pi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ns(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ns(e.endAt)),n}function es(t){var e=Ho(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Cr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ss(t)]:void 0!==t.fieldFilter?[(n=t,Du.create(os(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Rr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Rr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ra(os((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=pi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=rs(n.startAt));var u=null;return n.endAt&&(u=rs(n.endAt)),pu(e,i,t,o,r,"F",s,u)}function ns(t){return{before:t.before,values:t.position}}function rs(t){var e=!!t.before,t=t.values||[];return new Yu(t,e)}function is(t){return{fieldPath:t.J()}}function os(t){return oi.nt(t.fieldPath)}function ss(t){switch(t.unaryFilter.op){case"IS_NAN":var e=os(t.unaryFilter.field);return Du.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=os(t.unaryFilter.field);return Du.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=os(t.unaryFilter.field);return Du.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=os(t.unaryFilter.field);return Du.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Rr()}}function us(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.cn=void 0};function as(t,e){return t instanceof _s?So(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var cs,hs,fs=(n(ds,hs=h),ds),ls=(n(ps,cs=h),ps);function ps(t){var e=this;return(e=cs.call(this)||this).elements=t,e}function ds(){return null!==hs&&hs.apply(this,arguments)||this}function ys(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return wo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=h),ms);function ms(t){var e=this;return(e=vs.call(this)||this).elements=t,e}function ws(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!wo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var bs,_s=(n(Is,bs=h),Is);function Is(t,e){var n=this;return(n=bs.call(this)||this).serializer=t,n.nn=e,n}function Es(t){return No(t.integerValue||t.doubleValue)}function Ts(t){return Do(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ns=(Os.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},Os.prototype.isEqual=function(t){return Jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Os),As=function(t,e){this.field=t,this.transform=e};function Os(t){(this.fields=t).sort(oi.$)}function Ss(t,e){this.version=t,this.transformResults=e}var Ds=(xs.on=function(){return new xs},xs.exists=function(t){return new xs(void 0,t)},xs.updateTime=function(t){return new xs(t)},Object.defineProperty(xs.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),xs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},xs);function xs(t,e){this.updateTime=t,this.exists=e}function ks(t,e){return void 0!==t.updateTime?e instanceof su&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof su}Ie=function(){};function Ps(t,e,n){return t instanceof Us?new su(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof js?function(t,e,n){if(!ks(t.rn,e))return new au(t.key,n.version);e=Bs(t,e);return new su(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Gs?function(t,e,n){if(Cr(null!=n.transformResults),!ks(t.rn,e))return new au(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Cr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof su&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ls?ys(o,s):o instanceof gs?ws(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ws(t,r.data(),e);return new su(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new uu(t.key,n.version,{hasCommittedMutations:!0})}function Rs(t,e,n,r){return t instanceof Us?function(t,e){if(!ks(t.rn,e))return e;e=Ls(e);return new su(t.key,e,t.value,{an:!0})}(t,e):t instanceof js?function(t,e){if(!ks(t.rn,e))return e;var n=Ls(e),e=Bs(t,e);return new su(t.key,n,e,{an:!0})}(t,e):t instanceof Gs?function(t,e,n,r){if(!ks(t.rn,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof su&&(h=n.field(a.field)),null===h&&r instanceof su&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof fs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof ls?ys(c,i):c instanceof gs?ws(c,i):(c=as(h=c,i),i=Es(c)+Es(h.nn),So(c)&&So(h.nn)?Vo(i):Mo(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ws(t,i.data(),r);return new su(t.key,i.version,r,{an:!0})}(t,e,r,n):(e=e,ks((t=t).rn,e)?new uu(t.key,ni.min()):e)}function Cs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||Jr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ls&&e instanceof ls||t instanceof gs&&e instanceof gs?Jr(t.elements,e.elements,wo):t instanceof _s&&e instanceof _s?wo(t.nn,e.nn):t instanceof fs&&e instanceof fs)}))}function Ls(t){return t instanceof su?t.version:ni.min()}var Vs,Ms,Us=(n(Fs,Ms=Ie),Fs),js=(n(qs,Vs=Ie),qs);function qs(t,e,n,r){var i=this;return(i=Vs.call(this)||this).key=t,i.data=e,i.en=n,i.rn=r,i.type=1,i}function Fs(t,e,n){var r=this;return(r=Ms.call(this)||this).key=t,r.value=e,r.rn=n,r.type=0,r}function Bs(t,e){return n=t,e=e instanceof su?e.data():Js.empty(),r=new $s(e),n.en.fields.forEach(function(t){var e;t.W()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.hn();var n,r}var zs,Gs=(n(Ks,zs=Ie),Ks);function Ks(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.rn=Ds.exists(!0),n}function Ws(t,e,n){for(var r=new $s(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var Hs,Qs,Ys=(n(nu,Qs=Ie),nu),Xs=(n(eu,Hs=Ie),eu),Js=(tu.empty=function(){return new tu({mapValue:{}})},tu.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Po(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},tu.prototype.isEqual=function(t){return wo(this.proto,t.proto)},tu),$s=(Zs.prototype.set=function(t,e){return this.fn(t,e),this},Zs.prototype.delete=function(t){return this.fn(t,null),this},Zs.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===mo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.K(),e)},Zs.prototype.hn=function(){var t=this.dn(oi.X(),this._n);return null!=t?new Js(t):this.ln},Zs.prototype.dn=function(r,t){var i=this,o=!1,e=this.ln.field(r),s=Po(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.dn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Zs);function Zs(t){void 0===t&&(t=Js.empty()),this.ln=t,this._n=new Map}function tu(t){this.proto=t}function eu(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.rn=e,n.type=4,n}function nu(t,e){var n=this;return(n=Qs.call(this)||this).key=t,n.rn=e,n.type=3,n}var ru,iu,ou,Ee=function(t,e){this.key=t,this.version=e},su=(n(lu,ou=Ee),lu.prototype.field=function(t){return this.wn.field(t)},lu.prototype.data=function(){return this.wn},lu.prototype.En=function(){return this.wn.proto},lu.prototype.isEqual=function(t){return t instanceof lu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},lu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu),uu=(n(fu,iu=Ee),fu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu),au=(n(hu,ru=Ee),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu),cu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null,this.startAt,this.endAt};function hu(){return null!==ru&&ru.apply(this,arguments)||this}function fu(t,e,n){var r=this;return(r=iu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function lu(t,e,n,r){var i=this;return(i=ou.call(this,t,e)||this).wn=n,i.an=!!r.an,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function pu(t,e,n,r,i,o,s,u){return new cu(t,e,n,r,i,o,s,u)}function du(t){return new cu(t)}function yu(t){return!pi(t.limit)&&"F"===t.limitType}function vu(t){return!pi(t.limit)&&"L"===t.limitType}function gu(t){return 0<t.Tn.length?t.Tn[0].field:null}function mu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function wu(t){return null!==t.collectionGroup}function bu(t){var e=t;if(null===e.In){e.In=[];var n=mu(e),t=gu(e);if(null!==n&&null===t)n.tt()||e.In.push(new ra(n)),e.In.push(new ra(oi.et(),"asc"));else{for(var r=!1,i=0,o=e.Tn;i<o.length;i++){var s=o[i];e.In.push(s),s.field.tt()&&(r=!0)}r||(n=0<e.Tn.length?e.Tn[e.Tn.length-1].dir:"asc",e.In.push(new ra(oi.et(),n)))}}return e.In}function _u(t){var e=t;if(!e.mn)if("F"===e.limitType)e.mn=gi(e.path,e.collectionGroup,bu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=bu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ra(o.field,s))}var u=e.endAt?new Yu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Yu(e.startAt.position,!e.startAt.before):null;e.mn=gi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.mn}function Iu(t,e,n){return new cu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Eu(t,e){return wi(_u(t),_u(e))&&t.limitType===e.limitType}function Tu(t){return mi(_u(t))+"|lt:"+t.limitType}function Nu(t){return"Query(target="+(e=_u(t),n=e.path.J(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.J()+" "+t.op+" "+Eo(t.value)}).join(", ")+"]"),pi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.J()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ta(e.startAt)),e.endAt&&(n+=", endAt: "+ta(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Au(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.rt(e.collectionGroup)&&e.path.j(n):si.ot(e.path)?e.path.isEqual(n):e.path.G(n))&&function(t){for(var e=0,n=i.Tn;e<n.length;e++){var r=n[e];if(!r.field.tt()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ea(t.startAt,bu(t),n))&&(!t.endAt||!ea(t.endAt,bu(t),n)));var e,n}function Ou(u){return function(t,e){for(var n=!1,r=0,i=bu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.tt()?si.$(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?_o(n,t):Rr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Rr()}}(o,t,e);if(0!==s)return s;n=n||o.field.tt()}return 0}}var Su,Du=(n(xu,Su=function(){}),xu.create=function(t,e,n){return t.tt()?"in"===e||"not-in"===e?this.Rn(t,e,n):new Cu(t,e,n):"array-contains"===e?new Ku(t,n):"in"===e?new Wu(t,n):"not-in"===e?new Hu(t,n):"array-contains-any"===e?new Qu(t,n):new xu(t,e,n)},xu.Rn=function(t,e,n){return new("in"===e?Lu:Vu)(t,n)},xu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.Pn(_o(t,this.value)):null!==t&&mo(this.value)===mo(t)&&this.Pn(_o(t,this.value))},xu.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Rr()}},xu.prototype.An=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},xu);function xu(t,e,n){var r=this;return(r=Su.call(this)||this).field=t,r.op=e,r.value=n,r}var ku,Pu,Ru,Cu=(n(ju,Ru=Du),ju.prototype.matches=function(t){t=si.$(t.key,this.key);return this.Pn(t)},ju),Lu=(n(Uu,Pu=Du),Uu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Uu),Vu=(n(Mu,ku=Du),Mu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Mu);function Mu(t,e){var n=this;return(n=ku.call(this,t,"not-in",e)||this).keys=qu(0,e),n}function Uu(t,e){var n=this;return(n=Pu.call(this,t,"in",e)||this).keys=qu(0,e),n}function ju(t,e,n){var r=this;return(r=Ru.call(this,t,e,n)||this).key=si.it(n.referenceValue),r}function qu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return si.it(t.referenceValue)})}var Fu,Bu,zu,Gu,Ku=(n(Zu,Gu=Du),Zu.prototype.matches=function(t){t=t.field(this.field);return Do(t)&&bo(t.arrayValue,this.value)},Zu),Wu=(n($u,zu=Du),$u.prototype.matches=function(t){t=t.field(this.field);return null!==t&&bo(this.value.arrayValue,t)},$u),Hu=(n(Ju,Bu=Du),Ju.prototype.matches=function(t){if(bo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!bo(this.value.arrayValue,t)},Ju),Qu=(n(Xu,Fu=Du),Xu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Do(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return bo(e.value.arrayValue,t)})},Xu),Yu=function(t,e){this.position=t,this.before=e};function Xu(t,e){return Fu.call(this,t,"array-contains-any",e)||this}function Ju(t,e){return Bu.call(this,t,"not-in",e)||this}function $u(t,e){return zu.call(this,t,"in",e)||this}function Zu(t,e){return Gu.call(this,t,"array-contains",e)||this}function ta(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function ea(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.tt()?si.$(si.it(s.referenceValue),n.key):_o(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function na(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!wo(t.position[n],e.position[n]))return!1;return!0}var ra=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var ia=(pa.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ps(o,e,r[i]))}return e},pa.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Rs(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Rs(a,e,o,this.gn))}return e},pa.prototype.vn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.pn(t.key,n.get(t.key));e&&(i=i.Tt(t.key,e))}),i},pa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Gi())},pa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Jr(this.mutations,t.mutations,Cs)&&Jr(this.baseMutations,t.baseMutations,Cs)},pa),oa=(la.from=function(t,e,n){Cr(t.mutations.length===n.length);for(var r=Bi,i=t.mutations,o=0;o<i.length;o++)r=r.Tt(i[o].key,n[o].version);return new la(t,e,n,r)},la),sa=(fa.prototype.get=function(t){var e=this.Dn(t),e=this.Nn[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.Cn(o,t))return i}},fa.prototype.has=function(t){return void 0!==this.get(t)},fa.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},fa.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},fa.prototype.forEach=function(s){lo(this.Nn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},fa.prototype.W=function(){return po(this.Nn)},fa),ua=(ha.prototype.catch=function(t){return this.next(void 0,t)},ha.prototype.next=function(r,i){var o=this;return this.Mn&&Rr(),this.Mn=!0,this.On?this.error?this.kn(i,this.error):this.$n(r,this.result):new ha(function(e,n){o.xn=function(t){o.$n(r,t).next(e,n)},o.Fn=function(t){o.kn(i,t).next(e,n)}})},ha.prototype.Ln=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ha.prototype.Bn=function(t){try{var e=t();return e instanceof ha?e:ha.resolve(e)}catch(t){return ha.reject(t)}},ha.prototype.$n=function(t,e){return t?this.Bn(function(){return t(e)}):ha.resolve(e)},ha.prototype.kn=function(t,e){return t?this.Bn(function(){return t(e)}):ha.reject(e)},ha.resolve=function(n){return new ha(function(t,e){t(n)})},ha.reject=function(n){return new ha(function(t,e){e(n)})},ha.qn=function(t){return new ha(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ha.Un=function(t){for(var n=ha.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ha.resolve(t):e()})}(r[e]);return n},ha.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.qn(i)},ha),h=(ca.prototype.Wn=function(t){t=this.Qn.get(t);return t?t.readTime:ni.min()},ca.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},ca.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},ca.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?ua.resolve(n.zn):this.Yn(t,e)},ca.prototype.getEntries=function(t,e){return this.Xn(t,e)},ca.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},ca.prototype.Gn=function(){},ca),aa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})};function ca(){this.Qn=new sa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Kn=!1}function ha(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t(function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)},function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)})}function fa(t,e){this.Dn=t,this.Cn=e,this.Nn={}}function la(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}function pa(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}function da(t){return new Lo(t,!0)}function ya(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var va="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Ea.prototype.es=function(t){this.ts.push(t)},Ea.prototype.ns=function(){this.ts.forEach(function(t){return t()})},Ea),ga=(Ia.prototype.cs=function(e,n){var r=this;return this.rs.us(e,n).next(function(t){return r.hs(e,n,t)})},Ia.prototype.hs=function(t,r,i){return this.ss.Jn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].pn(r,t);return t})},Ia.prototype.ls=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].pn(t,e);o=o.Tt(t,e)}),o},Ia.prototype._s=function(e,t){var n=this;return this.ss.getEntries(e,t).next(function(t){return n.fs(e,t)})},Ia.prototype.fs=function(e,r){var i=this;return this.rs.ds(e,r).next(function(t){var t=i.ls(e,r,t),n=Ui;return t.forEach(function(t,e){e=e||new uu(t,ni.min()),n=n.Tt(t,e)}),n})},Ia.prototype.ws=function(t,e,n){return r=e,si.ot(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Es(t,e.path):wu(e)?this.Ts(t,e,n):this.Is(t,e,n);var r},Ia.prototype.Es=function(t,e){return this.cs(t,new si(e)).next(function(t){var e=Fi;return t instanceof su&&(e=e.Tt(t.key,t)),e})},Ia.prototype.Ts=function(n,r,i){var o=this,s=r.collectionGroup,u=Fi;return this.os.As(n,s).next(function(t){return ua.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new cu(t,null,e.Tn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Is(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Tt(t,e)})})}).next(function(){return u})})},Ia.prototype.Is=function(e,n,t){var c,h,r=this;return this.ss.ws(e,n,t).next(function(t){return c=t,r.rs.Rs(e,n)}).next(function(t){return h=t,r.Ps(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Rs(s,a,a,r.gn);c=a instanceof su?c.Tt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Au(n,e)||(c=c.remove(t))}),c})},Ia.prototype.Ps=function(t,e,n){for(var r=Gi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof js&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof su&&(c=c.Tt(t,e))}),c})},Ia),ma=(_a.Vs=function(t,e){for(var n=Gi(),r=Gi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new _a(t,e.fromCache,n,r)},_a),wa=(ba.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ba.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},ba);function ba(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}function _a(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}function Ia(t,e,n){this.ss=t,this.rs=e,this.os=n}function Ea(){this.ts=[]}wa.Ds=-1;var Ta,Na=(Pa.prototype.reset=function(){this.Ms=0},Pa.prototype.Ls=function(){this.Ms=this.Os},Pa.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,function(){return e.$s=Date.now(),t()}),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},Pa.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},Pa.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},Pa.prototype.qs=function(){return(Math.random()-.5)*this.Ms},Pa),Aa=(ka.delete=function(t){return Dr("SimpleDb","Removing database:",t),Ua(window.indexedDB.deleteDatabase(t)).Ln()},ka.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(ka.zs())return!0;var t=p(),e=ka.js(t),n=0<e&&e<10,e=ka.Hs(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},ka.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Js)},ka.Ys=function(t,e){return t.store(e)},ka.js=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},ka.Hs=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},ka.prototype.Xs=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new Sa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Ur(Mr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Sa(o,t))},r.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Ws.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Dr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return i.Zs(t)}),this.db)]}})})},ka.prototype.ti=function(e){this.Zs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ka.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Xs(u)];case 2:return s.db=t.sent(),e=Ca.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ua.reject(t)}).Ln(),r={},n.catch(function(){}),[4,e.ei];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Dr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ka.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ka),Oa=(Object.defineProperty(xa.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(xa.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(xa.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),xa.prototype.done=function(){this.si=!0},xa.prototype.oi=function(t){this.ii=t},xa.prototype.delete=function(){return Ua(this.ni.delete())},xa),Sa=(n(Da,Ta=Ur),Da);function Da(t,e){var n=this;return(n=Ta.call(this,Mr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function xa(t){this.ni=t,this.si=!1,this.ii=null}function ka(t,e,n){this.name=t,this.version=e,this.Ws=n,12.2===ka.js(p())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Pa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}function Ra(t){return"IndexedDbTransactionError"===t.name}var Ca=(Ma.open=function(t,e,n,r){try{return new Ma(e,t.transaction(r,n))}catch(t){throw new Sa(e,t)}},Object.defineProperty(Ma.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),Ma.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ma.prototype.store=function(t){t=this.transaction.objectStore(t);return new La(t)},Ma),La=(Va.prototype.put=function(t,e){t=void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ua(t)},Va.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Ua(this.store.add(t))},Va.prototype.get=function(e){var n=this;return Ua(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},Va.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Ua(this.store.delete(t))},Va.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Ua(this.store.count())},Va.prototype.ui=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ai(e,function(t,e){n.push(e)}).next(function(){return n})},Va.prototype.hi=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.li=!1;e=this.cursor(e);return this.ai(e,function(t,e,n){return n.delete()})},Va.prototype._i=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ai(n,e)},Va.prototype.fi=function(r){var t=this.cursor({});return new ua(function(n,e){t.onerror=function(t){t=qa(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Va.prototype.ai=function(t,i){var o=[];return new ua(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Oa(n),(t=i(n.primaryKey,n.value,e))instanceof ua&&(t=t.catch(function(t){return e.done(),ua.reject(t)}),o.push(t)),e.On?r():null===e.ri?n.continue():n.continue(e.ri)):r()}}).next(function(){return ua.qn(o)})},Va.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Va.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Va);function Va(t){this.store=t}function Ma(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ci=new aa,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){t.error?n.ci.reject(new Sa(e,t.error)):n.ci.resolve()},this.transaction.onerror=function(t){t=qa(t.target.error);n.ci.reject(new Sa(e,t))}}function Ua(t){return new ua(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=qa(t.target.error);n(t)}})}var ja=!1;function qa(t){var e=Aa.js(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Ur("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ja||(ja=!0,setTimeout(function(){throw n},0)),n}}return t}function Fa(){return"undefined"!=typeof window?window:null}function Ba(){return"undefined"!=typeof document?document:null}var za=(Wa.Ii=function(t,e,n,r,i){i=new Wa(t,e,Date.now()+n,r,i);return i.start(n),i},Wa.prototype.start=function(t){var e=this;this.mi=setTimeout(function(){return e.Ai()},t)},Wa.prototype.Ks=function(){return this.Ai()},Wa.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Ur(Mr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Wa.prototype.Ai=function(){var e=this;this.di.Ri(function(){return null!==e.mi?(e.clearTimeout(),e.op().then(function(t){return e.Ti.resolve(t)})):Promise.resolve()})},Wa.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},Wa),Ga=(Object.defineProperty(Ka.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),Ka.prototype.Ri=function(t){this.enqueue(t)},Ka.prototype.Ni=function(t){this.xi(),this.Fi(t)},Ka.prototype.Oi=function(){var t;this.yi||(this.yi=!0,(t=Ba())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di))},Ka.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise(function(t){}):this.Fi(t)},Ka.prototype.Mi=function(t){var e=this;this.Ri(function(){return e.gi.push(t),e.ki()})},Ka.prototype.ki=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.gi.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return t.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.gi.length&&this.Si.Bs(function(){return n.ki()}),t.label=5;case 5:return[2]}})})},Ka.prototype.Fi=function(t){var r=this,e=this.Pi.then(function(){return r.vi=!0,t().catch(function(t){throw r.pi=t,r.vi=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.vi=!1,t})});return this.Pi=e},Ka.prototype.Us=function(t,e,n){var r=this;this.xi(),-1<this.bi.indexOf(t)&&(e=0);n=za.Ii(this,t,e,n,function(t){return r.$i(t)});return this.Vi.push(n),n},Ka.prototype.xi=function(){this.pi&&Rr()},Ka.prototype.Li=function(){},Ka.prototype.Bi=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Pi];case 1:t.sent(),t.label=2;case 2:if(e!==this.Pi)return[3,0];t.label=3;case 3:return[2]}})})},Ka.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},Ka.prototype.Ui=function(r){var i=this;return this.Bi().then(function(){i.Vi.sort(function(t,e){return t.wi-e.wi});for(var t=0,e=i.Vi;t<e.length;t++){var n=e[t];if(n.Ks(),"all"!==r&&n.Ns===r)break}return i.Bi()})},Ka.prototype.Qi=function(t){this.bi.push(t)},Ka.prototype.$i=function(t){t=this.Vi.indexOf(t);this.Vi.splice(t,1)},Ka);function Ka(){var e=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Na(this,"async_queue_retry"),this.Di=function(){var t=Ba();t&&Dr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Si.Qs()};var t=Ba();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Di)}function Wa(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new aa,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch(function(t){})}function Ha(t,e){if(xr("AsyncQueue",e+": "+t),Ra(t))return new Ur(Mr.UNAVAILABLE,e+": "+t);throw t}function Qa(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Xr(n,t);return 0===t?Xr(r,e):t}var Ya=(Za.prototype.ji=function(){return++this.Wi},Za.prototype.Gi=function(t){var e=[t,this.ji()];this.buffer.size<this.Ki?this.buffer=this.buffer.add(e):Qa(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Za.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Za),Xa={zi:!1,Hi:0,Ji:0,Yi:0},Ja=($a.er=function(t){return new $a(t,$a.nr,$a.sr)},$a);function $a(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}function Za(t){this.Ki=t,this.buffer=new Vi(Qa),this.Wi=0}Ja.nr=10,Ja.sr=1e3,Ja.ir=new Ja(41943040,Ja.nr,Ja.sr),Ja.rr=new Ja(-1,0,0);var tc=(rc.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},rc.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(rc.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),rc.prototype.hr=function(n){var t=this,e=this.ur?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ar=this.di.Us("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.ar=null,this.ur=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n._r(this.cr)];case 2:return t.sent(),[3,7];case 3:return Ra(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Gh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.hr(n)];case 8:return t.sent(),[2]}})})})},rc),ec=(nc.prototype.wr=function(t,e){return this.dr.Er(t).next(function(t){return Math.floor(e/100*t)})},nc.prototype.Tr=function(t,e){var n=this;if(0===e)return ua.resolve(wa.Ds);var r=new Ya(e);return this.dr.Ue(t,function(t){return r.Gi(t.sequenceNumber)}).next(function(){return n.dr.Ir(t,function(t){return r.Gi(t)})}).next(function(){return r.maxValue})},nc.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},nc.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},nc.prototype.Rr=function(e,n){var r=this;return-1===this.params.Xi?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),ua.resolve(Xa)):this.Pr(e).next(function(t){return t<r.params.Xi?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Xi),Xa):r.gr(e,n)})},nc.prototype.Pr=function(t){return this.dr.Pr(t)},nc.prototype.gr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.wr(e,this.params.Zi).next(function(t){return i=t>h.params.tr?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+t),h.params.tr):t,s=Date.now(),h.Tr(e,i)}).next(function(t){return r=t,u=Date.now(),h.mr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.Ar(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ua.resolve({zi:!0,Hi:i,Ji:o,Yi:t})})},nc);function nc(t,e){this.dr=t,this.params=e}function rc(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}function ic(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=oc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return oc(e)}function oc(t){return t+"\x01\x01"}function sc(t){var e=t.length;if(Cr(2<=e),2===e)return Cr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ri.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Rr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Rr()}o=s+2}return new ri(r)}var uc=function(t){this.yr=t};function ac(t,e){if(e.document)return n=t.yr,r=e.document,i=!!e.hasCommittedMutations,t=Ko(n,r.name),n=Fo(r.updateTime),r=new Js({mapValue:{fields:r.fields}}),new su(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=si.ct(e.noDocument.path),o=pc(e.noDocument.readTime);return new uu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=si.ct(e.unknownDocument.path),e=pc(e.unknownDocument.version);return new au(o,e)}return Rr()}function cc(t,e,n){var r=hc(n),n=e.key.path.q().H();if(e instanceof su){var i={name:Go(i=t.yr,(o=e).key),fields:o.En().mapValue.fields,updateTime:jo(i,o.version.M())},o=e.hasCommittedMutations;return new Qc(null,null,i,o,r,n)}if(e instanceof uu){var i=e.key.path.H(),o=lc(e.version),s=e.hasCommittedMutations;return new Qc(null,new Wc(i,o),null,s,r,n)}if(e instanceof au){s=e.key.path.H(),e=lc(e.version);return new Qc(new Hc(s,e),null,null,!0,r,n)}return Rr()}function hc(t){t=t.M();return[t.seconds,t.nanoseconds]}function fc(t){t=new ei(t[0],t[1]);return ni.N(t)}function lc(t){t=t.M();return new Mc(t.seconds,t.nanoseconds)}function pc(t){t=new ei(t.seconds,t.nanoseconds);return ni.N(t)}function dc(e,t){var n=(t.baseMutations||[]).map(function(t){return $o(e.yr,t)}),r=t.mutations.map(function(t){return $o(e.yr,t)}),i=ei.fromMillis(t.localWriteTimeMs);return new ia(t.batchId,i,n,r)}function yc(t){var e=pc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?pc(t.lastLimboFreeSnapshotVersion):ni.min(),r=void 0!==t.query.documents?(Cr(1===(r=t.query).documents.length),_u(du(Ho(r.documents[0])))):_u(es(t.query));return new Ni(r,t.targetId,0,t.lastListenSequenceNumber,e,n,_i.fromBase64String(t.resumeToken))}function vc(t,e){var n=lc(e.ft),r=lc(e.lastLimboFreeSnapshotVersion),i=(bi(e.target)?Zo:ts)(t.yr,e.target),t=e.resumeToken.toBase64();return new Xc(e.targetId,mi(e.target),n,t,e.sequenceNumber,r,i)}function gc(t){var e=es({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Iu(e,e.limit,"L"):e}var mc=(wc.vr=function(t,e,n,r){return Cr(""!==t.uid),new wc(t.u()?t.uid:"",e,n,r)},wc.prototype.br=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ic(t)._i({index:zc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},wc.prototype.Sr=function(d,y,v,g){var m=this,w=Ec(d),b=Ic(d);return b.add({}).next(function(t){Cr("number"==typeof t);for(var e,n,r,i,o,s=new ia(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Jo(e.yr,t)}),o=r.mutations.map(function(t){return Jo(e.yr,t)}),new zc(n,r.batchId,r.gn.toMillis(),i,o)),a=[],c=new Vi(function(t,e){return Xr(t.J(),e.J())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Gc.key(m.userId,l.key.path,t),c=c.add(l.key.path.q());a.push(b.put(u)),a.push(w.put(p,Gc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.os.Dr(d,t))}),d.es(function(){m.pr[t]=s.keys()}),ua.qn(a).next(function(){return s})})},wc.prototype.Cr=function(t,e){var n=this;return Ic(t).get(e).next(function(t){return t?(Cr(t.userId===n.userId),dc(n.serializer,t)):null})},wc.prototype.Nr=function(t,e){var n=this;return this.pr[e]?ua.resolve(this.pr[e]):this.Cr(t,e).next(function(t){if(t){t=t.keys();return n.pr[e]=t}return null})},wc.prototype.Fr=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Ic(t)._i({index:zc.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Cr(e.batchId>=i),o=dc(r.serializer,e)),n.done()}).next(function(){return o})},wc.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ic(t)._i({index:zc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},wc.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ic(t).ui(zc.userMutationsIndex,n).next(function(t){return t.map(function(t){return dc(e.serializer,t)})})},wc.prototype.us=function(o,s){var u=this,t=Gc.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Ec(o)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=sc(i);if(r===u.userId&&s.path.isEqual(i))return Ic(o).get(t).next(function(t){if(!t)throw Rr();Cr(t.userId===u.userId),a.push(dc(u.serializer,t))});n.done()}).next(function(){return a})},wc.prototype.ds=function(e,t){var s=this,u=new Vi(Xr),n=[];return t.forEach(function(o){var t=Gc.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Ec(e)._i({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=sc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ua.qn(n).next(function(){return s.kr(e,u)})},wc.prototype.Rs=function(t,e){var o=this,s=e.path,u=s.length+1,e=Gc.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Vi(Xr);return Ec(t)._i({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=sc(i);r===o.userId&&s.j(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.kr(t,a)})},wc.prototype.kr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Ic(e).get(t).next(function(t){if(null===t)throw Rr();Cr(t.userId===n.userId),r.push(dc(n.serializer,t))}))}),ua.qn(i).next(function(){return r})},wc.prototype.$r=function(e,n){var r=this;return _c(e.Lr,this.userId,n).next(function(t){return e.es(function(){r.Br(n.batchId)}),ua.forEach(t,function(t){return r.Vr.qr(e,t)})})},wc.prototype.Br=function(t){delete this.pr[t]},wc.prototype.Ur=function(e){var i=this;return this.br(e).next(function(t){if(!t)return ua.resolve();var t=IDBKeyRange.lowerBound(Gc.prefixForUser(i.userId)),r=[];return Ec(e)._i({range:t},function(t,e,n){t[0]===i.userId?(t=sc(t[1]),r.push(t)):n.done()}).next(function(){Cr(0===r.length)})})},wc.prototype.Qr=function(t,e){return bc(t,this.userId,e)},wc.prototype.Kr=function(t){var e=this;return Tc(t).get(this.userId).next(function(t){return t||new Bc(e.userId,-1,"")})},wc);function wc(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}function bc(t,o,e){var e=Gc.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Ec(t)._i({range:e,li:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function _c(t,e,n){var r=t.store(zc.store),i=t.store(Gc.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r._i({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Cr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Gc.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ua.qn(o).next(function(){return u})}function Ic(t){return Ih.Ys(t,zc.store)}function Ec(t){return Ih.Ys(t,Gc.store)}function Tc(t){return Ih.Ys(t,Bc.store)}var Nc,Ac=(Dc.prototype.jn=function(t,e,n){return kc(t).put(Pc(e),n)},Dc.prototype.Hn=function(t,e){t=kc(t),e=Pc(e);return t.delete(e)},Dc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Wr(e,t)})},Dc.prototype.Jn=function(t,e){var n=this;return kc(t).get(Pc(e)).next(function(t){return n.jr(t)})},Dc.prototype.Gr=function(t,e){var n=this;return kc(t).get(Pc(e)).next(function(t){var e=n.jr(t);return e?{zn:e,size:Rc(t)}:null})},Dc.prototype.getEntries=function(t,e){var n=this,r=Ui;return this.zr(t,e,function(t,e){e=n.jr(e);r=r.Tt(t,e)}).next(function(){return r})},Dc.prototype.Hr=function(t,e){var r=this,i=Ui,o=new Di(si.$);return this.zr(t,e,function(t,e){var n=r.jr(e);o=n?(i=i.Tt(t,n),o.Tt(t,Rc(e))):(i=i.Tt(t,null),o.Tt(t,0))}).next(function(){return{Jr:i,Yr:o}})},Dc.prototype.zr=function(t,e,i){if(e.W())return ua.resolve();var n=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),o=e.yt(),s=o.Ct();return kc(t)._i({range:n},function(t,e,n){for(var r=si.ct(t);s&&si.$(s,r)<0;)i(s,null),s=o.Ct();s&&s.isEqual(r)&&(i(s,e),s=o.Nt()?o.Ct():null),s?n.oi(s.path.H()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Nt()?o.Ct():null})},Dc.prototype.ws=function(t,r,e){var n,i=this,o=Fi,s=r.path.length+1,u={};return e.isEqual(ni.min())?(n=r.path.H(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.H(),e=hc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Qc.collectionReadTimeIndex),kc(t)._i(u,function(t,e,n){t.length===s&&(e=ac(i.serializer,e),r.path.j(e.key.path)?e instanceof su&&Au(r,e)&&(o=o.Tt(e.key,e)):n.done())}).next(function(){return o})},Dc.prototype.Xr=function(t){return new Oc(this,!!t&&t.Zr)},Dc.prototype.eo=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Dc.prototype.getMetadata=function(t){return xc(t).get(Yc.key).next(function(t){return Cr(!!t),t})},Dc.prototype.Wr=function(t,e){return xc(t).put(Yc.key,e)},Dc.prototype.jr=function(t){if(t){t=ac(this.serializer,t);return t instanceof uu&&t.version.isEqual(ni.min())?null:t}return null},Dc),Oc=(n(Sc,Nc=h),Sc.prototype.Zn=function(i){var o=this,s=[],u=0,a=new Vi(function(t,e){return Xr(t.J(),e.J())});return this.Qn.forEach(function(t,e){var n,r=o.so.get(t);e.zn?(n=cc(o.no.serializer,e.zn,o.Wn(t)),a=a.add(t.path.q()),e=Rc(n),u+=e-r,s.push(o.no.jn(i,t,n))):(u-=r,o.Zr?(r=cc(o.no.serializer,new uu(t,ni.min()),o.Wn(t)),s.push(o.no.jn(i,t,r))):s.push(o.no.Hn(i,t)))}),a.forEach(function(t){s.push(o.no.os.Dr(i,t))}),s.push(this.no.updateMetadata(i,u)),ua.qn(s)},Sc.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next(function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)})},Sc.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next(function(t){var e=t.Jr;return t.Yr.forEach(function(t,e){n.so.set(t,e)}),e})},Sc);function Sc(t,e){var n=this;return(n=Nc.call(this)||this).no=t,n.Zr=e,n.so=new sa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Dc(t,e){this.serializer=t,this.os=e}function xc(t){return Ih.Ys(t,Yc.store)}function kc(t){return Ih.Ys(t,Qc.store)}function Pc(t){return t.path.H()}function Rc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Rr();e=t.noDocument}return JSON.stringify(e).length}var Cc=(Fc.prototype.Dr=function(t,e){return this.io.add(e),ua.resolve()},Fc.prototype.As=function(t,e){return ua.resolve(this.io.getEntries(e))},Fc),Lc=(qc.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Vi(ri.$),t=!r.has(n);return this.index[e]=r.add(n),t},qc.prototype.has=function(t){var e=t.K(),t=t.q(),e=this.index[e];return e&&e.has(t)},qc.prototype.getEntries=function(t){return(this.index[t]||new Vi(ri.$)).H()},qc),Vc=(jc.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Cr(t<r&&0<=t&&r<=11);var o=new Ca("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Uc.store),(s=e).createObjectStore(Bc.store,{keyPath:Bc.keyPath}),s.createObjectStore(zc.store,{keyPath:zc.keyPath,autoIncrement:!0}).createIndex(zc.userMutationsIndex,zc.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Gc.store),th(e),e.createObjectStore(Qc.store));var s,u=ua.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Jc.store),s.deleteObjectStore(Xc.store),s.deleteObjectStore($c.store),th(e)),u=u.next(function(){return t=o.store($c.store),e=new $c(0,0,ni.min().M(),0),t.put($c.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(zc.store).ui().next(function(t){n.deleteObjectStore(zc.store),n.createObjectStore(zc.store,{keyPath:zc.keyPath,autoIncrement:!0}).createIndex(zc.userMutationsIndex,zc.userMutationsKeyPath,{unique:!0});var e=r.store(zc.store),t=t.map(function(t){return e.put(t)});return ua.qn(t)});var n,r})),u=u.next(function(){e.createObjectStore(eh.store,{keyPath:eh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Yc.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Qc.store)).createIndex(Qc.readTimeIndex,Qc.readTimeIndexPath,{unique:!1}),t.createIndex(Qc.collectionReadTimeIndex,Qc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(nh.store,{keyPath:nh.keyPath}),e.createObjectStore(rh.store,{keyPath:rh.keyPath})})),u},jc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Qc.store)._i(function(t,e){n+=Rc(e)}).next(function(){var t=new Yc(n);return e.store(Yc.store).put(Yc.key,t)})},jc.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Bc.store),i=n.store(zc.store);return t.ui().next(function(t){return ua.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ui(zc.userMutationsIndex,t).next(function(t){return ua.forEach(t,function(t){Cr(t.userId===e.userId);t=dc(r.serializer,t);return _c(n,e.userId,t).next(function(){})})})})})},jc.prototype.ensureSequenceNumbers=function(t){var o=t.store(Jc.store),e=t.store(Qc.store);return t.store($c.store).get($c.key).next(function(r){var i=[];return e._i(function(t,e){var n=new ri(t),t=[0,ic(n)];i.push(o.get(t).next(function(t){return t?ua.resolve():o.put(new Jc(0,ic(n),r.highestListenSequenceNumber))}))}).next(function(){return ua.qn(i)})})},jc.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Zc.store,{keyPath:Zc.keyPath});function r(t){if(i.add(t)){var e=t.K(),t=t.q();return n.put({collectionId:e,parent:ic(t)})}}var n=e.store(Zc.store),i=new Lc;return e.store(Qc.store)._i({li:!0},function(t,e){t=new ri(t);return r(t.q())}).next(function(){return e.store(Gc.store)._i({li:!0},function(t,e){t[0];var n=t[1],n=(t[2],sc(n));return r(n.q())})})},jc.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Xc.store);return r._i(function(t,e){e=yc(e),e=vc(n.serializer,e);return r.put(e)})},jc),Mc=function(t,e){this.seconds=t,this.nanoseconds=e},Uc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function jc(t){this.serializer=t}function qc(){this.index={}}function Fc(){this.io=new Lc}Uc.store="owner",Uc.key="owner";var Bc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Bc.store="mutationQueues",Bc.keyPath="userId";var zc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};zc.store="mutations",zc.keyPath="batchId",zc.userMutationsIndex="userMutationsIndex",zc.userMutationsKeyPath=["userId","batchId"];var Gc=(Kc.prefixForUser=function(t){return[t]},Kc.prefixForPath=function(t,e){return[t,ic(e)]},Kc.key=function(t,e,n){return[t,ic(e),n]},Kc);function Kc(){}Gc.store="documentMutations",Gc.PLACEHOLDER=new Gc;var Wc=function(t,e){this.path=t,this.readTime=e},Hc=function(t,e){this.path=t,this.version=e},Qc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Qc.store="remoteDocuments",Qc.readTimeIndex="readTimeIndex",Qc.readTimeIndexPath="readTime",Qc.collectionReadTimeIndex="collectionReadTimeIndex",Qc.collectionReadTimeIndexPath=["parentPath","readTime"];var Yc=function(t){this.byteSize=t};Yc.store="remoteDocumentGlobal",Yc.key="remoteDocumentGlobalKey";var Xc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Xc.store="targets",Xc.keyPath="targetId",Xc.queryTargetsIndexName="queryTargetsIndex",Xc.queryTargetsKeyPath=["canonicalId","targetId"];var Jc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Jc.store="targetDocuments",Jc.keyPath=["targetId","path"],Jc.documentTargetsIndex="documentTargetsIndex",Jc.documentTargetsKeyPath=["path","targetId"];var $c=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};$c.key="targetGlobalKey",$c.store="targetGlobal";var Zc=function(t,e){this.collectionId=t,this.parent=e};function th(t){t.createObjectStore(Jc.store,{keyPath:Jc.keyPath}).createIndex(Jc.documentTargetsIndex,Jc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Xc.store,{keyPath:Xc.keyPath}).createIndex(Xc.queryTargetsIndexName,Xc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore($c.store)}Zc.store="collectionParents",Zc.keyPath=["collectionId","parent"];var eh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};eh.store="clientMetadata",eh.keyPath="clientId";var nh=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};nh.store="bundles",nh.keyPath="bundleId";var rh=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};rh.store="namedQueries",rh.keyPath="name";var ih=s(s(s(s([Bc.store,zc.store,Gc.store,Qc.store,Xc.store,Uc.store,$c.store,Jc.store],[eh.store]),[Yc.store]),[Zc.store]),[nh.store,rh.store]),oh=(sh.prototype.ro=function(t,e){return uh(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:pc(t.createTime),version:t.version}})},sh.prototype.oo=function(t,e){return uh(t).put({bundleId:(e=e).id,createTime:lc(Fo(e.createTime)),version:e.version})},sh.prototype.co=function(t,e){return ah(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:gc(t.bundledQuery),readTime:pc(t.readTime)}})},sh.prototype.uo=function(t,e){return ah(t).put({name:(e=e).name,readTime:lc(Fo(e.readTime)),bundledQuery:e.bundledQuery})},sh);function sh(t){this.serializer=t}function uh(t){return Ih.Ys(t,nh.store)}function ah(t){return Ih.Ys(t,rh.store)}var ch=(hh.prototype.Dr=function(t,e){var n=this;if(this.ao.has(e))return ua.resolve();var r=e.K(),i=e.q();t.es(function(){n.ao.add(e)});i={collectionId:r,parent:ic(i)};return fh(t).put(i)},hh.prototype.As=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[$r(i),""],!1,!0);return fh(t).ui(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(sc(r.parent))}return o})},hh);function hh(){this.ao=new Lc}function fh(t){return Ih.Ys(t,Zc.store)}var lh=(yh.prototype.next=function(){return this.ho+=2,this.ho},yh.lo=function(){return new yh(0)},yh._o=function(){return new yh(-1)},yh),ph=(dh.prototype.fo=function(n){var r=this;return this.wo(n).next(function(t){var e=new lh(t.highestTargetId);return t.highestTargetId=e.next(),r.Eo(n,t).next(function(){return t.highestTargetId})})},dh.prototype.To=function(t){return this.wo(t).next(function(t){return ni.N(new ei(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},dh.prototype.Io=function(t){return this.wo(t).next(function(t){return t.highestListenSequenceNumber})},dh.prototype.mo=function(e,n,r){var i=this;return this.wo(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.M()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Eo(e,t)})},dh.prototype.Ao=function(e,n){var r=this;return this.Ro(e,n).next(function(){return r.wo(e).next(function(t){return t.targetCount+=1,r.Po(n,t),r.Eo(e,t)})})},dh.prototype.yo=function(t,e){return this.Ro(t,e)},dh.prototype.Vo=function(e,t){var n=this;return this.po(e,t.targetId).next(function(){return vh(e).delete(t.targetId)}).next(function(){return n.wo(e)}).next(function(t){return Cr(0<t.targetCount),--t.targetCount,n.Eo(e,t)})},dh.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return vh(n)._i(function(t,e){e=yc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Vo(n,e)))}).next(function(){return ua.qn(u)}).next(function(){return s})},dh.prototype.Ue=function(t,n){return vh(t)._i(function(t,e){e=yc(e);n(e)})},dh.prototype.wo=function(t){return gh(t).get($c.key).next(function(t){return Cr(null!==t),t})},dh.prototype.Eo=function(t,e){return gh(t).put($c.key,e)},dh.prototype.Ro=function(t,e){return vh(t).put(vc(this.serializer,e))},dh.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},dh.prototype.vo=function(t){return this.wo(t).next(function(t){return t.targetCount})},dh.prototype.bo=function(t,r){var e=mi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return vh(t)._i({range:e,index:Xc.queryTargetsIndexName},function(t,e,n){e=yc(e);wi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},dh.prototype.So=function(n,t,r){var i=this,o=[],s=mh(n);return t.forEach(function(t){var e=ic(t.path);o.push(s.put(new Jc(r,e))),o.push(i.Vr.Do(n,r,t))}),ua.qn(o)},dh.prototype.Co=function(n,t,r){var i=this,o=mh(n);return ua.forEach(t,function(t){var e=ic(t.path);return ua.qn([o.delete([r,e]),i.Vr.No(n,r,t)])})},dh.prototype.po=function(t,e){t=mh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},dh.prototype.xo=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=mh(t),r=Gi();return t._i({range:e,li:!0},function(t,e,n){t=sc(t[1]),t=new si(t);r=r.add(t)}).next(function(){return r})},dh.prototype.Qr=function(t,e){var e=ic(e.path),e=IDBKeyRange.bound([e],[$r(e)],!1,!0),i=0;return mh(t)._i({index:Jc.documentTargetsIndex,li:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},dh.prototype.Ze=function(t,e){return vh(t).get(e).next(function(t){return t?yc(t):null})},dh);function dh(t,e){this.Vr=t,this.serializer=e}function yh(t){this.ho=t}function vh(t){return Ih.Ys(t,Xc.store)}function gh(t){return Ih.Ys(t,$c.store)}function mh(t){return Ih.Ys(t,Jc.store)}var wh,bh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_h=(n(Th,wh=Ie),Th),Ih=(Eh.Ys=function(t,e){if(t instanceof _h)return Aa.Ys(t.Lr,e);throw Rr()},Eh.prototype.start=function(){var e=this;return this.Ho().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ur(Mr.FAILED_PRECONDITION,bh);return e.Jo(),e.Yo(),e.Xo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.jo.Io(t)})}).then(function(t){e.ko=new wa(t,e.Oo)}).then(function(){e.$o=!0}).catch(function(t){return e.Wo&&e.Wo.close(),Promise.reject(t)})},Eh.prototype.Zo=function(n){var t=this;return this.Qo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.lr?[2,n(e)]:[2]})})},n(this.isPrimary)},Eh.prototype.tc=function(n){var t=this;this.Wo.ti(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Eh.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Eh.prototype.Ho=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Ah(e).put(new eh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.nc(e).next(function(t){t||(n.isPrimary=!1,n.Cs.Mi(function(){return n.Qo(!1)}))})}).next(function(){return n.sc(e)}).next(function(t){return n.isPrimary&&!t?n.ic(e).next(function(){return!1}):!!t&&n.rc(e).next(function(){return!0})})}).catch(function(t){if(Ra(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Cs.Mi(function(){return n.Qo(t)}),n.isPrimary=t})},Eh.prototype.nc=function(t){var e=this;return Nh(t).get(Uc.key).next(function(t){return ua.resolve(e.oc(t))})},Eh.prototype.cc=function(t){return Ah(t).delete(this.clientId)},Eh.prototype.uc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Eh.Ys(t,eh.store);return r.ui().next(function(t){var e=o.hc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ua.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.zo)for(n=0,r=e;n<r.length;n++)i=r[n],this.zo.removeItem(this.lc(i.clientId));t.label=2;case 2:return[2]}})})},Eh.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,function(){return t.Ho().then(function(){return t.uc()}).then(function(){return t.Xo()})})},Eh.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},Eh.prototype.sc=function(e){var r=this;return this.Mo?ua.resolve(!0):Nh(e).get(Uc.key).next(function(t){if(null!==t&&r.ac(t.leaseTimestampMs,5e3)&&!r._c(t.ownerId)){if(r.oc(t)&&r.networkEnabled)return!0;if(!r.oc(t)){if(!t.allowTabSynchronization)throw new Ur(Mr.FAILED_PRECONDITION,bh);return!1}}return!(!r.networkEnabled||!r.inForeground)||Ah(e).ui().next(function(t){return void 0===r.hc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Eh.prototype.fc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Uc.store,eh.store],function(t){var e=new _h(t,wa.Ds);return n.ic(e).next(function(){return n.cc(e)})})];case 1:return t.sent(),this.Wo.close(),this.Tc(),[2]}})})},Eh.prototype.hc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)})},Eh.prototype.Ic=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Ah(t).ui().next(function(t){return e.hc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Eh.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),Eh.prototype.mc=function(t){return mc.vr(t,this.serializer,this.os,this.Vr)},Eh.prototype.Ac=function(){return this.jo},Eh.prototype.Rc=function(){return this.ss},Eh.prototype.Pc=function(){return this.os},Eh.prototype.gc=function(){return this.Go},Eh.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wo.runTransaction(e,t,ih,function(t){return o=new _h(t,i.ko?i.ko.next():wa.Ds),"readwrite-primary"===n?i.nc(o).next(function(t){return!!t||i.sc(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Cs.Mi(function(){return i.Qo(!1)}),new Ur(Mr.FAILED_PRECONDITION,va);return r(o)}).next(function(t){return i.rc(o).next(function(){return t})}):i.yc(o).next(function(){return r(o)})}).then(function(t){return o.ns(),t})},Eh.prototype.yc=function(t){var e=this;return Nh(t).get(Uc.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ur(Mr.FAILED_PRECONDITION,bh)})},Eh.prototype.rc=function(t){var e=new Uc(this.clientId,this.allowTabSynchronization,Date.now());return Nh(t).put(Uc.key,e)},Eh.Gs=function(){return Aa.Gs()},Eh.prototype.ic=function(t){var e=this,n=Nh(t);return n.get(Uc.key).next(function(t){return e.oc(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(Uc.key)):ua.resolve()})},Eh.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},Eh.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()})},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},Eh.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},Eh.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri(function(){return e.fc()})},this.window.addEventListener("unload",this.Lo))},Eh.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},Eh.prototype._c=function(t){try{var e=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Eh.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},Eh.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},Eh.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Eh);function Eh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Cs=i,this.window=o,this.document=s,this.Oo=a,this.Mo=c,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!Eh.Gs())throw new Ur(Mr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new Oh(this,r),this.Ko=e+"main",this.serializer=new uc(u),this.Wo=new Aa(this.Ko,11,new Vc(this.serializer)),this.jo=new ph(this.Vr,this.serializer),this.os=new ch,this.ss=(e=this.serializer,u=this.os,new Ac(e,u)),this.Go=new oh(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Th(t,e){var n=this;return(n=wh.call(this)||this).Lr=t,n.Fo=e,n}function Nh(t){return Ih.Ys(t,Uc.store)}function Ah(t){return Ih.Ys(t,eh.store)}var Oh=(Sh.prototype.Er=function(t){var n=this.Vc(t);return this.db.Ac().vo(t).next(function(e){return n.next(function(t){return e+t})})},Sh.prototype.Vc=function(t){var e=0;return this.Ir(t,function(t){e++}).next(function(){return e})},Sh.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},Sh.prototype.Ir=function(t,n){return this.vc(t,function(t,e){return n(e)})},Sh.prototype.Do=function(t,e,n){return Dh(t,n)},Sh.prototype.No=function(t,e,n){return Dh(t,n)},Sh.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},Sh.prototype.qr=Dh,Sh.prototype.bc=function(t,e){return r=e,i=!1,Tc(n=t).fi(function(t){return bc(n,t,r).next(function(t){return t&&(i=!0),ua.resolve(!t)})}).next(function(){return i});var n,r,i},Sh.prototype.Ar=function(n,r){var i=this,o=this.db.Rc().Xr(),s=[],u=0;return this.vc(n,function(e,t){t<=r&&(t=i.bc(n,e).next(function(t){if(!t)return u++,o.Jn(n,e).next(function(){return o.Hn(e),mh(n).delete([0,ic(e.path)])})}),s.push(t))}).next(function(){return ua.qn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Sh.prototype.removeTarget=function(t,e){e=e.dt(t.Fo);return this.db.Ac().yo(t,e)},Sh.prototype.Sc=Dh,Sh.prototype.vc=function(t,r){var i,t=mh(t),o=wa.Ds;return t._i({index:Jc.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==wa.Ds&&r(new si(sc(i)),o),o=e,i=t):o=wa.Ds}).next(function(){o!==wa.Ds&&r(new si(sc(i)),o)})},Sh.prototype.Pr=function(t){return this.db.Rc().eo(t)},Sh);function Sh(t,e){this.db=t,this.cr=new ec(this,e)}function Dh(t,e){return mh(t).put((t=t.Fo,new Jc(0,ic(e.path),t)))}function xh(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var kh=(Ph.prototype._r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Rr(t,n.Cc)})},Ph);function Ph(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Di(Xr),this.Nc=new sa(mi,wi),this.xc=ni.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new ga(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}function Rh(t,e,n,r){return new kh(t,e,n,r)}function Ch(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).rs,m=e.Oc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.rs.Mr(v).next(function(t){return g=t,n=e.persistence.mc(o),m=new ga(e.Fc,n,e.persistence.Pc()),n.Mr(v)}).next(function(t){for(var e=[],n=[],r=Gi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._s(v,r).next(function(t){return{kc:t,$c:e,Lc:n}})})})];case 1:return r=t.sent(),[2,(e.rs=n,e.Oc=m,e.Dc.Mc(e.Oc),r)]}})})}function Lh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Fc.Xr({Zr:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=ua.resolve(),n.forEach(function(n){u=u.next(function(){return o.Jn(r,n)}).next(function(t){var e=t,t=i.Sn.get(n);Cr(null!==t),(!e||e.version.F(t)<0)&&(e=s.yn(n,e,i))&&o.jn(e,i.bn)})}),u.next(function(){return e.rs.$r(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.rs.Ur(t)}).next(function(){return f.Oc._s(t,a)})})}function Vh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.jo.To(t)})}function Mh(t,o){var h=t,f=o.ft,l=h.Cc;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=h.Fc.Xr({Zr:!0});l=h.Cc;var u=[];o.re.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.jo.Co(s,t.de,e).next(function(){return h.jo.So(s,t._e,e)})),0<(i=t.resumeToken).ht()&&(n=o.wt(i,f).dt(s.Fo),l=l.Tt(e,n),r=o,i=t,Cr(0<(o=n).resumeToken.ht()),(0===r.resumeToken.ht()||3e8<=o.ft.O()-r.ft.O()||0<i._e.size+i.fe.size+i.de.size)&&u.push(h.jo.yo(s,n))))});var e,a,n,c,r,i=Ui;return o.ce.forEach(function(t,e){o.ue.has(t)&&u.push(h.persistence.Vr.Sc(s,t))}),u.push((e=s,a=t,n=o.ce,c=f,r=Gi(),n.forEach(function(t){return r=r.add(t)}),a.getEntries(e,r).next(function(i){var o=Ui;return n.forEach(function(t,e){var n=i.get(t),r=c;e instanceof uu&&e.version.isEqual(ni.min())?(a.Hn(t,r),o=o.Tt(t,e)):null==n||0<e.version.F(n.version)||0===e.version.F(n.version)&&n.hasPendingWrites?(a.jn(e,r),o=o.Tt(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o}).next(function(t){i=t}))),f.isEqual(ni.min())||(e=h.jo.To(s).next(function(t){return h.jo.mo(s,s.Fo,f)}),u.push(e)),ua.qn(u).next(function(){return t.apply(s)}).next(function(){return h.Oc.fs(s,i)})}).then(function(t){return h.Cc=l,t})}function Uh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.jo.bo(e,r).next(function(t){return t?(n=t,ua.resolve(n)):i.jo.fo(e).next(function(t){return n=new Ni(r,t,0,e.Fo),i.jo.Ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Cc.get(t.targetId);return(null===e||0<t.ft.F(e.ft))&&(i.Cc=i.Cc.Tt(t.targetId,t),i.Nc.set(r,t.targetId)),t})}function jh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Cc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Vr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ra(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Cc=e.Cc.remove(o),e.Nc.delete(n.target),[2]}})})}function qh(t,o,s){var u=t,a=ni.min(),c=Gi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=_u(o),(void 0!==(t=(i=t).Nc.get(r))?ua.resolve(i.Cc.get(t)):i.jo.bo(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.jo.xo(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Dc.ws(e,o,s?a:ni.min(),s?c:Gi())}).next(function(t){return{documents:t,Bc:c}});var t,n,r,i})}function Fh(t,e){var n=t,r=n.jo,t=n.Cc.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ze(t,e).next(function(t){return t?t.target:null})})}function Bh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Fc,n=t,t=s.xc,r=e,i=Ui,o=hc(t),t=kc(n),n=IDBKeyRange.lowerBound(o,!0),t._i({index:Qc.readTimeIndex,range:n},function(t,e){var n=ac(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime}).next(function(){return{qc:i,readTime:fc(o)}});var e,n,r,i,o}).then(function(t){var e=t.qc,t=t.readTime;return s.xc=t,e})}function zh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=kc(t),r=ni.min(),t._i({index:Qc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=fc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.xc=t})]})})}function Gh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Mr.FAILED_PRECONDITION||e.message!==va)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Kh(t,e,n,r,i){var o=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu(function(t){n.Ri(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return pf(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(4),[4,sf(e)];case 1:return t.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,of(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bu=new $h(n,r)}var Wh,Hh,Qh,Ee=(rf.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},rf.prototype.zc=function(){return 2===this.state},rf.prototype.start=function(){3!==this.state?this.auth():this.Hc()},rf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},rf.prototype.Jc=function(){this.state=0,this.Si.reset()},rf.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,function(){return t.Xc()}))},rf.prototype.Zc=function(t){this.tu(),this.stream.send(t)},rf.prototype.Xc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.zc()?[2,this.close(0)]:[2]})})},rf.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},rf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==e?this.Si.reset():n&&n.code===Mr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):n&&n.code===Mr.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.nu(n)];case 1:return t.sent(),[2]}})})},rf.prototype.eu=function(){},rf.prototype.auth=function(){var n=this;this.state=1;var t=this.su(this.Wc),e=this.Wc;this.Kc.getToken().then(function(t){n.Wc===e&&n.iu(t)},function(e){t(function(){var t=new Ur(Mr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ru(t)})})},rf.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu(function(){n(function(){return e.state=2,e.listener.cu()})}),this.stream.nu(function(t){n(function(){return e.ru(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},rf.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},rf.prototype.ru=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},rf.prototype.su=function(e){var n=this;return function(t){n.Cs.Ri(function(){return n.Wc===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},rf),Yh=(n(nf,Qh=Ee),nf.prototype.ou=function(t){return this.Qc.uu("Listen",t)},nf.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Rr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.tn?(Cr(void 0===o||"string"==typeof o),_i.fromBase64String(o||"")):(Cr(void 0===o||o instanceof Uint8Array),_i.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Mr.UNKNOWN:Si(s.code),new Ur(o,s.message||"")),r=new Zi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Ko(t,u.document.name),a=Fo(u.document.updateTime),s=new Js({mapValue:{fields:u.document.fields}}),a=new su(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Ji(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Ko(t,u.document),c=u.readTime?Fo(u.readTime):ni.min(),c=new uu(a,c),u=u.removedTargetIds||[];r=new Ji([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Ko(t,c.document),c=c.removedTargetIds||[];r=new Ji([],c,h,null)}else{if(!("filter"in e))return Rr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new Ei(e),h=h.targetId;r=new $i(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ni.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Fo(t.readTime):ni.min()}(t);return this.listener.au(e,t)},nf.prototype.hu=function(t){var e,n,r,i={};i.database=Qo(this.serializer),i.addTarget=(e=this.serializer,(r=bi(r=(n=t).target)?{documents:Zo(e,r)}:{query:ts(e,r)}).targetId=n.targetId,0<n.resumeToken.ht()?r.resumeToken=qo(e,n.resumeToken):0<n.ft.F(ni.min())&&(r.readTime=jo(e,n.ft.M())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o._t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Zc(i)},nf.prototype.lu=function(t){var e={};e.database=Qo(this.serializer),e.removeTarget=t,this.Zc(e)},nf),Xh=(n(ef,Hh=Ee),Object.defineProperty(ef.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),ef.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,Hh.prototype.start.call(this)},ef.prototype.eu=function(){this._u&&this.du([])},ef.prototype.ou=function(t){return this.Qc.uu("Write",t)},ef.prototype.onMessage=function(t){if(Cr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Cr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Fo(t.updateTime):Fo(e);n.isEqual(ni.min())&&(n=Fo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Ss(n,e)}(t,r)})):[]),n=Fo(t.commitTime);return this.listener.wu(n,e)}var n,r;return Cr(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},ef.prototype.Tu=function(){var t={};t.database=Qo(this.serializer),this.Zc(t)},ef.prototype.du=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Jo(e.serializer,t)})};this.Zc(t)},ef),Jh=(n(tf,Wh=function(){}),tf.prototype.mu=function(){if(this.Iu)throw new Ur(Mr.FAILED_PRECONDITION,"The client has already been terminated.")},tf.prototype.Au=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Au(e,n,r,t)}).catch(function(t){throw t.code===Mr.UNAUTHENTICATED&&i.credentials.m(),t})},tf.prototype.Ru=function(e,n,r){var i=this;return this.mu(),this.credentials.getToken().then(function(t){return i.Qc.Ru(e,n,r,t)}).catch(function(t){throw t.code===Mr.UNAUTHENTICATED&&i.credentials.m(),t})},tf.prototype.terminate=function(){this.Iu=!1},tf),$h=(Zh.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()}))},Zh.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,1<=this.gu&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},Zh.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},Zh.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},Zh.prototype.bu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(xr(t),this.Vu=!1):Dr("OnlineStateTracker",t)},Zh.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},Zh);function Zh(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}function tf(t,e,n){var r=this;return(r=Wh.call(this)||this).credentials=t,r.Qc=e,r.serializer=n,r.Iu=!1,r}function ef(t,e,n,r,i){var o=this;return(o=Hh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o._u=!1,o}function nf(t,e,n,r,i){var o=this;return(o=Qh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function rf(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new Na(t,e)}function of(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!pf(r))return[3,4];e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ku,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function uf(t,e){t.Ou.has(e.targetId)||(t.Ou.set(e.targetId,e),lf(t)?ff(t):If(t).zc()&&cf(t,e))}function af(t,e){var n=t,t=If(n);n.Ou.delete(e),t.zc()&&hf(n,e),0===n.Ou.size&&(t.zc()?t.Yc():pf(n)&&n.Bu.set("Unknown"))}function cf(t,e){t.qu.De(e.targetId),If(t).hu(e)}function hf(t,e){t.qu.De(e),If(t).lu(e)}function ff(e){e.qu=new eo({Xe:function(t){return e.xu.Xe(t)},Ze:function(t){return e.Ou.get(t)||null}}),If(e).start(),e.Bu.pu()}function lf(t){return pf(t)&&!If(t).Gc()&&0<t.Ou.size}function pf(t){return 0===t.Mu.size}function df(t){t.qu=void 0}function yf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Bu.set("Online"),!(u instanceof Zi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Ou.has(i)?[4,o.xu.Uu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Ou.delete(i),o.qu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,vf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ji?s.qu.$e(u):u instanceof $i?s.qu.je(u):s.qu.qe(u),a.isEqual(ni.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Vh(s.Cu)];case 8:return o=t.sent(),0<=a.F(o)?[4,(i=a,(e=(r=s).qu.He(i)).re.forEach(function(t,e){var n;0<t.resumeToken.ht()&&((n=r.Ou.get(e))&&r.Ou.set(e,n.wt(t.resumeToken,i)))}),e.oe.forEach(function(t){var e=r.Ou.get(t);e&&(r.Ou.set(t,e.wt(_i.lt,e.ft)),hf(r,t),e=new Ni(e.target,t,1,e.sequenceNumber),cf(r,e))}),r.xu.Qu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,vf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function vf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ra(r))throw r;return n.Mu.add(1),[4,sf(n)];case 1:return t.sent(),n.Bu.set("Offline"),i=i||function(){return Vh(n.Cu)},n.di.Mi(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Mu.delete(1),[4,of(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function gf(e,n){return n().catch(function(t){return vf(e,t,n)})}function mf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ef(i=a),s=0<i.Fu.length?i.Fu[i.Fu.length-1].batchId:-1,t.label=1;case 1:if(!(pf(i)&&i.Fu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Cu,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.rs.Fr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Fu.length&&o.Yc(),[3,7]):(s=u.batchId,function(t,e){t.Fu.push(e);t=Ef(t);t.zc()&&t.fu&&t.du(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,vf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return wf(i)&&bf(i),[2]}var e,n,r})})}function wf(t){return pf(t)&&!Ef(t).Gc()&&0<t.Fu.length}function bf(t){Ef(t).start()}function _f(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Mu.delete(2),[4,of(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Mu.add(2),[4,sf(e)]);case 3:t.sent(),e.Bu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function If(n){var t,e,r,i=this;return n.ju||(n.ju=(t=n.Nu,e=n.di,r={cu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Ou.forEach(function(t,e){cf(n,t)}),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return df(e),lf(e)?(e.Bu.Su(n),ff(e)):e.Bu.set("Unknown"),[2]})})}.bind(null,n),au:yf.bind(null,n)},t.mu(),new Yh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ju.Jc(),lf(n)?ff(n):n.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.ju.stop()];case 2:t.sent(),df(n),t.label=3;case 3:return[2]}})})})),n.ju}function Ef(n){var t,e,r,i=this;return n.Gu||(n.Gu=(t=n.Nu,e=n.di,r={cu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ef(e).Tu(),[2]})})}.bind(null,n),nu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ef(e).fu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Oi(n=i.code)&&n!==Mr.ABORTED?(e=r.Fu.shift(),Ef(r).Jc(),[4,gf(r,function(){return r.xu.Wu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,mf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return wf(e)&&bf(e),[2]}})})}.bind(null,n),Eu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ef(o),n=0,r=o.Fu;n<r.length;n++)i=r[n],e.du(i.mutations);return[2]})})}.bind(null,n),wu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Fu.shift(),n=oa.from(e,i,o),[4,gf(r,function(){return r.xu.Ku(n)})];case 1:return t.sent(),[4,mf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.mu(),new Xh(e,t.Qc,t.credentials,t.serializer,r)),n.ku.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Gu.Jc(),[4,mf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Gu.stop()];case 3:t.sent(),0<n.Fu.length&&(Dr("RemoteStore","Stopping write stream with "+n.Fu.length+" pending writes"),n.Fu=[]),t.label=4;case 4:return[2]}})})})),n.Gu}function Tf(){this.queries=new sa(Tu,Eu),this.onlineState="Unknown",this.Hu=new Set}var Nf=function(){this.zu=void 0,this.listeners=[]};function Af(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Nf),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ju(n)];case 2:return o.zu=t.sent(),[3,4];case 3:return o=t.sent(),o=Ha(o,"Initialization of query '"+Nu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Yu(e.onlineState),i.zu&&u.Xu(i.zu)&&Sf(e),[2]}})})}function Of(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Zu(n))]:[2]})})}function Sf(t){t.Hu.forEach(function(t){t.next()})}var Df=(Cf.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Qi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},Cf.prototype.onError=function(t){this.ta.error(t)},Cf.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},Cf.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},Cf.prototype.sa=function(t){if(0<t.docChanges.length)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},Cf.prototype.ra=function(t){t=Qi.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},Cf),xf=(Rf.prototype.W=function(){return this.ca.W()},Rf.prototype.Do=function(t,e){e=new kf(t,e);this.ca=this.ca.add(e),this.aa=this.aa.add(e)},Rf.prototype.la=function(t,e){var n=this;t.forEach(function(t){return n.Do(t,e)})},Rf.prototype.No=function(t,e){this._a(new kf(t,e))},Rf.prototype.fa=function(t,e){var n=this;t.forEach(function(t){return n.No(t,e)})},Rf.prototype.da=function(t){var e=this,n=new si(new ri([])),r=new kf(n,t),t=new kf(n,t+1),i=[];return this.aa.Kt([r,t],function(t){e._a(t),i.push(t.key)}),i},Rf.prototype.wa=function(){var e=this;this.ca.forEach(function(t){return e._a(t)})},Rf.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},Rf.prototype.Ea=function(t){var e=new si(new ri([])),n=new kf(e,t),t=new kf(e,t+1),r=Gi();return this.aa.Kt([n,t],function(t){r=r.add(t.key)}),r},Rf.prototype.Qr=function(t){var e=new kf(t,0),e=this.ca.jt(e);return null!==e&&t.isEqual(e.key)},Rf),kf=(Pf.ua=function(t,e){return si.$(t.key,e.key)||Xr(t.Ta,e.Ta)},Pf.ha=function(t,e){return Xr(t.Ta,e.Ta)||si.$(t.key,e.key)},Pf);function Pf(t,e){this.key=t,this.Ta=e}function Rf(){this.ca=new Vi(kf.ua),this.aa=new Vi(kf.ha)}function Cf(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}function Lf(t,e){return"firestore_clients_"+t+"_"+e}function Vf(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.u()&&(n+="_"+e.uid),n}function Mf(t,e){return"firestore_targets_"+t+"_"+e}var Uf=(ol.Ia=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ur(r.error.code,r.error.message)),i?new ol(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},ol.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},ol),jf=(il.Ia=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Ur(n.error.code,n.error.message)),r?new il(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},il.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},il),qf=(rl.Ia=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Ki,o=0;r&&o<n.activeTargetIds.length;++o)r=yi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new rl(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},rl),Ff=(nl.Ia=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new nl(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},nl),Bf=(el.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},el.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},el.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},el),zf=(tl.Gs=function(t){return!(!t||!t.localStorage)},tl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ga.Ic()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(Lf(this.persistenceKey,r)))&&(o=qf.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(s=this.storage.getItem(this.xa))&&(u=this.Ma(s))&&this.ka(u),a=0,c=this.va;a<c.length;a++)h=c[a],this.Va(h);return this.va=[],this.window.addEventListener("unload",function(){return f.fc()}),this.lr=!0,[2]}})})},tl.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},tl.prototype.$a=function(){return this.La(this.pa)},tl.prototype.Ba=function(n){var r=!1;return this.pa.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},tl.prototype.qa=function(t){this.Ua(t,"pending")},tl.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},tl.prototype.Wa=function(t){var e,n="not-current";return this.Ba(t)&&(!(e=this.storage.getItem(Mf(this.persistenceKey,t)))||(e=jf.Ia(t,e))&&(n=e.state)),this.ja.Aa(t),this.Oa(),n},tl.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},tl.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},tl.prototype.Ha=function(t){this.removeItem(Mf(this.persistenceKey,t))},tl.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},tl.prototype.Xa=function(t,e,n){var r=this;e.forEach(function(t){r.Ka(t)}),this.currentUser=t,n.forEach(function(t){r.qa(t)})},tl.prototype.Za=function(t){this.th(t)},tl.prototype.eh=function(){this.nh()},tl.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},tl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},tl.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},tl.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},tl.prototype.Va=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Dr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.ba)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.lr){if(null!==o.key)if(this.Da.test(o.key)){if(null==o.newValue)return e=this.sh(o.key),[2,this.ih(e,null)];if(e=this.rh(o.key,o.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(o.key)){if(null!==o.newValue&&(n=this.oh(o.key,o.newValue)))return[2,this.uh(n)]}else if(this.Na.test(o.key)){if(null!==o.newValue&&(r=this.ah(o.key,o.newValue)))return[2,this.hh(r)]}else if(o.key===this.xa){if(null!==o.newValue&&(i=this.Ma(o.newValue)))return[2,this.ka(i)]}else if(o.key===this.Sa)(i=function(t){var e=wa.Ds;if(null!=t)try{var n=JSON.parse(t);Cr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==wa.Ds&&this.ps(i);else if(o.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(o);return[2]})})})}},Object.defineProperty(tl.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),tl.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},tl.prototype.Ua=function(t,e,n){n=new Uf(this.currentUser,t,e,n),t=Vf(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ma())},tl.prototype.Ka=function(t){t=Vf(this.persistenceKey,this.currentUser,t);this.removeItem(t)},tl.prototype.th=function(t){t={clientId:this.Pa,onlineState:t};this.storage.setItem(this.xa,JSON.stringify(t))},tl.prototype.Ya=function(t,e,n){var r=Mf(this.persistenceKey,t),n=new jf(t,e,n);this.setItem(r,n.ma())},tl.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},tl.prototype.sh=function(t){t=this.Da.exec(t);return t?t[1]:null},tl.prototype.rh=function(t,e){t=this.sh(t);return qf.Ia(t,e)},tl.prototype.oh=function(t,e){var n=this.Ca.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return Uf.Ia(new Tr(n),t,e)},tl.prototype.ah=function(t,e){t=this.Na.exec(t),t=Number(t[1]);return jf.Ia(t,e)},tl.prototype.Ma=function(t){return Ff.Ia(t)},tl.prototype.uh=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ga._h(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},tl.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},tl.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ga.dh(s,u).then(function(){n.pa=r})},tl.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},tl.prototype.La=function(t){var n=Ki;return t.forEach(function(t,e){n=n.Gt(e.activeTargetIds)}),n},tl),Gf=(Zf.prototype.qa=function(t){},Zf.prototype.Qa=function(t,e,n){},Zf.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},Zf.prototype.Ja=function(t,e,n){this.Eh[t]=e},Zf.prototype.Ga=function(t){this.wh.Ra(t)},Zf.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},Zf.prototype.Ha=function(t){delete this.Eh[t]},Zf.prototype.$a=function(){return this.wh.activeTargetIds},Zf.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},Zf.prototype.start=function(){return this.wh=new Bf,Promise.resolve()},Zf.prototype.Xa=function(t,e,n){},Zf.prototype.Za=function(t){},Zf.prototype.fc=function(){},Zf.prototype.Ss=function(t){},Zf.prototype.eh=function(){},Zf),Kf=function(t){this.key=t},Wf=function(t){this.key=t},Hf=(Object.defineProperty($f.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),$f.prototype.gh=function(t,e){var s=this,u=e?e.yh:new Hi,a=(e||this).Rh,c=(e||this).ee,h=a,f=!1,l=yu(this.query)&&a.size===this.query.limit?a.last():null,p=vu(this.query)&&a.size===this.query.limit?a.first():null;if(t.Pt(function(t,e){var n=a.get(t),r=(r=e instanceof su?e:null)&&(Au(s.query,r)?r:null),i=!!n&&s.ee.has(n.key),o=!!r&&(r.an||s.ee.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Vh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.Ah(r,l)||p&&s.Ah(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),yu(this.query)||vu(this.query))for(;h.size>this.query.limit;){var n=yu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Rh:h,yh:u,ph:f,ee:c}},$f.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},$f.prototype.Zn=function(t,e,n){var o=this,r=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var i=t.yh.Zt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ah(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rr()}}var r,i}),this.bh(n);var s=e?this.Sh():[],n=0===this.mh.size&&this.le?1:0,e=n!==this.Ih;return this.Ih=n,0!==i.length||e?{snapshot:new Qi(this.query,t.Rh,r,i,t.ee,0==n,e,!1),Dh:s}:{Dh:s}},$f.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Hi,ee:this.ee,ph:!1},!1)):{Dh:[]}},$f.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},$f.prototype.bh=function(t){var e=this;t&&(t._e.forEach(function(t){return e.Th=e.Th.add(t)}),t.fe.forEach(function(t){}),t.de.forEach(function(t){return e.Th=e.Th.delete(t)}),this.le=t.le)},$f.prototype.Sh=function(){var e=this;if(!this.le)return[];var n=this.mh;this.mh=Gi(),this.Rh.forEach(function(t){e.Ch(t.key)&&(e.mh=e.mh.add(t.key))});var r=[];return n.forEach(function(t){e.mh.has(t)||r.push(new Wf(t))}),this.mh.forEach(function(t){n.has(t)||r.push(new Kf(t))}),r},$f.prototype.Nh=function(t){this.Th=t.Bc,this.mh=Gi();t=this.gh(t.documents);return this.Zn(t,!0)},$f.prototype.xh=function(){return Qi.ie(this.query,this.Rh,this.ee,0===this.Ih)},$f),Qf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Yf=function(t){this.key=t,this.Fh=!1},Xf=(Object.defineProperty(Jf.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),Jf);function Jf(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new sa(Tu,Eu),this.qh=new Map,this.Uh=[],this.Qh=new Di(si.$),this.Kh=new Map,this.Wh=new xf,this.jh={},this.Gh=new Map,this.zh=lh._o(),this.onlineState="Unknown",this.Hh=void 0}function $f(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=Gi(),this.ee=Gi(),this.Ah=Ou(t),this.Rh=new Wi(this.Ah)}function Zf(){this.wh=new Bf,this.Eh={},this.Pu=null,this.ps=null}function tl(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Di(Xr),this.lr=!1,this.va=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=Lf(this.persistenceKey,this.Pa),this.Sa="firestore_sequence_number_"+this.persistenceKey,this.pa=this.pa.Tt(this.Pa,new Bf),this.Da=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.xa="firestore_online_state_"+this.persistenceKey,this.Fa="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.ya)}function el(){this.activeTargetIds=Ki}function nl(t,e){this.clientId=t,this.onlineState=e}function rl(t,e){this.clientId=t,this.activeTargetIds=e}function il(t,e,n){this.targetId=t,this.state=e,this.error=n}function ol(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function sl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Yh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.gh(o)).ph?[4,qh(r.Cu,i.query,!1).then(function(t){t=t.documents;return i.view.gh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.re.get(i.targetId),n=i.view.Zn(e,r.Jh,n),[2,(vl(r,i.targetId,n.Dh),n.snapshot)]}})})}(i,t,e,n)},[4,qh(i.Cu,o,!0)];case 1:return n=t.sent(),r=new Hf(o,n.Bc),e=r.gh(n.documents),n=Xi.he(s,u&&"Offline"!==i.onlineState),n=r.Zn(e,i.Jh,n),vl(i,s,n.Dh),r=new Qf(o,s,r),[2,(i.Bh.set(o,r),i.qh.has(s)?i.qh.get(s).push(o):i.qh.set(s,[o]),n.snapshot)]}})})}function ul(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Nl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Cu,a=p,h=i,f=ei.now(),o=a.reduce(function(t,e){return t.add(e.key)},Gi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Oc._s(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Gs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof su?t.field(i.field):void 0,o=as(i.transform,o||null);null!=o&&(e=(null==e?new $s:e).set(i.field,o))}return e?e.hn():null}(o):null);null!=o&&e.push(new js(i.key,o,function s(t){var u=[];return lo(t.fields||{},function(t,e){var n=new oi([t]);if(Po(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Ns(u)}(o.proto.mapValue),Ds.exists(!0)))}return h.rs.Sr(u,f,e,a)})}).then(function(t){var e=t.vn(c);return{batchId:t.batchId,Qn:e}}))];case 2:return s=t.sent(),u.kh.qa(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.jh[e.currentUser.h()])||new Di(Xr)).Tt(n,r),e.jh[e.currentUser.h()]=i,[4,ml(u,s.Qn)];case 3:return t.sent(),[4,mf(u.Oh)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ha(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function al(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Mh(n.Cu,i)];case 2:return e=t.sent(),i.re.forEach(function(t,e){e=n.Kh.get(e);e&&(Cr(t._e.size+t.fe.size+t.de.size<=1),0<t._e.size?e.Fh=!0:0<t.fe.size?Cr(e.Fh):0<t.de.size&&(Cr(e.Fh),e.Fh=!1))}),[4,ml(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Gh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function cl(t,n,e){var r,t=t;(t.Jh&&0===e||!t.Jh&&1===e)&&(r=[],t.Bh.forEach(function(t,e){e=e.view.Yu(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Yu(i)&&(o=!0)}),o&&Sf(t)}(t.Mh,n),r.length&&t.Lh.au(r),t.onlineState=n,t.Jh&&t.kh.Za(n))}function hl(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Cu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.rs.Cr(e,r).next(function(t){return Cr(null!==t),n=t.keys(),i.rs.$r(e,t)}).next(function(){return i.rs.Ur(e)}).next(function(){return i.Oc._s(e,n)})}))];case 2:return o=t.sent(),pl(n,u,a),ll(n,u),n.kh.Qa(u,"rejected",a),[4,ml(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Gh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function fl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:pf((n=o).Oh)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Cu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.rs.Or(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Gh.get(r)||[]).push(s),n.Gh.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ha(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function ll(t,e){(t.Gh.get(e)||[]).forEach(function(t){t.resolve()}),t.Gh.delete(e)}function pl(t,e,n){var r=t,i=r.jh[r.currentUser.h()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i)}function dl(e,t,n){void 0===n&&(n=null),e.kh.Ga(t);for(var r=0,i=e.qh.get(t);r<i.length;r++){var o=i[r];e.Bh.delete(o),n&&e.Lh.Xh(o,n)}e.qh.delete(t),e.Jh&&e.Wh.da(t).forEach(function(t){e.Wh.Qr(t)||yl(e,t)})}function yl(t,e){var n=t.Qh.get(e);null!==n&&(af(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),gl(t))}function vl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Kf?(t.Wh.Do(o.key,e),function(t,e){e=e.key;t.Qh.get(e)||(Dr("SyncEngine","New document in limbo: "+e),t.Uh.push(e),gl(t))}(t,o)):o instanceof Wf?(Dr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||yl(t,o.key)):Rr()}}function gl(t){for(;0<t.Uh.length&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new Yf(e)),t.Qh=t.Qh.Tt(e,n),uf(t.Oh,new Ni(_u(du(e.path)),n,2,wa.Ds))}}function ml(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Bh.W()?[3,3]:(n.Bh.forEach(function(t,e){o.push(n.Yh(e,s,u).then(function(t){t&&(n.Jh&&n.kh.Ja(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ma.Vs(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Lh.au(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ua.forEach(c,function(e){return ua.forEach(e.gs,function(t){return r.persistence.Vr.Do(n,e.targetId,t)}).next(function(){return ua.forEach(e.ys,function(t){return r.persistence.Vr.No(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Cc.get(o),u=s.ft,u=s.Et(u),r.Cc=r.Cc.Tt(o,u));return[2]}})})}(n.Cu,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function wl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Dr("SyncEngine","User change. New user:",o.h()),[4,Ch(n.Cu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Gh.forEach(function(t){t.forEach(function(t){t.reject(new Ur(Mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Gh.clear(),n.kh.Xa(o,r.$c,r.Lc),[4,ml(n,r.kc)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function bl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Cu,n=a,i=(r=e).rs,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Nr(e,n).next(function(t){return t?r.Oc._s(e,t):ua.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,mf(o.Oh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(pl(o,a,h||null),ll(o,a),o.Cu.rs.Br(a)):Rr(),t.label=4;case 4:return[4,ml(o,s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function _l(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Tl(r=h),Nl(r),!0!==f||!0===r.Hh?[3,3]:(e=r.kh.$a(),[4,Il(r,e.H())]);case 1:return i=t.sent(),r.Hh=!0,[4,_f(r.Oh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],uf(r.Oh,u);return[3,7];case 3:return!1!==f||!1===r.Hh?[3,7]:(a=[],c=Promise.resolve(),r.qh.forEach(function(t,e){r.kh.za(e)?a.push(e):c=c.then(function(){return dl(r,e),jh(r.Cu,e,!0)}),af(r.Oh,e)}),[4,c]);case 4:return t.sent(),[4,Il(r,a)];case 5:return t.sent(),(n=r).Kh.forEach(function(t,e){af(n.Oh,e)}),n.Wh.wa(),n.Kh=new Map,n.Qh=new Di(si.$),r.Hh=!1,[4,_f(r.Oh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Il(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.qh.get(s))&&0!==a.length?[4,Uh(e.Cu,_u(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Bh.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,qh((e=r).Cu,i.query,!0)];case 1:return n=t.sent(),n=i.view.Nh(n),[2,(e.Jh&&vl(e,i.targetId,n.Dh),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Fh(e.Cu,s)];case 8:return l=t.sent(),[4,Uh(e.Cu,l)];case 9:return u=t.sent(),[4,sl(e,El(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Lh.au(r),n)]}})})}function El(t){return pu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Tl(t){return t.Oh.xu.Qu=al.bind(null,t),t.Oh.xu.Xe=function(t,e){var n=t;if((t=n.Kh.get(e))&&t.Fh)return Gi().add(t.key);var r=Gi();if(!(e=n.qh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Bh.get(s),r=r.Gt(s.view.Ph);return r}.bind(null,t),t.Oh.xu.Uu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).kh.Ja(s,"rejected",u),i=e.Kh.get(s),(n=i&&i.key)?(r=(r=new Di(si.$)).Tt(n,new uu(n,ni.min())),i=Gi().add(n),i=new Yi(ni.min(),new Map,new Vi(Xr),r,i),[4,al(e,i)]):[3,2];case 1:return t.sent(),e.Qh=e.Qh.remove(n),e.Kh.delete(s),gl(e),[3,4];case 2:return[4,jh(e.Cu,s,!1).then(function(){return dl(e,s,u)}).catch(Gh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Lh.au=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.queries.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Xu(s)&&(r=!0);u.zu=s}}r&&Sf(n)}.bind(null,t.Mh),t.Lh.Xh=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Mh),t}function Nl(t){return t.Oh.xu.Ku=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Lh(e.Cu,o)];case 2:return r=t.sent(),pl(e,n,null),ll(e,n),e.kh.Qa(n,"acknowledged"),[4,ml(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Gh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.Oh.xu.Wu=hl.bind(null,t),t}var Al,Ol,Sl,Dl,xl,kl=(yp.prototype.Mc=function(t){this.Zh=t},yp.prototype.ws=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.Tn.length||1===r.Tn.length&&r.Tn[0].field.tt())||i.isEqual(ni.min())?this.tl(e,r):this.Zh._s(e,o).next(function(t){var n=s.el(r,t);return(yu(r)||vu(r))&&s.ph(r.limitType,n,o,i)?s.tl(e,r):(Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Nu(r)),s.Zh.ws(e,r,i).next(function(e){return n.forEach(function(t){e=e.Tt(t.key,t)}),e}))})},yp.prototype.el=function(n,t){var r=new Vi(Ou(n));return t.forEach(function(t,e){e instanceof su&&Au(n,e)&&(r=r.add(e))}),r},yp.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.F(r))},yp.prototype.tl=function(t,e){return Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Nu(e)),this.Zh.ws(t,e,ni.min())},yp),Pl=(dp.prototype.br=function(t){return ua.resolve(0===this.rs.length)},dp.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,0<this.rs.length&&this.rs[this.rs.length-1];n=new ia(i,e,n,r);this.rs.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.sl=this.sl.add(new kf(u.key,i)),this.os.Dr(t,u.key.path.q())}return ua.resolve(n)},dp.prototype.Cr=function(t,e){return ua.resolve(this.il(e))},dp.prototype.Fr=function(t,e){e+=1,e=this.rl(e),e=e<0?0:e;return ua.resolve(this.rs.length>e?this.rs[e]:null)},dp.prototype.Or=function(){return ua.resolve(0===this.rs.length?-1:this.nl-1)},dp.prototype.Mr=function(t){return ua.resolve(this.rs.slice())},dp.prototype.us=function(t,e){var n=this,r=new kf(e,0),e=new kf(e,Number.POSITIVE_INFINITY),i=[];return this.sl.Kt([r,e],function(t){t=n.il(t.Ta);i.push(t)}),ua.resolve(i)},dp.prototype.ds=function(t,e){var n=this,r=new Vi(Xr);return e.forEach(function(t){var e=new kf(t,0),t=new kf(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,t],function(t){r=r.add(t.Ta)})}),ua.resolve(this.ol(r))},dp.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,e=n;si.ot(e)||(e=e.child(""));var e=new kf(new si(e),0),i=new Vi(Xr);return this.sl.Wt(function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(i=i.add(t.Ta)),!0)},e),ua.resolve(this.ol(i))},dp.prototype.ol=function(t){var e=this,n=[];return t.forEach(function(t){t=e.il(t);null!==t&&n.push(t)}),n},dp.prototype.$r=function(n,r){var i=this;Cr(0===this.cl(r.batchId,"removed")),this.rs.shift();var o=this.sl;return ua.forEach(r.mutations,function(t){var e=new kf(t.key,r.batchId);return o=o.delete(e),i.Vr.qr(n,t.key)}).next(function(){i.sl=o})},dp.prototype.Br=function(t){},dp.prototype.Qr=function(t,e){var n=new kf(e,0),n=this.sl.jt(n);return ua.resolve(e.isEqual(n&&n.key))},dp.prototype.Ur=function(t){return this.rs.length,ua.resolve()},dp.prototype.cl=function(t,e){return this.rl(t)},dp.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},dp.prototype.il=function(t){t=this.rl(t);return t<0||t>=this.rs.length?null:this.rs[t]},dp),Rl=(pp.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:i,readTime:n}),this.size+=i-o,this.os.Dr(t,r.path.q())},pp.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},pp.prototype.Jn=function(t,e){e=this.docs.get(e);return ua.resolve(e?e.zn:null)},pp.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)}),ua.resolve(r)},pp.prototype.ws=function(t,e,n){for(var r=Fi,i=new si(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.key,a=s.value,s=a.zn,a=a.readTime;if(!e.path.j(u.path))break;a.F(n)<=0||s instanceof su&&Au(e,s)&&(r=r.Tt(s.key,s))}return ua.resolve(r)},pp.prototype.al=function(t,e){return ua.forEach(this.docs,function(t){return e(t)})},pp.prototype.Xr=function(t){return new Cl(this)},pp.prototype.eo=function(t){return ua.resolve(this.size)},pp),Cl=(n(lp,xl=h),lp.prototype.Zn=function(n){var r=this,i=[];return this.Qn.forEach(function(t,e){e&&e.zn?i.push(r.no.jn(n,e.zn,r.Wn(t))):r.no.Hn(t)}),ua.qn(i)},lp.prototype.Yn=function(t,e){return this.no.Jn(t,e)},lp.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},lp),Ll=(fp.prototype.Ue=function(t,n){return this.hl.forEach(function(t,e){return n(e)}),ua.resolve()},fp.prototype.To=function(t){return ua.resolve(this.lastRemoteSnapshotVersion)},fp.prototype.Io=function(t){return ua.resolve(this.ll)},fp.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),ua.resolve(this.highestTargetId)},fp.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),ua.resolve()},fp.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new lh(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},fp.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,ua.resolve()},fp.prototype.yo=function(t,e){return this.Ro(e),ua.resolve()},fp.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),--this.targetCount,ua.resolve()},fp.prototype.mr=function(n,r,i){var o=this,s=0,u=[];return this.hl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.hl.delete(t),u.push(o.po(n,e.targetId)),s++)}),ua.qn(u).next(function(){return s})},fp.prototype.vo=function(t){return ua.resolve(this.targetCount)},fp.prototype.bo=function(t,e){e=this.hl.get(e)||null;return ua.resolve(e)},fp.prototype.So=function(t,e,n){return this._l.la(e,n),ua.resolve()},fp.prototype.Co=function(e,t,n){this._l.fa(t,n);var r=this.persistence.Vr,i=[];return r&&t.forEach(function(t){i.push(r.qr(e,t))}),ua.qn(i)},fp.prototype.po=function(t,e){return this._l.da(e),ua.resolve()},fp.prototype.xo=function(t,e){e=this._l.Ea(e);return ua.resolve(e)},fp.prototype.Qr=function(t,e){return ua.resolve(this._l.Qr(e))},fp),Vl=(hp.prototype.ro=function(t,e){return ua.resolve(this.dl.get(e))},hp.prototype.oo=function(t,e){return this.dl.set(e.id,{id:e.id,version:e.version,createTime:Fo(e.createTime)}),ua.resolve()},hp.prototype.co=function(t,e){return ua.resolve(this.wl.get(e))},hp.prototype.uo=function(t,e){return this.wl.set(e.name,{name:(e=e).name,query:gc(e.bundledQuery),readTime:Fo(e.readTime)}),ua.resolve()},hp),Ml=(cp.prototype.start=function(){return Promise.resolve()},cp.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(cp.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),cp.prototype.tc=function(){},cp.prototype.ec=function(){},cp.prototype.Pc=function(){return this.os},cp.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new Pl(this.os,this.Vr),this.El[t.h()]=e),e},cp.prototype.Ac=function(){return this.jo},cp.prototype.Rc=function(){return this.ss},cp.prototype.gc=function(){return this.Go},cp.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Ul(this.ko.next());return this.Vr.Il(),n(i).next(function(t){return r.Vr.ml(i).next(function(){return t})}).Ln().then(function(t){return i.ns(),t})},cp.prototype.Al=function(e,n){return ua.Un(Object.values(this.El).map(function(t){return function(){return t.Qr(e,n)}}))},cp),Ul=(n(ap,Dl=Ie),ap),jl=(up.gl=function(t){return new up(t)},Object.defineProperty(up.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Rr()},enumerable:!1,configurable:!0}),up.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),ua.resolve()},up.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),ua.resolve()},up.prototype.qr=function(t,e){return this.yl.add(e.toString()),ua.resolve()},up.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach(function(t){return n.yl.add(t.toString())});var r=this.persistence.Ac();return r.xo(t,e.targetId).next(function(t){t.forEach(function(t){return n.yl.add(t.toString())})}).next(function(){return r.Vo(t,e)})},up.prototype.Il=function(){this.Pl=new Set},up.prototype.ml=function(n){var r=this,i=this.persistence.Rc().Xr();return ua.forEach(this.yl,function(t){var e=si.st(t);return r.Vl(n,e).next(function(t){t||i.Hn(e)})}).next(function(){return r.Pl=null,i.apply(n)})},up.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next(function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())})},up.prototype.Tl=function(t){return 0},up.prototype.Vl=function(t,e){var n=this;return ua.Un([function(){return ua.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},up),ql=(sp.prototype.cu=function(t){this.bl=t},sp.prototype.nu=function(t){this.Sl=t},sp.prototype.onMessage=function(t){this.Dl=t},sp.prototype.close=function(){this.vl()},sp.prototype.send=function(t){this.pl(t)},sp.prototype.Cl=function(){this.bl()},sp.prototype.Nl=function(t){this.Sl(t)},sp.prototype.xl=function(t){this.Dl(t)},sp),Fl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bl=(op.prototype.Au=function(e,t,n,r){var i=this.kl(e,t);Dr("RestConnection","Sending: ",i,n);t={};return this.$l(t,r),this.Ll(e,i,t,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw kr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},op.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},op.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},op.prototype.kl=function(t,e){t=Fl[t];return this.Ol+"/v1/"+e+":"+t},n(ip,Sl=op),ip.prototype.Ll=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Dr("Connection",'RPC "'+o+'" timed out'),r(new Ur(Mr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Dr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Mr).indexOf(e)?e:Mr.UNKNOWN,r(new Ur(e,t.message))):r(new Ur(Mr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ur(Mr.UNAVAILABLE,"Connection failed."));break;default:Rr()}}finally{Dr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},ip.prototype.uu=function(t,e){var n,r=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new fr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Dr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new ql({pl:function(t){u?Dr("Connection","Not sending because WebChannel is closed:",t):(s||(Dr("Connection","Opening WebChannel transport."),o.open(),s=!0),Dr("Connection","WebChannel sending:",t),o.send(t))},vl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Dr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Dr("Connection","WebChannel transport closed"),a.Nl())}),t(mr.EventType.ERROR,function(t){u||(u=!0,kr("Connection","WebChannel transport errored:",t),a.Nl(new Ur(Mr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Cr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Dr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ti[r];if(void 0!==t)return Si(t)}(),i=n.message,void 0===t&&(t=Mr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Nl(new Ur(t,i)),o.close()):(Dr("Connection","WebChannel received:",e),a.xl(e)))}),setTimeout(function(){a.Cl()},0),a},ip),zl=(rp.prototype.Lu=function(t){this.Kl.push(t)},rp.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},rp.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},rp.prototype.ql=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},rp.prototype.Ql=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},rp.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},rp),Gl=(np.prototype.Lu=function(t){},np.prototype.fc=function(){},np),Kl=(ep.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=da(e.Fl.t),this.kh=this.jl(e),this.persistence=this.Gl(e),[4,this.persistence.start()];case 1:return t.sent(),this.zl=this.Hl(e),this.Cu=this.Jl(e),[2]}})})},ep.prototype.Hl=function(t){return null},ep.prototype.Jl=function(t){return Rh(this.persistence,new kl,t.Yl,this.serializer)},ep.prototype.Gl=function(t){return new Ml(jl.gl,this.serializer)},ep.prototype.jl=function(t){return new Gf},ep.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}})})},ep),Wl=(n(tp,Ol=Kl),tp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ol.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,zh(this.Cu)];case 2:return t.sent(),[4,this.Xl.initialize(this,e)];case 3:return t.sent(),[4,Nl(this.Xl.ga)];case 4:return t.sent(),[4,mf(this.Xl.Oh)];case 5:return t.sent(),[2]}})})},tp.prototype.Jl=function(t){return Rh(this.persistence,new kl,t.Yl,this.serializer)},tp.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new tc(e,t.di)},tp.prototype.Gl=function(t){var e=xh(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Ja.er(this.cacheSizeBytes):Ja.ir;return new Ih(this.synchronizeTabs,e,t.clientId,n,t.di,Fa(),Ba(),this.serializer,this.kh,!!this.forceOwnership)},tp.prototype.jl=function(t){return new Gf},tp),Hl=(n(Zl,Al=Wl),Zl.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Al.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Xl.ga,this.kh instanceof zf?(this.kh.ga={_h:bl.bind(null,e),fh:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).Hh?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.qh.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Bh(e.Cu)];case 3:return n=t.sent(),r=Yi.ae(o,"current"===s),[4,ml(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,jh(e.Cu,o,!0)];case 6:return t.sent(),dl(e,o,u),[3,8];case 7:Rr(),t.label=8;case 8:return[2]}})})}.bind(null,e),dh:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Tl(c)).Hh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.qh.has(r)?(Dr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Fh(n.Cu,r)]):[3,6];case 2:return i=t.sent(),[4,Uh(n.Cu,i)];case 3:return o=t.sent(),[4,sl(n,El(i),o.targetId,!1)];case 4:t.sent(),uf(n.Oh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.qh.has(e)?[4,jh(n.Cu,e,!1).then(function(){af(n.Oh,e),dl(n,e)}).catch(Gh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Ic:function(t){return t.Cu.persistence.Ic()}.bind(null,e),lh:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Bh((e=n).Cu).then(function(t){return ml(e,t)})]})})}.bind(null,e)},[4,this.kh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Zo(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,_l(this.Xl.ga,e)];case 1:return t.sent(),this.zl&&(e&&!this.zl.lr?this.zl.start(this.Cu):e||this.zl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Zl.prototype.jl=function(t){var e=Fa();if(!zf.Gs(e))throw new Ur(Mr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=xh(t.Fl.t,t.Fl.persistenceKey);return new zf(e,t.di,n,t.clientId,t.Yl)},Zl),Ql=($l.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Cu?[3,2]:(this.Cu=n.Cu,this.kh=n.kh,this.Nu=this.Zl(r),this.Oh=this.t_(r),this.Mh=this.e_(r),this.ga=this.n_(r,!n.synchronizeTabs),this.kh.Pu=function(t){return cl(e.ga,t,1)},this.Oh.xu.s_=wl.bind(null,this.ga),[4,_f(this.Oh,this.ga.Jh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},$l.prototype.e_=function(t){return new Tf},$l.prototype.Zl=function(t){var e=da(t.Fl.t),n=(n=t.Fl,new Bl(n));return t=t.credentials,new Jh(t,n,e)},$l.prototype.t_=function(t){var e=this,n=this.Cu,r=this.Nu,i=t.di,o=function(t){return cl(e.ga,t,0)},t=new(zl.Gs()?zl:Gl);return new Kh(n,r,i,o,t)},$l.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){o=new Xf(t,e,n,r,i,o);return s&&(o.Hh=!0),o}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},$l.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Dr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,sf(e)];case 1:return t.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}})})}(this.Oh)},$l),Yl=(Jl.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},Jl.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Jl.prototype.r_=function(){this.muted=!0},Jl.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Jl),Xl=function(t){this.o_=t};function Jl(t){this.observer=t,this.muted=!1}function $l(){}function Zl(t,e){var n=this;return(n=Al.call(this,t,e,!1)||this).Xl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function tp(t,e,n){var r=this;return(r=Ol.call(this)||this).Xl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function ep(){this.synchronizeTabs=!1}function np(){}function rp(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}function ip(t){var e=this;return(e=Sl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function op(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function sp(t){this.pl=t.pl,this.vl=t.vl}function up(t){this.persistence=t,this.Rl=new xf,this.Pl=null}function ap(t){var e=this;return(e=Dl.call(this)||this).Fo=t,e}function cp(t,e){var n=this;this.El={},this.ko=new wa(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new Ll(this),this.os=new Cc,this.ss=(t=this.os,new Rl(t,function(t){return n.Vr.Tl(t)})),this.serializer=new uc(e),this.Go=new Vl(this.serializer)}function hp(t){this.serializer=t,this.dl=new Map,this.wl=new Map}function fp(t){this.persistence=t,this.hl=new sa(mi,wi),this.lastRemoteSnapshotVersion=ni.min(),this.highestTargetId=0,this.ll=0,this._l=new xf,this.targetCount=0,this.fl=lh.lo()}function lp(t){var e=this;return(e=xl.call(this)||this).no=t,e}function pp(t,e){this.os=t,this.ul=e,this.docs=new Di(si.$),this.size=0}function dp(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new Vi(kf.ua)}function yp(){}function vp(t,e,n){if(!n)throw new Ur(Mr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function gp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function mp(t,e,n,r){if(!0===e&&!0===r)throw new Ur(Mr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function wp(t){if(!si.ot(t))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function bp(t){if(si.ot(t))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function _p(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Rr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ip(t,e){if(t instanceof Xl&&(t=t.o_),t instanceof e)return t;if(e.name===t.constructor.name)throw new Ur(Mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=_p(t);throw new Ur(Mr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Ep(t,e){if(e<=0)throw new Ur(Mr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Tp,Np=function(t){this.c_=t},Ap=(n(Op,Tp=Np),Op.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},Op.prototype.isEqual=function(t){return t instanceof Op},Op);function Op(){return null!==Tp&&Tp.apply(this,arguments)||this}function Sp(t,e,n){return new Iy({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var Dp,xp,kp,Pp,Rp=(n(Yp,Pp=Np),Yp.prototype.u_=function(t){return new As(t.path,new fs)},Yp.prototype.isEqual=function(t){return t instanceof Yp},Yp),Cp=(n(Qp,kp=Np),Qp.prototype.u_=function(t){var e=Sp(this,t,!0),n=this.f_.map(function(t){return xy(t,e)}),n=new ls(n);return new As(t.path,n)},Qp.prototype.isEqual=function(t){return this===t},Qp),Lp=(n(Hp,xp=Np),Hp.prototype.u_=function(t){var e=Sp(this,t,!0),n=this.f_.map(function(t){return xy(t,e)}),n=new gs(n);return new As(t.path,n)},Hp.prototype.isEqual=function(t){return this===t},Hp),Vp=(n(Wp,Dp=Np),Wp.prototype.u_=function(t){var e=new _s(t.serializer,Uo(t.serializer,this.d_));return new As(t.path,e)},Wp.prototype.isEqual=function(t){return this===t},Wp),Mp=(Object.defineProperty(Kp.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(Kp.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),Kp.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},Kp.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},Kp.prototype.C=function(t){return Xr(this.w_,t.w_)||Xr(this.E_,t.E_)},Kp),Up=(Gp.fromBase64String=function(t){try{return new Gp(_i.fromBase64String(t))}catch(t){throw new Ur(Mr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Gp.fromUint8Array=function(t){return new Gp(_i.fromUint8Array(t))},Gp.prototype.toBase64=function(){return this.T_.toBase64()},Gp.prototype.toUint8Array=function(){return this.T_.toUint8Array()},Gp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Gp.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},Gp),jp=new Map,qp=(zp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},zp),Fp=(Object.defineProperty(Bp.prototype,"app",{get:function(){if(!this.g_)throw new Ur(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),Bp.prototype.v_=function(t){if(this.A_)throw new Ur(Mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new qp(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new jr;switch(t.type){case"gapi":var e=t.client;return Cr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Br(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ur(Mr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Bp.prototype.b_=function(){return this.m_},Bp.prototype.S_=function(){return this.A_=!0,this.m_},Bp.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},Bp.prototype.D_=function(){return t=this,(e=jp.get(t))&&(Dr("ComponentProvider","Removing Datastore"),jp.delete(t),e.terminate()),Promise.resolve();var t,e},Bp);function Bp(t,e){this.I_="(lite)",this.m_=new qp({}),this.A_=!1,t instanceof Er?(this.R_=t,this.P_=new jr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ur(Mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Er(t.options.projectId)}(t),this.P_=new qr(e))}function zp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ur(Mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ur(Mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,mp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Gp(t){this.T_=t}function Kp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Ur(Mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ur(Mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}function Wp(t,e){var n=this;return(n=Dp.call(this,t)||this).d_=e,n}function Hp(t,e){var n=this;return(n=xp.call(this,t)||this).f_=e,n}function Qp(t,e){var n=this;return(n=kp.call(this,t)||this).f_=e,n}function Yp(){return null!==Pp&&Pp.apply(this,arguments)||this}function Xp(){if("undefined"==typeof Uint8Array)throw new Ur(Mr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Jp(){if("undefined"==typeof atob)throw new Ur(Mr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var $p,Zp,td,ed=(n(cd,td=Up),cd.fromBase64String=function(t){Jp();try{return new cd(_i.fromBase64String(t))}catch(t){throw new Ur(Mr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},cd.fromUint8Array=function(t){return Xp(),new cd(_i.fromUint8Array(t))},cd.prototype.toBase64=function(){return Jp(),td.prototype.toBase64.call(this)},cd.prototype.toUint8Array=function(){return Xp(),td.prototype.toUint8Array.call(this)},cd.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},cd),h=(ad.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),mo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return No(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(Ao(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Rr()}},ad.prototype.L_=function(t,n){var r=this,i={};return lo(t.fields||{},function(t,e){i[t]=r.C_(e,n)}),i},ad.prototype.M_=function(t){return new Mp(No(t.latitude),No(t.longitude))},ad.prototype.k_=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.C_(t,e)})},ad.prototype.x_=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return yo(e)?t(e):e}(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(vo(t));default:return null}},ad.prototype.N_=function(t){t=To(t);return new ei(t.seconds,t.nanos)},ad.prototype.B_=function(t,e){var n=ri.Y(t);Cr(us(n));t=new Er(n.get(1),n.get(3)),n=new si(n.B(5));return t.isEqual(e)||xr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},ad),nd=(n(ud,Zp=h),ud.prototype.F_=function(t){return new ed(t)},ud.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return _v.q_(t,this.firestore,null)},ud),rd=(Object.defineProperty(sd.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(sd.prototype,"ref",{get:function(){return new Cd(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),sd.prototype.exists=function(){return null!==this.W_},sd.prototype.data=function(){if(this.W_){if(this.j_){var t=new id(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},sd.prototype.get=function(t){if(this.W_){t=this.W_.data().field(hd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t)}},sd),id=(n(od,$p=rd),od.prototype.data=function(){return $p.prototype.data.call(this)},od);function od(){return null!==$p&&$p.apply(this,arguments)||this}function sd(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}function ud(t){var e=this;return(e=Zp.call(this)||this).firestore=t,e}function ad(){}function cd(){return null!==td&&td.apply(this,arguments)||this}function hd(t,e){return"string"==typeof e?Vy(t,e):(e instanceof Xl?e.o_:e).G_}var fd,ld=(yd.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},yd),pd=(n(dd,fd=Fp),dd.prototype.D_=function(){return this.H_||yv(this),this.H_.terminate()},dd);function dd(t,e){var n=this;return(n=fd.call(this,t,e)||this).z_=new Ga,n.I_="name"in t?t.name:"[DEFAULT]",n}function yd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new oi(t)}function vd(n,r,i){var t=this,o=new aa;return n.di.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Ky(n,i)];case 1:return t.sent(),[4,Wy(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(t=e=t.sent()).name?t.code===Mr.FAILED_PRECONDITION||t.code===Mr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function gd(t){if(t.y_||t.V_)throw new Ur(Mr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var md,wd,bd=(n(Nd,wd=rd),Nd.prototype.exists=function(){return wd.prototype.exists.call(this)},Nd.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new _d(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},Nd.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){t=this.W_.data().field(hd("DocumentSnapshot.get",t));if(null!==t)return this.Q_.C_(t,e.serverTimestamps)}},Nd),_d=(n(Td,md=bd),Td.prototype.data=function(t){return void 0===t&&(t={}),md.prototype.data.call(this,t)},Td),Id=(Object.defineProperty(Ed.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Ed.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Ed.prototype.forEach=function(e,n){var r=this;this.Y_.docs.forEach(function(t){e.call(n,new _d(r.U_,r.Q_,t.key,t,new Cv(r.Y_.ee.has(t.key),r.Y_.fromCache),r.query.j_))})},Ed.prototype.docChanges=function(t){void 0===t&&(t={});t=!!t.includeMetadataChanges;if(t&&this.Y_.se)throw new Ur(Mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===t||(this.X_=function(i,e){if(i.Y_.te.W()){var n=0;return i.Y_.docChanges.map(function(t){var e=new _d(i.U_,i.Q_,t.doc.key,t.doc,new Cv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i.Y_.te;return i.Y_.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new _d(i.U_,i.Q_,t.doc.key,t.doc,new Cv(i.Y_.ee.has(t.doc.key),i.Y_.fromCache),i.query.j_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.Z_=t),this.X_},Ed);function Ed(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new Cv(r.hasPendingWrites,r.fromCache),this.query=n}function Td(){return null!==md&&md.apply(this,arguments)||this}function Nd(t,e,n,r,i,o){var s=this;return(s=wd.call(this,t,e,n,r,o)||this).U_=t,s.J_=t,s.metadata=i,s}function Ad(t,e){return t instanceof bd&&e instanceof bd?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof Id&&e instanceof Id&&t.U_===e.U_&&dy(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}var Od,Sd=(n(Dd,Od=h),Dd.prototype.F_=function(t){return new Up(t)},Dd.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new Cd(this.firestore,null,t)},Dd);function Dd(t){var e=this;return(e=Od.call(this)||this).firestore=t,e}function xd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Ip(t.firestore,pd),s=yy(o);return e instanceof Xl&&(e=e.o_),Pd(o,("string"==typeof e||e instanceof ld?Sy(s,"updateDoc",t.K_,e,n,r):Oy(s,"updateDoc",t.K_,e)).ef(t.K_,Ds.exists(!0)))}function kd(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i={includeMetadataChanges:!1},o=0;"object"!=typeof n[o]||ya(n[o])||(i=n[o],o++);var s,u,a,c,h,f={includeMetadataChanges:i.includeMetadataChanges};ya(n[o])&&(a=n[o],n[o]=null===(i=a.next)||void 0===i?void 0:i.bind(a),n[o+1]=null===(i=a.error)||void 0===i?void 0:i.bind(a),n[o+2]=null===(i=a.complete)||void 0===i?void 0:i.bind(a)),e instanceof Cd?(s=Ip(e.firestore,pd),u=du(e.K_.path),h={next:function(t){n[o]&&n[o](Rd(s,e,t))},error:n[o+1],complete:n[o+2]}):(s=Ip(e.firestore,pd),u=e.tf,c=new Sd(s),h={next:function(t){n[o]&&n[o](new Id(s,c,e,t))},error:n[o+1],complete:n[o+2]},iy(e.tf));var l=dv(s),p=new Yl(h),d=new Df(u,p,f);return s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Af,[4,Zy(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})}),function(){p.r_(),s.z_.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Of,[4,Zy(l)];case 1:return[2,e.apply(void 0,[t.sent(),d])]}})})})}}function Pd(t,e){return function(n,r){var t=this,i=new aa;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=ul,[4,$y(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(dv(t),e)}function Rd(t,e,n){var r=n.docs.get(e.K_),i=new Sd(t);return new bd(t,i,e.K_,r,new Cv(n.hasPendingWrites,n.fromCache),e.j_)}var Cd=(Object.defineProperty(Md.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(Md.prototype,"parent",{get:function(){return new sy(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),Md.prototype.withConverter=function(t){return new Md(this.firestore,t,this.K_)},Md),Ld=(Vd.prototype.withConverter=function(t){return new Vd(this.firestore,t,this.tf)},Vd),Ie=function(){};function Vd(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}function Md(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}function Ud(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].sf(t)}return t}var jd,qd,Fd,Bd,zd,Gd=(n(Zd,zd=Ie),Zd.prototype.sf=function(t){var e=yy(t.firestore),e=function(t,e,n,r,i,o){if(r.tt()){if("array-contains"===i||"array-contains-any"===i)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){ny(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(ey(n,t,c))}h={arrayValue:{values:s}}}else h=ey(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||ny(o,i),h=Dy(e,"where",o,"in"===i||"not-in"===i);var h=Du.create(r,i,h);return function(t,e){if(e.An()){var n=mu(t);if(null!==n&&!n.isEqual(e.field))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=gu(t);null!==n&&ry(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Ur(Mr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ur(Mr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.tf,e,t.firestore.R_,this.rf,this.cf,this.uf);return new Ld(t.firestore,t.j_,(t=t.tf,e=t.filters.concat([e]),new cu(t.path,t.collectionGroup,t.Tn.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Zd),Kd=(n($d,Bd=Ie),$d.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ra(e,n);return e=r,null!==gu(n=t)||null!==(t=mu(n))&&ry(0,t,e.field),r}(t.tf,this.rf,this.af);return new Ld(t.firestore,t.j_,(t=t.tf,e=t.Tn.concat([e]),new cu(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},$d),Wd=(n(Jd,Fd=Ie),Jd.prototype.sf=function(t){return new Ld(t.firestore,t.j_,Iu(t.tf,this.hf,this.lf))},Jd),Hd=(n(Xd,qd=Ie),Xd.prototype.sf=function(t){var e=ty(t,this.type,this._f,this.ff);return new Ld(t.firestore,t.j_,(t=t.tf,e=e,new cu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Xd),Qd=(n(Yd,jd=Ie),Yd.prototype.sf=function(t){var e=ty(t,this.type,this._f,this.ff);return new Ld(t.firestore,t.j_,(t=t.tf,e=e,new cu(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Yd);function Yd(t,e,n){var r=this;return(r=jd.call(this)||this).type=t,r._f=e,r.ff=n,r}function Xd(t,e,n){var r=this;return(r=qd.call(this)||this).type=t,r._f=e,r.ff=n,r}function Jd(t,e,n){var r=this;return(r=Fd.call(this)||this).type=t,r.hf=e,r.lf=n,r}function $d(t,e){var n=this;return(n=Bd.call(this)||this).rf=t,n.af=e,n.type="orderBy",n}function Zd(t,e,n){var r=this;return(r=zd.call(this)||this).rf=t,r.cf=e,r.uf=n,r.type="where",r}function ty(t,c,e,n){if(e[0]instanceof Xl&&(e[0]=e[0].o_),e[0]instanceof rd)return function(t,e,n,r){if(!n)throw new Ur(Mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=bu(t);o<s.length;o++){var u=s[o];if(u.field.tt())i.push(Oo(e,n.key));else{var a=n.field(u.field);if(yo(a))throw new Ur(Mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.J();throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Yu(i,r)}(t.tf,t.firestore.R_,e[0].W_,n);var r=yy(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new Ur(Mr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!wu(t)&&-1!==c.indexOf("/"))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ri.Y(c));if(!si.ot(h))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new si(h);u.push(Oo(e,h))}else{c=Dy(n,r,c);u.push(c)}}return new Yu(u,o)}(t.tf,t.firestore.R_,r,c,e,n)}function ey(t,e,n){if(n instanceof Xl&&(n=n.o_),"string"==typeof n){if(""===n)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!wu(e)&&-1!==n.indexOf("/"))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ri.Y(n));if(!si.ot(e))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Oo(t,new si(e))}if(n instanceof Cd)return Oo(t,n.K_);throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+_p(n)+".")}function ny(t,e){if(!Array.isArray(t)||0===t.length)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ry(t,e,n){if(!n.isEqual(e))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function iy(t){if(vu(t)&&0===t.Tn.length)throw new Ur(Mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var oy,sy=(n(uy,oy=Ld),Object.defineProperty(uy.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new Cd(this.firestore,null,new si(t))},enumerable:!1,configurable:!0}),uy.prototype.withConverter=function(t){return new uy(this.firestore,t,this.nf)},uy);function uy(t,e,n){var r=this;return(r=oy.call(this,t,e,du(n))||this).firestore=t,r.nf=n,r.type="collection",r}function ay(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(vp("collection","path",e),t instanceof Fp){var i=ri.Y.apply(ri,s([e],n));return bp(i),new sy(t,null,i)}if(!(t instanceof Cd||t instanceof sy))throw new Ur(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=ri.Y.apply(ri,s([t.path],n)).child(ri.Y(e));return bp(e),new sy(t.firestore,null,e)}function cy(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=Qr.D()),vp("doc","path",e),t instanceof Fp){var i=ri.Y.apply(ri,s([e],n));return wp(i),new Cd(t,null,new si(i))}if(!(t instanceof Cd||t instanceof sy))throw new Ur(Mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");e=t.nf.child(ri.Y.apply(ri,s([e],n)));return wp(e),new Cd(t.firestore,t instanceof sy?t.j_:null,new si(e))}var hy,fy=(n(ly,hy=h),ly.prototype.F_=function(t){return new Up(t)},ly.prototype.O_=function(t){t=this.B_(t,this.firestore.R_);return new Cd(this.firestore,null,t)},ly);function ly(t){var e=this;return(e=hy.call(this)||this).firestore=t,e}function py(t,e){return(t instanceof Cd||t instanceof sy)&&(e instanceof Cd||e instanceof sy)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function dy(t,e){return t instanceof Ld&&e instanceof Ld&&t.firestore===e.firestore&&Eu(t.tf,e.tf)&&t.j_===e.j_}function yy(t){var e=t.S_(),n=da(t.R_);return new Ey(t.R_,!!e.ignoreUndefinedProperties,n)}var vy=/^__.*__$/,gy=(by.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new js(t,this.data,this.en,e)):n.push(new Us(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gs(t,this.fieldTransforms)),n},by),my=(wy.prototype.ef=function(t,e){e=[new js(t,this.data,this.en,e)];return 0<this.fieldTransforms.length&&e.push(new Gs(t,this.fieldTransforms)),e},wy);function wy(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function by(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}function _y(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Rr()}}var Iy=(Object.defineProperty(Ny.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ny.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),Ny.prototype.wf=function(t){return new Ny(Object.assign(Object.assign({},this.settings),t),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},Ny.prototype.Ef=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.wf({path:e,__:!1});return e.Tf(t),e},Ny.prototype.If=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.wf({path:t,__:!1});return t.df(),t},Ny.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},Ny.prototype.h_=function(t){return My(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},Ny.prototype.contains=function(e){return void 0!==this.en.find(function(t){return e.j(t)})||void 0!==this.fieldTransforms.find(function(t){return e.j(t.field)})},Ny.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},Ny.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(_y(this.a_)&&vy.test(t))throw this.h_('Document fields cannot begin and end with "__"')},Ny),Ey=(Ty.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Iy({a_:t,methodName:e,l_:n,path:oi.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},Ty);function Ty(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||da(t)}function Ny(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}function Ay(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Ry("Data must be an object, but it was:",s,r);var u,a,r=ky(r,s);if(o.merge)u=new Ns(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Cy(e,f[h],n);if(!s.contains(l))throw new Ur(Mr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Uy(c,l)||c.push(l)}u=new Ns(c),a=s.fieldTransforms.filter(function(t){return u.un(t.field)})}else u=null,a=s.fieldTransforms;return new gy(new Js(r),u,a)}function Oy(t,r,i,e){var o=t.Rf(1,r,i);Ry("Data must be an object, but it was:",o,e);var s=[],u=new $s;lo(e,function(t,e){var n=Vy(r,t,i);e instanceof Xl&&(e=e.o_);t=o.If(n);e instanceof Ap?s.push(n):null!=(t=xy(e,t))&&(s.push(n),u.set(n,t))});e=new Ns(s);return new my(u.hn(),e,o.fieldTransforms)}function Sy(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[Cy(e,r,n)],a=[i];if(o.length%2!=0)throw new Ur(Mr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Cy(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new $s,y=u.length-1;0<=y;--y){Uy(p,u[y])||(h=u[y],(f=a[y])instanceof Xl&&(f=f.o_),l=s.If(h),f instanceof Ap?p.push(h):null!=(l=xy(f,l))&&(p.push(h),d.set(h,l)))}i=new Ns(p);return new my(d.hn(),i,s.fieldTransforms)}function Dy(t,e,n,r){return void 0===r&&(r=!1),xy(n,t.Rf(r?4:3,e))}function xy(s,t){if(s instanceof Xl&&(s=s.o_),Py(s))return Ry("Unsupported field value:",t,s),ky(s,t);if(s instanceof Np)return function(t,e){if(!_y(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");t=t.u_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.en.push(t.path),s instanceof Array){if(t.settings.__&&4!==t.a_)throw t.h_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=xy(i[r],t.mf(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(t instanceof Xl&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ei.fromDate(t);return{timestampValue:jo(e.serializer,n)}}if(t instanceof ei){var r=new ei(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jo(e.serializer,r)}}if(t instanceof Mp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Up)return{bytesValue:qo(e.serializer,t.T_)};if(t instanceof Cd){n=e.t,r=t.firestore.R_;if(!r.isEqual(n))throw e.h_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Bo(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+_p(t))}(s,t)}function ky(t,n){var r={};return po(t)?n.path&&0<n.path.length&&n.en.push(n.path):lo(t,function(t,e){e=xy(e,n.Ef(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Py(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ei||t instanceof Mp||t instanceof Up||t instanceof Cd||t instanceof Np)}function Ry(t,e,n){if(!Py(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=_p(n);throw"an object"===n?e.h_(t+" a custom object"):e.h_(t+" "+n)}var r}function Cy(t,e,n){if(e instanceof Xl&&(e=e.o_),e instanceof ld)return e.G_;if("string"==typeof e)return Vy(t,e);throw My("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Ly=new RegExp("[~\\*/\\[\\]]");function Vy(e,n,r){if(0<=n.search(Ly))throw My("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(ld.bind.apply(ld,s([void 0],n.split("."))))).G_}catch(t){throw My("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function My(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ur(Mr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Uy(t,e){return t.some(function(t){return t.isEqual(e)})}var jy=(Gy.prototype.pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),0<this.mutations.length)throw new Ur(Mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Qo((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Go(n.serializer,t)})},[4,n.Ru("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Cr(!!e.found),e.found.name,e.found.updateTime;var n=Ko(t,e.found.name),t=Fo(e.found.updateTime),e=new Js({mapValue:{fields:e.found.fields}});return new su(n,t,e,{})}(e,t):"missing"in t?function(t,e){Cr(!!e.missing),Cr(!!e.readTime);t=Ko(t,e.missing),e=Fo(e.readTime);return new uu(t,e)}(e,t):Rr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Cr(!!t),o.push(t)}),o)]}})})}(this.Nu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof uu||t instanceof su?n.bf(t):Rr()}),e)]}})})},Gy.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},Gy.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},Gy.prototype.delete=function(t){this.write([new Ys(t,this.rn(t))]),this.Vf.add(t.toString())},Gy.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.vf(),this.yf)throw this.yf;return e=this.Pf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=si.st(e);n.mutations.push(new Xs(e,n.rn(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Qo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Jo(e.serializer,t)})},[4,e.Au("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Nu,this.mutations)];case 1:return t.sent(),this.gf=!0,[2]}})})},Gy.prototype.bf=function(t){var e;if(t instanceof su)e=t.version;else{if(!(t instanceof uu))throw Rr();e=ni.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ur(Mr.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},Gy.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?Ds.updateTime(e):Ds.on()},Gy.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(this.Vf.has(t.toString())||!e)return Ds.exists(!0);if(e.isEqual(ni.min()))throw new Ur(Mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ds.updateTime(e)},Gy.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},Gy.prototype.vf=function(){},Gy),qy=(zy.prototype.run=function(){this.Cf()},zy.prototype.Cf=function(){var t=this;this.Si.Bs(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new jy(this.Nu),(n=this.Nf(e))&&n.then(function(t){r.di.Ri(function(){return e.commit().then(function(){r.Ti.resolve(t)}).catch(function(t){r.xf(t)})})}).catch(function(t){r.xf(t)}),[2]})})})},zy.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!pi(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},zy.prototype.xf=function(t){var e=this;0<this.Df&&this.Ff(t)?(--this.Df,this.di.Ri(function(){return e.Cf(),Promise.resolve()})):this.Ti.reject(t)},zy.prototype.Ff=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Oi(t)},zy),Fy=(By.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}})})},By.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then(function(){return e.Of(e.user)})},By.prototype.kf=function(){if(this.di.Ci)throw new Ur(Mr.FAILED_PRECONDITION,"The client has already been terminated.")},By.prototype.terminate=function(){var t=this;this.di.Oi();var n=new aa;return this.di.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.R(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Ha(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},By);function By(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Tr.UNAUTHENTICATED,this.clientId=Qr.D(),this.Of=function(){},this.g=new aa,this.credentials.A(function(t){Dr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()})}function zy(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new Na(this.di,"transaction_retry")}function Gy(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}function Ky(r,i){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),Dr("FirestoreClient","Initializing OfflineComponentProvider"),[4,r.getConfiguration()];case 1:return e=t.sent(),[4,i.initialize(e)];case 2:return t.sent(),r.Mf(function(e){return r.di.Mi(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ch(i.Cu,e)];case 1:return t.sent(),[2]}})})})}),i.persistence.tc(function(){return r.terminate()}),r.Lf=i,[2]}})})}function Wy(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r.di.Li(),[4,Hy(r)];case 1:return e=t.sent(),Dr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.Mf(function(t){return r.di.Mi(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).di.Li(),Dr("RemoteStore","RemoteStore received new credentials"),n=pf(e),e.Mu.add(3),[4,sf(e)];case 1:return t.sent(),n&&e.Bu.set("Unknown"),[4,e.xu.s_(i)];case 2:return t.sent(),e.Mu.delete(3),[4,of(e)];case 3:return t.sent(),[2]}})})}(i.Oh,t)})}),r.$f=i,[2]}})})}function Hy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.Lf?[3,2]:(Dr("FirestoreClient","Using default OfflineComponentProvider"),[4,Ky(e,new Kl)]);case 1:t.sent(),t.label=2;case 2:return[2,e.Lf]}})})}function Qy(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.$f?[3,2]:(Dr("FirestoreClient","Using default OnlineComponentProvider"),[4,Wy(e,new Ql)]);case 1:t.sent(),t.label=2;case 2:return[2,e.$f]}})})}function Yy(t){return Hy(t).then(function(t){return t.persistence})}function Xy(t){return Hy(t).then(function(t){return t.Cu})}function Jy(t){return Qy(t).then(function(t){return t.Oh})}function $y(t){return Qy(t).then(function(t){return t.ga})}function Zy(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Qy(r)];case 1:return e=t.sent(),[2,((n=e.Mh).Ju=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Tl(s),(o=e.Bh.get(u))?(n=o.targetId,e.kh.Wa(n),r=o.view.xh(),[3,4]):[3,1];case 1:return[4,Uh(e.Cu,_u(u))];case 2:return i=t.sent(),o=e.kh.Wa(i.targetId),n=i.targetId,[4,sl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Jh&&uf(e.Oh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.ga),n.Zu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Bh.get(o),1<(r=e.qh.get(n.targetId)).length?[2,(e.qh.set(n.targetId,r.filter(function(t){return!Eu(t,o)})),void e.Bh.delete(o))]:e.Jh?(e.kh.Ga(n.targetId),e.kh.Ba(n.targetId)?[3,2]:[4,jh(e.Cu,n.targetId,!1).then(function(){e.kh.Ha(n.targetId),af(e.Oh,n.targetId),dl(e,n.targetId)}).catch(Gh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return dl(e,n.targetId),[4,jh(e.Cu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.ga),n)]}})})}function tv(n,r,i,o,s){var t=new Yl({next:function(t){r.Ri(function(){return Of(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ur(Mr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ur(Mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Df(du(i.path),t,{includeMetadataChanges:!0,oa:!0});return Af(n,u)}function ev(e,n,t,r,i){var o=new Yl({next:function(t){n.Ri(function(){return Of(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ur(Mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Df(t,o,{includeMetadataChanges:!0,oa:!0});return Af(e,s)}var nv=(rv.prototype.set=function(t,e,n){this.Kf();t=iv(t,this.U_),e=Yv(t.j_,e,n),n=Ay(this.Qf,"WriteBatch.set",t.K_,e,null!==t.j_,n);return this.qf=this.qf.concat(n.ef(t.K_,Ds.on())),this},rv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();t=iv(t,this.U_);return e instanceof Xl&&(e=e.o_),e="string"==typeof e||e instanceof ld?Sy(this.Qf,"WriteBatch.update",t.K_,e,n,r):Oy(this.Qf,"WriteBatch.update",t.K_,e),this.qf=this.qf.concat(e.ef(t.K_,Ds.exists(!0))),this},rv.prototype.delete=function(t){this.Kf();t=iv(t,this.U_);return this.qf=this.qf.concat(new Ys(t.K_,Ds.on())),this},rv.prototype.commit=function(){return this.Kf(),this.Uf=!0,0<this.qf.length?this.Bf(this.qf):Promise.resolve()},rv.prototype.Kf=function(){if(this.Uf)throw new Ur(Mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},rv);function rv(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=yy(t)}function iv(t,e){if(t instanceof Xl&&(t=t.o_),t.firestore!==e)throw new Ur(Mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ov,sv,uv=(pv.prototype.get=function(t){var e=this,n=iv(t,this.U_),r=new fy(this.U_);return this.Wf.pf([n.K_]).then(function(t){if(!t||1!==t.length)return Rr();t=t[0];if(t instanceof uu)return new rd(e.U_,r,n.K_,null,n.j_);if(t instanceof su)return new rd(e.U_,r,t.key,t,n.j_);throw Rr()})},pv.prototype.set=function(t,e,n){t=iv(t,this.U_),e=Yv(t.j_,e,n),n=Ay(this.Qf,"Transaction.set",t.K_,e,null!==t.j_,n);return this.Wf.set(t.K_,n),this},pv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=iv(t,this.U_);return e instanceof Xl&&(e=e.o_),e="string"==typeof e||e instanceof ld?Sy(this.Qf,"Transaction.update",t.K_,e,n,r):Oy(this.Qf,"Transaction.update",t.K_,e),this.Wf.update(t.K_,e),this},pv.prototype.delete=function(t){t=iv(t,this.U_);return this.Wf.delete(t.K_),this},n(lv,sv=pv),lv.prototype.get=function(t){var e=this,n=iv(t,this.U_),r=new Sd(this.U_);return sv.prototype.get.call(this,t).then(function(t){return new bd(e.U_,r,n.K_,t.W_,new Cv(!1,!1),n.j_)})},lv),av=(fv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){gd(t);var n=dv(t),r=t.S_(),t=new Ql;return vd(n,t,new Wl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},fv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){gd(t);var e=dv(t),n=t.S_(),t=new Ql;return vd(e,t,new Hl(t,n.cacheSizeBytes))}(t.o_)},fv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.y_&&!n.V_)throw new Ur(Mr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new aa;return n.z_.Ni(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Aa.Gs()?(e=n+"main",[4,Aa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(xh(n.R_,n.I_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.o_)},fv),cv=(n(hv,ov=Xl),Object.defineProperty(hv.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),hv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},hv.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&kr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},hv.prototype.enableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Yy(r)];case 1:return e=t.sent(),[4,Jy(r)];case 2:return n=t.sent(),[2,(e.ec(!0),(t=n).Mu.delete(0),of(t))]}})})})}(dv(this.o_))},hv.prototype.disableNetwork=function(){return function(r){var t=this;return r.di.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Yy(r)];case 1:return e=t.sent(),[4,Jy(r)];case 2:return n=t.sent(),[2,(e.ec(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Mu.add(0),[4,sf(e)];case 1:return t.sent(),e.Bu.set("Offline"),[2]}})})}(n))]}})})})}(dv(this.o_))},hv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&mp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},hv.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},hv.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},hv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new aa;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=fl,[4,$y(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(dv(this.o_))},hv.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=dv(t),e=ya(e)?e:{next:e},i=new Yl(e);return t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.add(e),e.next()},[4,Zy(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})}),function(){i.r_(),t.z_.Ri(function(){return y(n,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Hu.delete(e)},[4,Zy(r)];case 1:return e.apply(void 0,[t.sent(),i]),[2]}})})})}}(this.o_,t)},Object.defineProperty(hv.prototype,"app",{get:function(){if(!this.Gf)throw new Ur(Mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),hv.prototype.collection=function(t){try{return new qv(this,ay(this.o_,t))}catch(t){throw Nv(t,"collection()","Firestore.collection()")}},hv.prototype.doc=function(t){try{return new _v(this,cy(this.o_,t))}catch(t){throw Nv(t,"doc()","Firestore.doc()")}},hv.prototype.collectionGroup=function(t){try{return new Mv(this,function(t,e){if(vp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Ur(Mr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Ld(t,null,(e=e,new cu(ri.X(),e)))}(this.o_,t))}catch(t){throw Nv(t,"collectionGroup()","Firestore.collectionGroup()")}},hv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new aa;return n.di.Ri(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Qy(n).then(function(t){return t.Nu})];case 1:return e=t.sent(),new qy(n.di,e,r,i).run(),[2]}})})}),i.promise}(dv(n=this.o_),function(t){return t=new uv(n,t),e(new wv(r,t))})},hv.prototype.batch=function(){var e=this;return dv(this.o_),new bv(new nv(this.o_,function(t){return Pd(e.o_,t)}))},hv);function hv(t,e,n){var r=this;return(r=ov.call(this,e)||this).jf=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof Er||(r.Gf=t),r}function fv(){}function lv(t,e){var n=this;return(n=sv.call(this,t,e)||this).U_=t,n}function pv(t,e){this.U_=t,this.Wf=e,this.Qf=yy(t)}function dv(t){return t.H_||yv(t),t.H_.kf(),t.H_}function yv(t){var e,n,r=t.S_(),r=(e=t.R_,n=t.I_,new Ir(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.H_=new Fy(t.P_,t.z_,r)}var vv,gv,mv,wv=(n(Tv,mv=Xl),Tv.prototype.get=function(t){var e=this,t=Qv(t);return this.o_.get(t).then(function(t){return new Lv(e.U_,t)})},Tv.prototype.set=function(t,e,n){t=Qv(t);return n?(gp("Transaction.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Tv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Qv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Tv.prototype.delete=function(t){t=Qv(t);return this.o_.delete(t),this},Tv),bv=(n(Ev,gv=Xl),Ev.prototype.set=function(t,e,n){t=Qv(t);return n?(gp("WriteBatch.set",n),this.o_.set(t,e,n)):this.o_.set(t,e),this},Ev.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Qv(t);return 2===arguments.length?this.o_.update(o,e):(t=this.o_).update.apply(t,s([o,e,n],r)),this},Ev.prototype.delete=function(t){t=Qv(t);return this.o_.delete(t),this},Ev.prototype.commit=function(){return this.o_.commit()},Ev),_v=(n(Iv,vv=Xl),Iv.zf=function(t,e,n){if(t.length%2!=0)throw new Ur(Mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new Iv(e,new Cd(e.o_,n,new si(t)))},Iv.q_=function(t,e,n){return new Iv(e,new Cd(e.o_,n,t))},Object.defineProperty(Iv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Iv.prototype,"parent",{get:function(){return new qv(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Iv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Iv.prototype.collection=function(t){try{return new qv(this.firestore,ay(this.o_,t))}catch(t){throw Nv(t,"collection()","DocumentReference.collection()")}},Iv.prototype.isEqual=function(t){return t instanceof Xl&&(t=t.o_),t instanceof Cd&&py(this.o_,t)},Iv.prototype.set=function(t,e){e=gp("DocumentReference.set",e);try{return n=this.o_,r=t,i=e,o=Ip(n.firestore,pd),r=Yv(n.j_,r,i),Pd(o,Ay(yy(o),"setDoc",n.K_,r,null!==n.j_,i).ef(n.K_,Ds.on()))}catch(t){throw Nv(t,"setDoc()","DocumentReference.set()")}var n,r,i,o},Iv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?xd(this.o_,t):xd.apply(void 0,s([this.o_,t,e],n))}catch(t){throw Nv(t,"updateDoc()","DocumentReference.update()")}},Iv.prototype.delete=function(){return Pd(Ip((t=this.o_).firestore,pd),[new Ys(t.K_,Ds.on())]);var t},Iv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Av(t),i=Ov(t,function(t){return new Lv(e.firestore,new bd(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))});return kd(this.o_,r,i)},Iv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Ip(e.firestore,pd),r=dv(n),i=new Sd(n),o=new aa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Xy(r)];case 1:return[4,function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Oc.cs(t,e)}))];case 1:return(r=t.sent())instanceof su?s.resolve(r):r instanceof uu?s.resolve(null):s.reject(new Ur(Mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ha(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(t.sent(),e.K_,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new bd(n,i,e.K_,t,new Cv(t instanceof su&&t.an,!0),e.j_)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Ip(e.firestore,pd),r=dv(n),i=new aa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return[4,tv(t.sent(),n.z_,e.K_,{source:"server"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Rd(n,e,t)})}:function(e){var t=this,n=Ip(e.firestore,pd),r=dv(n),i=new aa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return[4,tv(t.sent(),n.z_,e.K_,{source:"default"},i)];case 2:return t.sent(),[2]}})})}),i.promise.then(function(t){return Rd(n,e,t)})})(this.o_).then(function(t){return new Lv(e.firestore,new bd(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))})},Iv.prototype.withConverter=function(t){return new Iv(this.firestore,this.o_.withConverter(t))},Iv);function Iv(t,e){var n=this;return(n=vv.call(this,e)||this).firestore=t,n.Q_=new nd(t),n}function Ev(){return null!==gv&&gv.apply(this,arguments)||this}function Tv(t,e){var n=this;return(n=mv.call(this,e)||this).U_=t,n}function Nv(t,e,n){return t.message=t.message.replace(e,n),t}function Av(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!ya(r))return r}return{}}function Ov(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=ya(t[0])?t[0]:ya(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Sv,Dv,xv,kv,Pv,Rv,Cv=(Hv.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Hv),Lv=(n(Wv,Rv=Xl),Object.defineProperty(Wv.prototype,"ref",{get:function(){return new _v(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Wv.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),Wv.prototype.data=function(t){return this.o_.data(t)},Wv.prototype.get=function(t,e){return this.o_.get(t,e)},Wv.prototype.isEqual=function(t){return Ad(this.o_,t.o_)},Wv),Vv=(n(Kv,Pv=Lv),Kv.prototype.data=function(t){return this.o_.data(t)},Kv),Mv=(n(Gv,kv=Xl),Gv.prototype.where=function(t,e,n){try{return new Gv(this.firestore,Ud(this.o_,(r=n,i=e,o=hd("where",t),new Gd(o,i,r))))}catch(t){throw Nv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Gv.prototype.orderBy=function(n,t){try{return new Gv(this.firestore,Ud(this.o_,function(t){void 0===t&&(t="asc");var e=t,t=hd("orderBy",n);return new Kd(t,e)}(t)))}catch(n){throw Nv(n,/(orderBy|where)\(\)/,"Query.$1()")}},Gv.prototype.limit=function(t){try{return new Gv(this.firestore,Ud(this.o_,(Ep("limit",e=t),new Wd("limit",e,"F"))))}catch(t){throw Nv(t,"limit()","Query.limit()")}var e},Gv.prototype.limitToLast=function(t){try{return new Gv(this.firestore,Ud(this.o_,(Ep("limitToLast",e=t),new Wd("limitToLast",e,"L"))))}catch(t){throw Nv(t,"limitToLast()","Query.limitToLast()")}var e},Gv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Gv(this.firestore,Ud(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hd("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Nv(t,"startAt()","Query.startAt()")}},Gv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Gv(this.firestore,Ud(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hd("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Nv(t,"startAfter()","Query.startAfter()")}},Gv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Gv(this.firestore,Ud(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qd("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Nv(t,"endBefore()","Query.endBefore()")}},Gv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Gv(this.firestore,Ud(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qd("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Nv(t,"endAt()","Query.endAt()")}},Gv.prototype.isEqual=function(t){return dy(this.o_,t.o_)},Gv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){var t=this,n=Ip(e.firestore,pd),r=dv(n),i=new Sd(n),o=new aa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Xy(r)];case 1:return[4,function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,qh(r,i,!0)];case 1:return n=t.sent(),e=new Hf(i,n.Bc),n=e.gh(n.documents),n=e.Zn(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ha(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(t.sent(),e.tf,o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Id(n,i,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){var t=this,n=Ip(e.firestore,pd),r=dv(n),i=new Sd(n),o=new aa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return[4,ev(t.sent(),n.z_,e.tf,{source:"server"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Id(n,i,e,t)})}:function(e){var t=this,n=Ip(e.firestore,pd),r=dv(n),i=new Sd(n);iy(e.tf);var o=new aa;return n.z_.Ri(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zy(r)];case 1:return[4,ev(t.sent(),n.z_,e.tf,{source:"default"},o)];case 2:return t.sent(),[2]}})})}),o.promise.then(function(t){return new Id(n,i,e,t)})})(this.o_).then(function(t){return new jv(e.firestore,t)})},Gv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Av(t),i=Ov(t,function(t){return new jv(e.firestore,t)});return kd(this.o_,r,i)},Gv.prototype.withConverter=function(t){return new Gv(this.firestore,this.o_.withConverter(t))},Gv),Uv=(n(zv,xv=Xl),Object.defineProperty(zv.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"doc",{get:function(){return new Vv(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),zv),jv=(n(Bv,Dv=Xl),Object.defineProperty(Bv.prototype,"query",{get:function(){return new Mv(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"docs",{get:function(){var e=this;return this.o_.docs.map(function(t){return new Vv(e.U_,t)})},enumerable:!1,configurable:!0}),Bv.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map(function(t){return new Uv(e.U_,t)})},Bv.prototype.forEach=function(e,n){var r=this;this.o_.forEach(function(t){e.call(n,new Vv(r.U_,t))})},Bv.prototype.isEqual=function(t){return Ad(this.o_,t.o_)},Bv),qv=(n(Fv,Sv=Mv),Object.defineProperty(Fv.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Fv.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Fv.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new _v(this.firestore,t):null},enumerable:!1,configurable:!0}),Fv.prototype.doc=function(t){try{return new _v(this.firestore,void 0===t?cy(this.o_):cy(this.o_,t))}catch(t){throw Nv(t,"doc()","CollectionReference.doc()")}},Fv.prototype.add=function(t){var e,n,r,i=this;return e=this.o_,n=t,t=Ip(e.firestore,pd),r=cy(e),n=Yv(e.j_,n),Pd(t,Ay(yy(e.firestore),"addDoc",r.K_,n,null!==e.j_,{}).ef(r.K_,Ds.exists(!1))).then(function(){return r}).then(function(t){return new _v(i.firestore,t)})},Fv.prototype.isEqual=function(t){return py(this.o_,t.o_)},Fv.prototype.withConverter=function(t){return new Fv(this.firestore,this.o_.withConverter(t))},Fv);function Fv(t,e){var n=this;return(n=Sv.call(this,t,e)||this).firestore=t,n.o_=e,n}function Bv(t,e){var n=this;return(n=Dv.call(this,e)||this).U_=t,n}function zv(t,e){var n=this;return(n=xv.call(this,e)||this).U_=t,n}function Gv(t,e){var n=this;return(n=kv.call(this,e)||this).firestore=t,n}function Kv(){return null!==Pv&&Pv.apply(this,arguments)||this}function Wv(t,e){var n=this;return(n=Rv.call(this,e)||this).U_=t,n}function Hv(t,e){this.hasPendingWrites=t,this.fromCache=e}function Qv(t){return t instanceof Xl&&(t=t.o_),Ip(t,Cd)}function Yv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Xv,Jv,$v,Ie=(n(eg,Jv=Xl),eg.documentId=function(){return new eg(oi.et().J())},eg.prototype.isEqual=function(t){return t instanceof Xl&&(t=t.o_),t instanceof ld&&this.o_.G_.isEqual(t.G_)},eg),h=(n(tg,Xv=Xl),tg.serverTimestamp=function(){var t=new Rp("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new tg(t)},tg.delete=function(){var t=new Ap("deleteField");return t.c_="FieldValue.delete",new tg(t)},tg.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Cp("arrayUnion",t)}.apply(void 0,t);return n.c_="FieldValue.arrayUnion",new tg(n)},tg.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Lp("arrayRemove",t)}.apply(void 0,t);return n.c_="FieldValue.arrayRemove",new tg(n)},tg.increment=function(t){t=new Vp("increment",t);return t.c_="FieldValue.increment",new tg(t)},tg.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},tg),Zv={Firestore:cv,GeoPoint:Mp,Timestamp:ei,Blob:ed,Transaction:wv,WriteBatch:bv,DocumentReference:_v,DocumentSnapshot:Lv,Query:Mv,QueryDocumentSnapshot:Vv,QuerySnapshot:jv,CollectionReference:qv,FieldPath:Ie,FieldValue:h,setLogLevel:function(t){Or.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};function tg(){return null!==Xv&&Xv.apply(this,arguments)||this}function eg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jv.call(this,new(ld.bind.apply(ld,s([void 0],t))))||this}($v=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new cv(e,new pd(e,t),new av);var e},"PUBLIC").setServiceProps(Object.assign({},Zv))),$v.registerVersion("@firebase/firestore","2.0.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
